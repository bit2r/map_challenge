<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko-KR" xml:lang="ko-KR">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.523">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="이광춘">
<meta name="description" content="경기도 데이터 분석센터에서 제공하는 민간데이터(KT 유동인구, BC카드 결재)를 통해 한걸음 더 들어가 보이지 않던 새로운 것을 찾아보자.">
<title>지도제작 대회</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>
<!-- htmldependencies:E3FAD763 --><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "일치 없음",
    "search-matching-documents-text": "일치된 문서",
    "search-copy-link-title": "검색 링크 복사",
    "search-hide-matches-text": "추가 검색 결과 숨기기",
    "search-more-match-text": "추가 검색결과",
    "search-more-matches-text": "추가 검색결과",
    "search-clear-button-title": "제거",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "취소",
    "search-submit-button-title": "검색",
    "search-label": "검색"
  }
}</script><link rel="stylesheet" href="css/quarto.scss">
</head>
<body>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="/index.html">
    <span class="navbar-title">지도제작 대회</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="검색"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="탐색 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="/index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">지도 그리기</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-">
<li>
    <a class="dropdown-item" href="/day_01.html">
 <span class="dropdown-text">지도 색칠</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/day_02.html">
 <span class="dropdown-text">인구수 점(Point)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/day_03.html">
 <span class="dropdown-text">스파이크(Spike map)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/day_04.html">
 <span class="dropdown-text">지형도(Topographic map)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/day_05.html">
 <span class="dropdown-text">3D 표고 지도(독도)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/day_06.html">
 <span class="dropdown-text">아시아국가 실업율(%)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/day_07.html">
 <span class="dropdown-text">인터랙티브 지도(Mapview)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/day_08.html">
 <span class="dropdown-text">지오코딩</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/day_heatmap.html">
 <span class="dropdown-text">열지도(heatmap)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/spatial_basics.html">
 <span class="dropdown-text">지도 기본기</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/tour.html">
 <span class="dropdown-text">대통령 해외순방</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/cartogram.html">
 <span class="dropdown-text">인구비례 선거구</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-gis-분석챗gpt" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">GIS 분석&amp;챗GPT</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-gis-분석챗gpt">
<li>
    <a class="dropdown-item" href="/spatial_map.html">
 <span class="dropdown-text">지도(Map)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/jeju_map.html">
 <span class="dropdown-text">제주도 높이 지도</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/yellow_sea.html">
 <span class="dropdown-text">황해</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/yellow_sea2.html">
 <span class="dropdown-text">황해2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/gg_analytics_center.html">
 <span class="dropdown-text">경기 데이터 분석 센터</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/km_school.html">
 <span class="dropdown-text">광명시 학교와 CCTV</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="/km_BitGPT.html">
 <span class="dropdown-text">Code Interpreter</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu--1" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">시각화</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu--1">
<li>
    <a class="dropdown-item" href="/movie.html">
 <span class="dropdown-text">한국영화</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/dashboards.html">
 <span class="dropdown-text">대쉬보드 Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/dashboards_quakes.qmd">
 <span class="dropdown-text">대쉬보드 R</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-i" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">제21대 국회의원 선거(I)</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-i">
<li>
    <a class="dropdown-item" href="/precinct.html">
 <span class="dropdown-text">국회의원 선거구</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/minju_nomination.html">
 <span class="dropdown-text">민주당 전략공천 성과</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/precinct_history.html">
 <span class="dropdown-text">선거구와 정수</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/electorate.html">
 <span class="dropdown-text">변경된 선거구</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/precinct_district.html">
 <span class="dropdown-text">선거구 평균 인구수</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/district_issue.html">
 <span class="dropdown-text">인구수 문제 선거구</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/kwangmyung.html">
 <span class="dropdown-text">광명시(총/대/지)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/approval_rate.html">
 <span class="dropdown-text">대통령 지지율</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/minju_party.html">
 <span class="dropdown-text">민주당은 전국정당(?)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/by_election.html">
 <span class="dropdown-text">재보궐: 강서구청장</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/by_election_dong.html">
 <span class="dropdown-text">재보궐: 강서구청장(동별)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/after_by_election.html">
 <span class="dropdown-text">서울 재보궐 이후</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/gs_position.html">
 <span class="dropdown-text">재보궐: 강서구 위치</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="/realmeter_metro.html">
 <span class="dropdown-text">리얼미터 PDF</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/gallop_metro.html">
 <span class="dropdown-text">한국갤럽 PDF</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/nbs_metro.html">
 <span class="dropdown-text">전국지표조사 PDF</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-ii" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">제21대 국회의원 선거(II)</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-ii">
<li>
    <a class="dropdown-item" href="/legislators.html">
 <span class="dropdown-text">권역별 의석수 변화</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/candidate.html">
 <span class="dropdown-text">예비 후보자</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/district_chair.html">
 <span class="dropdown-text">지역/당협 위원장</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/watermellon.html">
 <span class="dropdown-text">수박 당도 선별기</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/sido_legislator.html">
 <span class="dropdown-text">시도별 역대 국회의원</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/metro_people_power.html">
 <span class="dropdown-text">수도권 국힘의원</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/party_numbers.html">
 <span class="dropdown-text">당원과 정당 수입지출</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/elected_numbers.html">
 <span class="dropdown-text">국회의원 초선 당선</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/forecast.html">
 <span class="dropdown-text">총선 예측</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/nec_api.html">
 <span class="dropdown-text">투개표 API</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/single_member.html">
 <span class="dropdown-text">양당과 소선구제</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/proportion_member.html">
 <span class="dropdown-text">비례 국회의원</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="/best_matches.html">
 <span class="dropdown-text">최고 관심 격돌</span></a>
  </li>  
    </ul>
</li>
</ul>
</div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="다크 모드 전환"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <div id="quarto-toc-target"></div>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title-banner">
    <div class="quarto-title column-body">
      <h1 class="title">지도제작 대회</h1>
            <p class="subtitle lead">경기 데이터 분석센터</p>
                  <div>
        <div class="description">
          <p>경기도 데이터 분석센터에서 제공하는 민간데이터(KT 유동인구, BC카드 결재)를 통해 한걸음 더 들어가 보이지 않던 새로운 것을 찾아보자.</p>
        </div>
      </div>
                </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">저자</div>
    <div class="quarto-title-meta-heading">소속</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author"><a href="https://www.linkedin.com/in/kwangchunlee/">이광춘</a> </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              <a href="https://github.com/bit2r">
              한국 R 사용자회
              </a>
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
    
      
    </div>
    
  
  </header><nav id="TOC" role="doc-toc"><h2 id="toc-title">목차</h2>
   
  <ul>
<li><a href="#%EB%AF%BC%EA%B0%84-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B" id="toc-민간-데이터셋"><span class="header-section-number">1</span> 민간 데이터셋</a></li>
  <li>
<a href="#%EA%B2%BD%EA%B8%B0-%EC%97%B0%EB%8F%84%EB%B3%84-%EC%B9%B4%EB%93%9C%EB%A7%A4%EC%B6%9C" id="toc-경기-연도별-카드매출"><span class="header-section-number">2</span> 경기 연도별 카드매출</a>
  <ul>
<li><a href="#%EB%B8%94%EB%A1%9D%EC%BD%94%EB%93%9C-%EC%8B%9C%EA%B5%B0%EA%B5%AC-%EB%A7%A4%EC%B9%AD%EC%9E%91%EC%97%85" id="toc-블록코드-시군구-매칭작업"><span class="header-section-number">2.1</span> 블록코드 시군구 매칭작업</a></li>
  <li><a href="#%EC%8B%9C%EA%B5%B0%EA%B5%AC%EB%B3%84-%EC%9B%94%EB%B3%84-%EB%A7%A4%EC%B6%9C%EA%B8%88%EC%95%A1" id="toc-시군구별-월별-매출금액"><span class="header-section-number">2.2</span> 시군구별 월별 매출금액</a></li>
  <li>
<a href="#%EC%84%9C%ED%95%B4-%EC%9D%B8%EC%A0%91-%EC%8B%9C%EA%B5%B0%EA%B5%AC" id="toc-서해-인접-시군구"><span class="header-section-number">2.3</span> 서해 인접 시군구</a>
  <ul>
<li><a href="#%EB%B8%94%EB%A1%9D%EC%BD%94%EB%93%9C-%EC%8B%9C%EA%B5%B0%EA%B5%AC-%EB%A7%A4%EC%B9%AD%EC%9E%91%EC%97%85-1" id="toc-블록코드-시군구-매칭작업-1"><span class="header-section-number">2.3.1</span> 블록코드 시군구 매칭작업</a></li>
  <li><a href="#%EC%84%9C%ED%95%B4%EC%9D%B8%EC%A0%91-%EC%8B%9C%EA%B5%B0%EA%B5%AC-%EC%9B%94%EB%B3%84-%EB%A7%A4%EC%B6%9C%EA%B8%88%EC%95%A1" id="toc-서해인접-시군구-월별-매출금액"><span class="header-section-number">2.3.2</span> 서해인접 시군구 월별 매출금액</a></li>
  </ul>
</li>
  <li>
<a href="#%EC%84%9C%ED%95%B4-%EC%9D%B8%EC%A0%91-%ED%96%89%EC%A0%95%EB%8F%99" id="toc-서해-인접-행정동"><span class="header-section-number">2.4</span> 서해 인접 행정동</a>
  <ul>
<li><a href="#%EC%84%9C%ED%95%B4%EC%9D%B8%EC%A0%91-%EC%8B%9C%EA%B5%B0%EA%B5%AC" id="toc-서해인접-시군구"><span class="header-section-number">2.4.1</span> 서해인접 시군구</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#%EA%B4%91%EB%AA%85%EC%8B%9C" id="toc-광명시"><span class="header-section-number">3</span> 광명시</a>
  <ul>
<li><a href="#%EC%A7%80%EB%8F%84" id="toc-지도"><span class="header-section-number">3.1</span> 지도</a></li>
  <li>
<a href="#%ED%96%89%EC%A0%95%EB%8F%99-%EA%B2%B0%ED%95%A9" id="toc-행정동-결합"><span class="header-section-number">3.2</span> 행정동 결합</a>
  <ul>
<li><a href="#%EC%8B%9C%EA%B5%B0%EA%B5%AC-%ED%96%89%EC%A0%95%EB%8F%99%EB%AA%85" id="toc-시군구-행정동명"><span class="header-section-number">3.2.1</span> 시군구 행정동명</a></li>
  <li><a href="#%EC%85%80%EC%BD%94%EB%93%9C" id="toc-셀코드"><span class="header-section-number">3.2.2</span> 셀코드</a></li>
  </ul>
</li>
  <li><a href="#%EA%B5%AD%EA%B0%80%EA%B3%B5%EA%B0%84%EC%A0%95%EB%B3%B4%ED%8F%AC%ED%84%B8" id="toc-국가공간정보포털"><span class="header-section-number">3.3</span> 국가공간정보포털</a></li>
  <li>
<a href="#%EA%B4%91%EB%AA%85%EC%8B%9C-%EC%9C%A0%EB%8F%99%EC%9D%B8%EA%B5%AC" id="toc-광명시-유동인구"><span class="header-section-number">3.4</span> 광명시 유동인구</a>
  <ul>
<li><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B" id="toc-데이터셋"><span class="header-section-number">3.4.1</span> 데이터셋</a></li>
  </ul>
</li>
  <li><a href="#%EB%B6%84%EC%84%9D" id="toc-분석"><span class="header-section-number">3.5</span> 분석</a></li>
  <li><a href="#%EC%86%8C%ED%95%982%EB%8F%99" id="toc-소하2동"><span class="header-section-number">3.6</span> 소하2동</a></li>
  </ul>
</li>
  <li><a href="#%EA%B2%BD%EA%B8%B0%EB%8F%84-%EC%96%B4%ED%95%AD" id="toc-경기도-어항"><span class="header-section-number">4</span> 경기도 어항</a></li>
  <li>
<a href="#%EA%B0%81-%ED%95%AD%EA%B5%AC" id="toc-각-항구"><span class="header-section-number">5</span> 각 항구</a>
  <ul>
<li><a href="#%EA%B9%80%ED%8F%AC%EC%8B%9C-%EB%8C%80%EB%AA%85%ED%95%AD" id="toc-김포시-대명항"><span class="header-section-number">5.1</span> 김포시 대명항</a></li>
  <li><a href="#%ED%99%94%EC%84%B1%EC%8B%9C-%EA%B6%81%ED%8F%89%ED%95%AD" id="toc-화성시-궁평항"><span class="header-section-number">5.2</span> 화성시 궁평항</a></li>
  <li><a href="#%EC%95%88%EC%82%B0%EC%8B%9C-%ED%83%84%EB%8F%84%ED%95%AD" id="toc-안산시-탄도항"><span class="header-section-number">5.3</span> 안산시 탄도항</a></li>
  </ul>
</li>
  <li>
<a href="#%EB%8C%80%EB%AA%85%ED%95%AD-%EC%9C%A0%EB%8F%99%EC%9D%B8%EA%B5%AC-%EA%B2%B0%EC%9E%AC%EA%B8%88%EC%95%A1" id="toc-대명항-유동인구-결재금액"><span class="header-section-number">6</span> 대명항 유동인구, 결재금액</a>
  <ul>
<li><a href="#%EA%B9%80%ED%8F%AC%EC%8B%9C-%EB%8C%80%EB%AA%85%ED%95%AD-%EC%9C%84%EC%B9%98" id="toc-김포시-대명항-위치"><span class="header-section-number">6.1</span> 김포시 대명항 위치</a></li>
  <li>
<a href="#%EC%9C%A0%EB%8F%99%EC%9D%B8%EA%B5%AC" id="toc-유동인구"><span class="header-section-number">6.2</span> 유동인구</a>
  <ul>
<li><a href="#kt-%EB%8D%B0%EC%9D%B4%ED%84%B0" id="toc-kt-데이터"><span class="header-section-number">6.2.1</span> KT 데이터</a></li>
  <li><a href="#%EB%8C%80%EB%AA%85%ED%95%AD-1-km-%EC%9C%A0%EB%8F%99%EC%9D%B8%EA%B5%AC" id="toc-대명항-1-km-유동인구"><span class="header-section-number">6.2.2</span> 대명항 1 KM 유동인구</a></li>
  </ul>
</li>
  <li><a href="#%EC%9C%A0%EB%8F%99%EC%9D%B8%EA%B5%AC-%EB%B6%84%EC%84%9D" id="toc-유동인구-분석"><span class="header-section-number">6.3</span> 유동인구 분석</a></li>
  <li>
<a href="#%EB%A7%A4%EC%B6%9C%EA%B8%88%EC%95%A1" id="toc-매출금액"><span class="header-section-number">6.4</span> 매출금액</a>
  <ul>
<li><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0" id="toc-데이터"><span class="header-section-number">6.4.1</span> 데이터</a></li>
  </ul>
</li>
  <li><a href="#%EA%B2%B0%EC%9E%AC%EA%B8%88%EC%95%A1-%EB%B6%84%EC%84%9D" id="toc-결재금액-분석"><span class="header-section-number">6.5</span> 결재금액 분석</a></li>
  </ul>
</li>
  </ul></nav><section id="민간-데이터셋" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> 민간 데이터셋</h1>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb1"><pre class="sourceCode python cell-code"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> camelot</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># PDF 파일에서 표를 읽어옵니다.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>tables <span class="op">=</span> camelot.read_pdf(<span class="st">'data/민간데이터 목록.pdf'</span>, pages<span class="op">=</span><span class="st">'1'</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>tables_pd <span class="op">=</span> tables[<span class="dv">0</span>].df</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터프레임을 CSV 파일로 저장합니다.</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># df.to_csv('output.csv', index=False)</span></span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/reticulate/">reticulate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com/">gt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jthomasmock/gtExtras">gtExtras</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="va">py</span><span class="op">$</span><span class="va">tables_pd</span></span>
<span></span>
<span><span class="va">dataset</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/row_to_names.html">row_to_names</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">제공기관</span>, .before <span class="op">=</span> <span class="va">분석구분</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html">gt</a></span><span class="op">(</span>groupname_col <span class="op">=</span> <span class="st">"제공기관"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://jthomasmock.github.io/gtExtras/reference/gt_theme_538.html">gt_theme_538</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_options.html">tab_options</a></span><span class="op">(</span></span>
<span>    heading.title.font.size <span class="op">=</span> <span class="fu"><a href="https://gt.rstudio.com/reference/px.html">px</a></span><span class="op">(</span><span class="fl">16L</span><span class="op">)</span>,</span>
<span>    column_labels.font.size <span class="op">=</span> <span class="fu"><a href="https://gt.rstudio.com/reference/px.html">px</a></span><span class="op">(</span><span class="fl">14L</span><span class="op">)</span>,</span>
<span>    table.font.size <span class="op">=</span> <span class="fu"><a href="https://gt.rstudio.com/reference/px.html">px</a></span><span class="op">(</span><span class="fl">12L</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span>   </span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_align.html">cols_align</a></span><span class="op">(</span><span class="st">"center"</span><span class="op">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div id="sqkvgpnfjr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#sqkvgpnfjr table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#sqkvgpnfjr thead, #sqkvgpnfjr tbody, #sqkvgpnfjr tfoot, #sqkvgpnfjr tr, #sqkvgpnfjr td, #sqkvgpnfjr th {
  border-style: none;
}

#sqkvgpnfjr p {
  margin: 0;
  padding: 0;
}

#sqkvgpnfjr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sqkvgpnfjr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#sqkvgpnfjr .gt_title {
  color: #333333;
  font-size: 16px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sqkvgpnfjr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sqkvgpnfjr .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sqkvgpnfjr .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sqkvgpnfjr .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sqkvgpnfjr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 14px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sqkvgpnfjr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 14px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sqkvgpnfjr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sqkvgpnfjr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sqkvgpnfjr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sqkvgpnfjr .gt_spanner_row {
  border-bottom-style: hidden;
}

#sqkvgpnfjr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#sqkvgpnfjr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#sqkvgpnfjr .gt_from_md > :first-child {
  margin-top: 0;
}

#sqkvgpnfjr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sqkvgpnfjr .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sqkvgpnfjr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#sqkvgpnfjr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#sqkvgpnfjr .gt_row_group_first td {
  border-top-width: 2px;
}

#sqkvgpnfjr .gt_row_group_first th {
  border-top-width: 2px;
}

#sqkvgpnfjr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sqkvgpnfjr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#sqkvgpnfjr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#sqkvgpnfjr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sqkvgpnfjr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sqkvgpnfjr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sqkvgpnfjr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#sqkvgpnfjr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#sqkvgpnfjr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sqkvgpnfjr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sqkvgpnfjr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sqkvgpnfjr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sqkvgpnfjr .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sqkvgpnfjr .gt_left {
  text-align: left;
}

#sqkvgpnfjr .gt_center {
  text-align: center;
}

#sqkvgpnfjr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sqkvgpnfjr .gt_font_normal {
  font-weight: normal;
}

#sqkvgpnfjr .gt_font_bold {
  font-weight: bold;
}

#sqkvgpnfjr .gt_font_italic {
  font-style: italic;
}

#sqkvgpnfjr .gt_super {
  font-size: 65%;
}

#sqkvgpnfjr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#sqkvgpnfjr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#sqkvgpnfjr .gt_indent_1 {
  text-indent: 5px;
}

#sqkvgpnfjr .gt_indent_2 {
  text-indent: 10px;
}

#sqkvgpnfjr .gt_indent_3 {
  text-indent: 15px;
}

#sqkvgpnfjr .gt_indent_4 {
  text-indent: 20px;
}

#sqkvgpnfjr .gt_indent_5 {
  text-indent: 25px;
}

tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>
<table class="gt_table" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="header gt_col_headings">
<th id="분석구분" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">분석구분</th>
<th id="데이터  내역" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">데이터 내역</th>
<th id="제공  단위" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">제공 단위</th>
<th id="시간범위" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">시간범위</th>
<th id="제공형태" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">제공형태</th>
<th id="제공시작일" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">제공시작일</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd gt_group_heading_row">
<td colspan="6" id="오픈메이트" class="gt_group_heading" data-quarto-table-cell-role="th" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black" scope="colgroup">오픈메이트</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_center" headers="오픈메이트  분석구분">공통</td>
<td class="gt_row gt_center" headers="오픈메이트  데이터  내역">행정동 경계</td>
<td class="gt_row gt_center" headers="오픈메이트  제공  단위">행정동</td>
<td class="gt_row gt_center" headers="오픈메이트  시간범위">-</td>
<td class="gt_row gt_center" headers="오픈메이트  제공형태">shp</td>
<td class="gt_row gt_center" headers="오픈메이트  제공시작일">‘20.9.17</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="오픈메이트  분석구분">공통</td>
<td class="gt_row gt_center" headers="오픈메이트  데이터  내역">블록 경계</td>
<td class="gt_row gt_center" headers="오픈메이트  제공  단위">블록</td>
<td class="gt_row gt_center" headers="오픈메이트  시간범위">-</td>
<td class="gt_row gt_center" headers="오픈메이트  제공형태">shp</td>
<td class="gt_row gt_center" headers="오픈메이트  제공시작일">‘20.9.17</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="오픈메이트  분석구분">공통</td>
<td class="gt_row gt_center" headers="오픈메이트  데이터  내역">셀/블록/행정동 매핑</td>
<td class="gt_row gt_center" headers="오픈메이트  제공  단위">50m X 50m</td>
<td class="gt_row gt_center" headers="오픈메이트  시간범위">-</td>
<td class="gt_row gt_center" headers="오픈메이트  제공형태">csv</td>
<td class="gt_row gt_center" headers="오픈메이트  제공시작일">‘20.9.17</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="오픈메이트  분석구분">공통</td>
<td class="gt_row gt_center" headers="오픈메이트  데이터  내역">셀(중심점)</td>
<td class="gt_row gt_center" headers="오픈메이트  제공  단위">50m X 50m</td>
<td class="gt_row gt_center" headers="오픈메이트  시간범위">-</td>
<td class="gt_row gt_center" headers="오픈메이트  제공형태">shp</td>
<td class="gt_row gt_center" headers="오픈메이트  제공시작일">‘20.9.17</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="오픈메이트  분석구분">공통</td>
<td class="gt_row gt_center" headers="오픈메이트  데이터  내역">셀(격자)</td>
<td class="gt_row gt_center" headers="오픈메이트  제공  단위">50m X 50m</td>
<td class="gt_row gt_center" headers="오픈메이트  시간범위">-</td>
<td class="gt_row gt_center" headers="오픈메이트  제공형태">shp</td>
<td class="gt_row gt_center" headers="오픈메이트  제공시작일">‘20.9.17</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="오픈메이트  분석구분">공통</td>
<td class="gt_row gt_center" headers="오픈메이트  데이터  내역">도로단위</td>
<td class="gt_row gt_center" headers="오픈메이트  제공  단위">도로</td>
<td class="gt_row gt_center" headers="오픈메이트  시간범위">-</td>
<td class="gt_row gt_center" headers="오픈메이트  제공형태">shp</td>
<td class="gt_row gt_center" headers="오픈메이트  제공시작일">‘20.9.17</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="6" id="비씨카드" class="gt_group_heading" data-quarto-table-cell-role="th" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black" scope="colgroup">비씨카드</td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_center" headers="비씨카드  분석구분">카드</td>
<td class="gt_row gt_center" headers="비씨카드  데이터  내역">성별 / 연령별 카드매출</td>
<td class="gt_row gt_center" headers="비씨카드  제공  단위">블록</td>
<td class="gt_row gt_center" headers="비씨카드  시간범위">2017년1월~ 2023년02월</td>
<td class="gt_row gt_center" headers="비씨카드  제공형태">txt,csv</td>
<td class="gt_row gt_center" headers="비씨카드  제공시작일">‘20.7.17</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="비씨카드  분석구분">카드</td>
<td class="gt_row gt_center" headers="비씨카드  데이터  내역">유입지별카드매출</td>
<td class="gt_row gt_center" headers="비씨카드  제공  단위">행정동</td>
<td class="gt_row gt_center" headers="비씨카드  시간범위">2017년1월~ 2023년02월</td>
<td class="gt_row gt_center" headers="비씨카드  제공형태">txt,csv</td>
<td class="gt_row gt_center" headers="비씨카드  제공시작일">‘20.7.17</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="비씨카드  분석구분">카드</td>
<td class="gt_row gt_center" headers="비씨카드  데이터  내역">가맹점정보</td>
<td class="gt_row gt_center" headers="비씨카드  제공  단위">블록</td>
<td class="gt_row gt_center" headers="비씨카드  시간범위">2017년1월~ 2023년02월</td>
<td class="gt_row gt_center" headers="비씨카드  제공형태">txt,csv</td>
<td class="gt_row gt_center" headers="비씨카드  제공시작일">‘20.7.17</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="비씨카드  분석구분">카드</td>
<td class="gt_row gt_center" headers="비씨카드  데이터  내역">가맹점별카드매출</td>
<td class="gt_row gt_center" headers="비씨카드  제공  단위">블록</td>
<td class="gt_row gt_center" headers="비씨카드  시간범위">2017년1월~ 2023년02월</td>
<td class="gt_row gt_center" headers="비씨카드  제공형태">txt,csv</td>
<td class="gt_row gt_center" headers="비씨카드  제공시작일">‘20.7.17</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="비씨카드  분석구분">카드</td>
<td class="gt_row gt_center" headers="비씨카드  데이터  내역">요일별카드매출</td>
<td class="gt_row gt_center" headers="비씨카드  제공  단위">블록</td>
<td class="gt_row gt_center" headers="비씨카드  시간범위">2017년1월~ 2023년02월</td>
<td class="gt_row gt_center" headers="비씨카드  제공형태">txt,csv</td>
<td class="gt_row gt_center" headers="비씨카드  제공시작일">‘20.7.17</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="비씨카드  분석구분">카드</td>
<td class="gt_row gt_center" headers="비씨카드  데이터  내역">시간대별카드매출</td>
<td class="gt_row gt_center" headers="비씨카드  제공  단위">블록</td>
<td class="gt_row gt_center" headers="비씨카드  시간범위">2017년1월~ 2023년02월</td>
<td class="gt_row gt_center" headers="비씨카드  제공형태">txt,csv</td>
<td class="gt_row gt_center" headers="비씨카드  제공시작일">‘20.7.17</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="6" id="KT" class="gt_group_heading" data-quarto-table-cell-role="th" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black" scope="colgroup">KT</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_center" headers="KT  분석구분">격자별 유동인구</td>
<td class="gt_row gt_center" headers="KT  데이터  내역">성연령별 / 시간대별 유동인구</td>
<td class="gt_row gt_center" headers="KT  제공  단위">격자</td>
<td class="gt_row gt_center" headers="KT  시간범위">2017년6월~ 2022년12월</td>
<td class="gt_row gt_center" headers="KT  제공형태">csv</td>
<td class="gt_row gt_center" headers="KT  제공시작일">‘20.7.30</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="KT  분석구분">격자별 유동인구</td>
<td class="gt_row gt_center" headers="KT  데이터  내역">성연령별 유동인구</td>
<td class="gt_row gt_center" headers="KT  제공  단위">격자</td>
<td class="gt_row gt_center" headers="KT  시간범위">2017년6월~ 2022년12월</td>
<td class="gt_row gt_center" headers="KT  제공형태">csv</td>
<td class="gt_row gt_center" headers="KT  제공시작일">‘20.7.30</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="KT  분석구분">격자별 유동인구</td>
<td class="gt_row gt_center" headers="KT  데이터  내역">요일별 유동인구</td>
<td class="gt_row gt_center" headers="KT  제공  단위">격자</td>
<td class="gt_row gt_center" headers="KT  시간범위">2017년6월~ 2022년12월</td>
<td class="gt_row gt_center" headers="KT  제공형태">csv</td>
<td class="gt_row gt_center" headers="KT  제공시작일">‘20.7.30</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="KT  분석구분">격자별 유동인구</td>
<td class="gt_row gt_center" headers="KT  데이터  내역">시간대별 유동인구</td>
<td class="gt_row gt_center" headers="KT  제공  단위">격자</td>
<td class="gt_row gt_center" headers="KT  시간범위">2017년6월~ 2022년12월</td>
<td class="gt_row gt_center" headers="KT  제공형태">csv</td>
<td class="gt_row gt_center" headers="KT  제공시작일">‘20.7.30</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="KT  분석구분">도로별 유동인구</td>
<td class="gt_row gt_center" headers="KT  데이터  내역">성연령별 / 시간대별 유동인구</td>
<td class="gt_row gt_center" headers="KT  제공  단위">도로</td>
<td class="gt_row gt_center" headers="KT  시간범위">2017년6월~ 2022년12월</td>
<td class="gt_row gt_center" headers="KT  제공형태">csv</td>
<td class="gt_row gt_center" headers="KT  제공시작일">‘20.7.30</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="KT  분석구분">도로별 유동인구</td>
<td class="gt_row gt_center" headers="KT  데이터  내역">성연령별 유동인구</td>
<td class="gt_row gt_center" headers="KT  제공  단위">도로</td>
<td class="gt_row gt_center" headers="KT  시간범위">2017년6월~ 2022년12월</td>
<td class="gt_row gt_center" headers="KT  제공형태">csv</td>
<td class="gt_row gt_center" headers="KT  제공시작일">‘20.7.30</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="KT  분석구분">도로별 유동인구</td>
<td class="gt_row gt_center" headers="KT  데이터  내역">요일별 유동인구</td>
<td class="gt_row gt_center" headers="KT  제공  단위">도로</td>
<td class="gt_row gt_center" headers="KT  시간범위">2017년6월~ 2022년12월</td>
<td class="gt_row gt_center" headers="KT  제공형태">csv</td>
<td class="gt_row gt_center" headers="KT  제공시작일">‘20.7.30</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="KT  분석구분">도로별 유동인구</td>
<td class="gt_row gt_center" headers="KT  데이터  내역">시간대별 유동인구</td>
<td class="gt_row gt_center" headers="KT  제공  단위">도로</td>
<td class="gt_row gt_center" headers="KT  시간범위">2017년6월~ 2022년12월</td>
<td class="gt_row gt_center" headers="KT  제공형태">csv</td>
<td class="gt_row gt_center" headers="KT  제공시작일">‘20.7.30</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="경기-연도별-카드매출" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> 경기 연도별 카드매출</h1>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">월별 매출금액</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">개인/법인 매출</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">extrafont</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/extrafont/man/loadfonts.html">loadfonts</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">amt_files</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html">dir_ls</a></span><span class="op">(</span><span class="st">"data/BC카드데이터/TBSH_GYEONGGI_SELNG/"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">amt_raw</span> <span class="op">&lt;-</span> <span class="va">amt_files</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html">enframe</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">value</span>, <span class="va">read_delim</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">name</span>, <span class="st">"\\d+\\.txt$"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">amt_tbl</span> <span class="op">&lt;-</span> <span class="va">amt_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ta_ym <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ym</a></span><span class="op">(</span><span class="va">ta_ym</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">monthly_amt_tbl</span> <span class="op">&lt;-</span> <span class="va">amt_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ta_ym</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>결재건수 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">total_cnt</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">^</span><span class="fl">4</span>,</span>
<span>            결재금액 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">total_amt</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">^</span><span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">monthly_amt_gg</span> <span class="op">&lt;-</span> <span class="va">monthly_amt_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">ta_ym</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ta_ym</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>, y<span class="op">=</span> <span class="st">""</span>,</span>
<span>         title <span class="op">=</span> <span class="st">"경기도 카드 매출 추세"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="st">"BC 카드 월별 결재건수(단위: 만건)와 금액(단위:억원)"</span>,</span>
<span>         caption <span class="op">=</span> <span class="st">"출처: 경기도 데이터분석포털 민간 데이터셋"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html">comma</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">monthly_amt_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_png.html">agg_png</a></span><span class="op">(</span><span class="st">"images/BC/카드매출_월별_매출_건수_추세.png"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">monthly_amt_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/%EC%B9%B4%EB%93%9C%EB%A7%A4%EC%B6%9C_%EC%9B%94%EB%B3%84_%EB%A7%A4%EC%B6%9C_%EA%B1%B4%EC%88%98_%EC%B6%94%EC%84%B8.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="images/gg/%EC%B9%B4%EB%93%9C%EB%A7%A4%EC%B6%9C_%EC%9B%94%EB%B3%84_%EB%A7%A4%EC%B6%9C_%EA%B1%B4%EC%88%98_%EC%B6%94%EC%84%B8.png" class="img-fluid"></a></p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">monthly_type_amt_tbl</span> <span class="op">&lt;-</span> <span class="va">amt_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ta_ym</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>개인건수 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">indv_cnt</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">^</span><span class="fl">4</span>,</span>
<span>            개인금액 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">indv_amt</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">^</span><span class="fl">8</span>,</span>
<span>            법인건수 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">entp_cnt</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">^</span><span class="fl">4</span>,</span>
<span>            법인금액 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">entp_amt</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">^</span><span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">monthly_type_amt_gg</span> <span class="op">&lt;-</span> <span class="va">monthly_type_amt_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">ta_ym</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>구분 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">name</span>, <span class="st">"개인"</span><span class="op">)</span>, <span class="st">"개인카드"</span>, <span class="st">"법인카드"</span><span class="op">)</span>,</span>
<span>         금액건수 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">name</span>, <span class="st">"건수"</span><span class="op">)</span>, <span class="st">"건수"</span>, <span class="st">"금액"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ta_ym</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">구분</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">금액건수</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>, y<span class="op">=</span> <span class="st">""</span>,</span>
<span>         title <span class="op">=</span> <span class="st">"경기도 카드 매출 추세"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="st">"BC 카드 월별 카드유형별 결재건수(단위: 만건)와 금액(단위:억원)"</span>,</span>
<span>         caption <span class="op">=</span> <span class="st">"출처: 경기도 데이터분석포털 민간 데이터셋"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_sqrt</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html">comma</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="st">"1 year"</span>, minor_breaks <span class="op">=</span> <span class="st">"3 months"</span>,</span>
<span>                 date_labels <span class="op">=</span> <span class="st">"%Y"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">monthly_type_amt_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_png.html">agg_png</a></span><span class="op">(</span><span class="st">"images/BC/카드매출_월별_카드유형_매출_건수_추세.png"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">monthly_type_amt_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/%EC%B9%B4%EB%93%9C%EB%A7%A4%EC%B6%9C_%EC%9B%94%EB%B3%84_%EC%B9%B4%EB%93%9C%EC%9C%A0%ED%98%95_%EB%A7%A4%EC%B6%9C_%EA%B1%B4%EC%88%98_%EC%B6%94%EC%84%B8.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="images/gg/%EC%B9%B4%EB%93%9C%EB%A7%A4%EC%B6%9C_%EC%9B%94%EB%B3%84_%EC%B9%B4%EB%93%9C%EC%9C%A0%ED%98%95_%EB%A7%A4%EC%B6%9C_%EA%B1%B4%EC%88%98_%EC%B6%94%EC%84%B8.png" class="img-fluid"></a></p>
</div>
</div>
</div>
<section id="블록코드-시군구-매칭작업" class="level2" data-number="2.1"><h2 data-number="2.1">
<span class="header-section-number">2.1</span> 블록코드 시군구 매칭작업</h2>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">mst_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/(공통)셀블록도로행정동/경기도_시군구_행정동_명,CD.csv"</span>,</span>
<span>                    locale <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/locale.html">locale</a></span><span class="op">(</span><span class="st">'ko'</span>,encoding<span class="op">=</span><span class="st">'euc-kr'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_blk_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">"data/(공통)셀블록도로행정동/블록경계/블록_v6_경기도/tbshp_block_v6_gg_20210412.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_blk_tbl</span> <span class="op">&lt;-</span> <span class="va">gg_blk_sf</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_blk_mst_raw</span> <span class="op">&lt;-</span> <span class="va">mst_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">gg_blk_tbl</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
</section><section id="시군구별-월별-매출금액" class="level2" data-number="2.2"><h2 data-number="2.2">
<span class="header-section-number">2.2</span> 시군구별 월별 매출금액</h2>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg_blk_mst_tbl</span> <span class="op">&lt;-</span> <span class="va">gg_blk_mst_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">cty_cd</span>, <span class="va">cty_nm</span>, <span class="va">admi_cd</span>, <span class="va">admi_nm</span>, <span class="va">blk_cd</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sgg_amt_tbl</span> <span class="op">&lt;-</span> <span class="va">amt_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">gg_blk_mst_tbl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ta_ym</span>, <span class="va">cty_cd</span>, <span class="va">cty_nm</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>결재금액 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">total_amt</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span><span class="op">^</span><span class="fl">8</span>,</span>
<span>            결재건수 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">total_cnt</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sgg_amt_max_tbl</span> <span class="op">&lt;-</span> <span class="va">sgg_amt_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ta_ym</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">ta_ym</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">결재금액</span><span class="op">:</span><span class="va">결재건수</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/slowkow/ggrepel">ggrepel</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">sgg_amt_tbl_gg</span> <span class="op">&lt;-</span> <span class="va">sgg_amt_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">결재금액</span><span class="op">:</span><span class="va">결재건수</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ta_ym</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">cty_nm</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>, y<span class="op">=</span> <span class="st">""</span>,</span>
<span>         title <span class="op">=</span> <span class="st">"경기도 카드 매출 추세"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="st">"BC 카드 월별 시군구 결재건수(단위: 만건)와 금액(단위:억원)"</span>,</span>
<span>         caption <span class="op">=</span> <span class="st">"출처: 경기도 데이터분석포털 민간 데이터셋"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_sqrt</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html">comma</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="st">"1 year"</span>, minor_breaks <span class="op">=</span> <span class="st">"3 months"</span>,</span>
<span>                 date_labels <span class="op">=</span> <span class="st">"%Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sgg_amt_max_tbl</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">ta_ym</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">cty_nm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sgg_amt_max_tbl</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">ta_ym</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">cty_nm</span>, label<span class="op">=</span> <span class="va">cty_nm</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sgg_amt_tbl_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_png.html">agg_png</a></span><span class="op">(</span><span class="st">"images/BC/카드매출_월별_시군구_매출_건수_추세.png"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">sgg_amt_tbl_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
</section><section id="서해-인접-시군구" class="level2" data-number="2.3"><h2 data-number="2.3">
<span class="header-section-number">2.3</span> 서해 인접 시군구</h2>
<section id="블록코드-시군구-매칭작업-1" class="level3" data-number="2.3.1"><h3 data-number="2.3.1">
<span class="header-section-number">2.3.1</span> 블록코드 시군구 매칭작업</h3>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sea_sgg_mst</span> <span class="op">&lt;-</span> <span class="va">gg_blk_mst_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">CTY_NM</span>, <span class="st">"(^김포)|(^안산)|(^평택)|(^화성)|(^시흥)"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
</section><section id="서해인접-시군구-월별-매출금액" class="level3" data-number="2.3.2"><h3 data-number="2.3.2">
<span class="header-section-number">2.3.2</span> 서해인접 시군구 월별 매출금액</h3>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sea_sgg_mst_tbl</span> <span class="op">&lt;-</span> <span class="va">sea_sgg_mst</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">cty_cd</span>, <span class="va">cty_nm</span>, <span class="va">admi_cd</span>, <span class="va">admi_nm</span>, <span class="va">blk_cd</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sea_sgg_amt_tbl</span> <span class="op">&lt;-</span> <span class="va">amt_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">sea_sgg_mst_tbl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ta_ym</span>, <span class="va">cty_cd</span>, <span class="va">cty_nm</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>결재금액 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">total_amt</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span><span class="op">^</span><span class="fl">8</span>,</span>
<span>            결재건수 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">total_cnt</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sea_sgg_amt_max_tbl</span> <span class="op">&lt;-</span> <span class="va">sea_sgg_amt_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ta_ym</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">ta_ym</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">결재금액</span><span class="op">:</span><span class="va">결재건수</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sea_sgg_amt_tbl_gg</span> <span class="op">&lt;-</span> <span class="va">sea_sgg_amt_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">결재금액</span><span class="op">:</span><span class="va">결재건수</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ta_ym</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">cty_nm</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>, y<span class="op">=</span> <span class="st">""</span>,</span>
<span>         title <span class="op">=</span> <span class="st">"경기도 카드 매출 추세"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="st">"BC 카드 월별 서해인접 시군구 결재건수(단위: 만건)와 금액(단위:억원)"</span>,</span>
<span>         caption <span class="op">=</span> <span class="st">"출처: 경기도 데이터분석포털 민간 데이터셋"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_sqrt</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html">comma</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="st">"1 year"</span>, minor_breaks <span class="op">=</span> <span class="st">"3 months"</span>,</span>
<span>                 date_labels <span class="op">=</span> <span class="st">"%Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sea_sgg_amt_max_tbl</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">ta_ym</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">cty_nm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sea_sgg_amt_max_tbl</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">ta_ym</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">cty_nm</span>, label<span class="op">=</span> <span class="va">cty_nm</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sea_sgg_amt_tbl_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_png.html">agg_png</a></span><span class="op">(</span><span class="st">"images/BC/카드매출_월별_서해인접_시군구_매출_건수_추세.png"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">sea_sgg_amt_tbl_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/%EC%B9%B4%EB%93%9C%EB%A7%A4%EC%B6%9C_%EC%9B%94%EB%B3%84_%EC%84%9C%ED%95%B4%EC%9D%B8%EC%A0%91_%EC%8B%9C%EA%B5%B0%EA%B5%AC_%EB%A7%A4%EC%B6%9C_%EA%B1%B4%EC%88%98_%EC%B6%94%EC%84%B8.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="images/gg/%EC%B9%B4%EB%93%9C%EB%A7%A4%EC%B6%9C_%EC%9B%94%EB%B3%84_%EC%84%9C%ED%95%B4%EC%9D%B8%EC%A0%91_%EC%8B%9C%EA%B5%B0%EA%B5%AC_%EB%A7%A4%EC%B6%9C_%EA%B1%B4%EC%88%98_%EC%B6%94%EC%84%B8.png" class="img-fluid"></a></p>
</section></section><section id="서해-인접-행정동" class="level2" data-number="2.4"><h2 data-number="2.4">
<span class="header-section-number">2.4</span> 서해 인접 행정동</h2>
<section id="서해인접-시군구" class="level3" data-number="2.4.1"><h3 data-number="2.4.1">
<span class="header-section-number">2.4.1</span> 서해인접 시군구</h3>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg_blk_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">"data/(공통)셀블록도로행정동/블록경계/블록_v6_경기도/tbshp_block_v6_gg_20210412.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mst_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/(공통)셀블록도로행정동/경기도_시군구_행정동_명,CD.csv"</span>,</span>
<span>                    locale <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/locale.html">locale</a></span><span class="op">(</span><span class="st">'ko'</span>,encoding<span class="op">=</span><span class="st">'euc-kr'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sea_blk_sf</span> <span class="op">&lt;-</span> <span class="va">gg_blk_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">mst_tbl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">CTY_NM</span>, <span class="st">"(^김포)|(^안산)|(^평택)|(^화성)|(^시흥)"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">sea_blk_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">2017년 1월</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">2023년 5월</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">5개 시군구별</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">김포_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">"data/sgg_map/김포시.geojson"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">amt_start_tbl</span> <span class="op">&lt;-</span> <span class="va">amt_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ta_ym</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">ta_ym</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">amt_end_tbl</span> <span class="op">&lt;-</span> <span class="va">amt_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ta_ym</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">ta_ym</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sea_blk_amt_sf</span> <span class="op">&lt;-</span> <span class="va">sea_blk_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">amt_start_tbl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>total_manwon_amt <span class="op">=</span> <span class="va">total_amt</span> <span class="op">/</span> <span class="fl">10</span><span class="op">^</span><span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sea_blk_amt_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_set_crs</a></span><span class="op">(</span><span class="va">sea_blk_amt_sf</span>, <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">김포_sf</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sea_blk_amt_sf_gg</span> <span class="op">&lt;-</span> <span class="va">sea_blk_amt_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">total_manwon_amt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sea_blk_amt_sf</span>, color <span class="op">=</span> <span class="st">"red"</span>, fill <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"D"</span>, direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"결재금액(억원)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sea_blk_amt_sf_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_png.html">agg_png</a></span><span class="op">(</span><span class="st">"images/BC/카드매출_월별_서해인접_시군구_매출_201701.png"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">sea_blk_amt_sf_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/%EC%B9%B4%EB%93%9C%EB%A7%A4%EC%B6%9C_%EC%9B%94%EB%B3%84_%EC%84%9C%ED%95%B4%EC%9D%B8%EC%A0%91_%EC%8B%9C%EA%B5%B0%EA%B5%AC_%EB%A7%A4%EC%B6%9C_201701.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="images/gg/%EC%B9%B4%EB%93%9C%EB%A7%A4%EC%B6%9C_%EC%9B%94%EB%B3%84_%EC%84%9C%ED%95%B4%EC%9D%B8%EC%A0%91_%EC%8B%9C%EA%B5%B0%EA%B5%AC_%EB%A7%A4%EC%B6%9C_201701.png" class="img-fluid"></a></p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sea_blk_end_amt_sf</span> <span class="op">&lt;-</span> <span class="va">sea_blk_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">amt_end_tbl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>total_manwon_amt <span class="op">=</span> <span class="va">total_amt</span> <span class="op">/</span> <span class="fl">10</span><span class="op">^</span><span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sea_blk_end_amt_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_set_crs</a></span><span class="op">(</span><span class="va">sea_blk_end_amt_sf</span>, <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">김포_sf</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sea_blk_end_amt_gg</span> <span class="op">&lt;-</span> <span class="va">sea_blk_end_amt_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">total_manwon_amt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"D"</span>, direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"결재금액(억원)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sea_blk_end_amt_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_png.html">agg_png</a></span><span class="op">(</span><span class="st">"images/BC/카드매출_월별_서해인접_시군구_매출_202305.png"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">sea_blk_end_amt_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/%EC%B9%B4%EB%93%9C%EB%A7%A4%EC%B6%9C_%EC%9B%94%EB%B3%84_%EC%84%9C%ED%95%B4%EC%9D%B8%EC%A0%91_%EC%8B%9C%EA%B5%B0%EA%B5%AC_%EB%A7%A4%EC%B6%9C_202305.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="images/gg/%EC%B9%B4%EB%93%9C%EB%A7%A4%EC%B6%9C_%EC%9B%94%EB%B3%84_%EC%84%9C%ED%95%B4%EC%9D%B8%EC%A0%91_%EC%8B%9C%EA%B5%B0%EA%B5%AC_%EB%A7%A4%EC%B6%9C_202305.png" class="img-fluid"></a></p>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">bbox_lim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">sea_blk_end_amt_sf</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sea_blk_end_amt_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">total_manwon_amt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"D"</span>, direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"결재금액(억원)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bbox_lim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="fl">100000</span>, <span class="va">bbox_lim</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span>             ylim <span class="op">=</span> <span class="va">bbox_lim</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">sgg_names</span> <span class="op">&lt;-</span> <span class="va">sea_blk_end_amt_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">cty_nm</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cty_nm</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sgg_maps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">sgg_names</span>, </span>
<span>            .f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">sea_blk_end_amt_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">cty_nm</span> <span class="op">==</span> <span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">total_manwon_amt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"D"</span>, direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"결재금액(억원)"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## use COWplot to combine and add single legend</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">sgg_individual_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">sgg_maps</span>, labels <span class="op">=</span> <span class="va">sgg_names</span>, label_size <span class="op">=</span> <span class="fl">10</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sgg_individual_plot</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_png.html">agg_png</a></span><span class="op">(</span><span class="st">"images/BC/카드매출_월별_서해인접_시군구_개별_매출_202305.png"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">sgg_individual_plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/%EC%B9%B4%EB%93%9C%EB%A7%A4%EC%B6%9C_%EC%9B%94%EB%B3%84_%EC%84%9C%ED%95%B4%EC%9D%B8%EC%A0%91_%EC%8B%9C%EA%B5%B0%EA%B5%AC_%EA%B0%9C%EB%B3%84_%EB%A7%A4%EC%B6%9C_202305.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="images/gg/%EC%B9%B4%EB%93%9C%EB%A7%A4%EC%B6%9C_%EC%9B%94%EB%B3%84_%EC%84%9C%ED%95%B4%EC%9D%B8%EC%A0%91_%EC%8B%9C%EA%B5%B0%EA%B5%AC_%EA%B0%9C%EB%B3%84_%EB%A7%A4%EC%B6%9C_202305.png" class="img-fluid"></a></p>
</div>
</div>
</div>
</section></section></section><section id="광명시" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> 광명시</h1>
<section id="지도" class="level2" data-number="3.1"><h2 data-number="3.1">
<span class="header-section-number">3.1</span> 지도</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">경기도</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">셀(격자)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">도로</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">셀블럭</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="co"># gg_sf &lt;- sf::read_sf("(공통)셀블록도로행정동/행정동경계/행정동경계_경기도/행정동경계_경기도_좌표4326.shp")</span></span>
<span></span>
<span><span class="va">gg_sf</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">read_sf</a></span><span class="op">(</span><span class="st">"(공통)셀블록도로행정동/행정동경계/행정동경계_경기도/tbshp_admi_gg_20210614.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">CTY_NM</span>, <span class="va">geometry</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/km/km_gg_map.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="images/km/km_gg_map.png" class="img-fluid"></a></p>
<p>자료구조는 다음과 같다.</p>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
</details>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>광명시 <code>CTY_CD</code> == 4121</p>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># cell_sf &lt;- sf::read_sf("(공통)셀블록도로행정동/셀(격자)/cell_gg_square_admi2_20210614.shp")</span></span>
<span></span>
<span><span class="co"># fs::dir_create("km_sf")</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># cell_sf %&gt;% </span></span>
<span><span class="co">#   filter(CTY_CD == "4121") %&gt;% </span></span>
<span><span class="co">#   sf::write_sf("km_sf/kwangmyung.shp")</span></span>
<span></span>
<span><span class="va">kwangmyung_cell_sf</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">read_sf</a></span><span class="op">(</span><span class="st">"km_sf/kwangmyung.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kwangmyung_cell_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CTY_CD</span> <span class="op">==</span> <span class="st">"4121"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">CTY_CD</span>, <span class="va">geometry</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/km/km_cell_grid.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="images/km/km_cell_grid.png" class="img-fluid"></a></p>
<p>자료구조는 다음과 같다.</p>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kwangmyung_cell_sf</span></span></code></pre></div>
</details>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">road_sf</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">read_sf</a></span><span class="op">(</span><span class="st">"(공통)셀블록도로행정동/도로/addr_line_50m.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">road_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/km/km_road.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="images/km/km_road.png" class="img-fluid"></a></p>
<p>자료구조는 다음과 같다.</p>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">road_sf</span></span></code></pre></div>
</details>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<p>광명시 <code>CTY_CD</code> == 4121</p>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cell_block_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span><span class="st">"(공통)셀블록도로행정동/셀_블록_행정동/kt_cell_v6_20210528.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cell_block_mask</span> <span class="op">&lt;-</span> <span class="va">cell_block_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cell_block_raw</span> <span class="op">&lt;-</span> <span class="va">cell_block_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">cell_block_mask</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cell_block_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cell_block_raw</span>, </span>
<span>                          coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X_AXIS"</span>, <span class="st">"Y_AXIS"</span><span class="op">)</span>,</span>
<span>                          crs <span class="op">=</span> <span class="st">"+proj=tmerc +lat_0=38 +lon_0=128 +k=0.9999 +x_0=400000 +y_0=600000 +ellps=bessel +towgs84=-115.8,474.99,674.11,1.16,-2.31,-1.63,6.43 +units=m +no_defs"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kwangmyung_block_cell_sf</span> <span class="op">&lt;-</span> <span class="va">cell_block_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>CTY_CD <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">ADMI_CD</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CTY_CD</span> <span class="op">==</span> <span class="st">"4121"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kwangmyung_block_cell_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_write.html">write_sf</a></span><span class="op">(</span><span class="st">"km_sf/kwangmyung_cell_block.shp"</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kwangmyung_block_cell_sf</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">read_sf</a></span><span class="op">(</span><span class="st">"km_sf/kwangmyung_cell_block.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kwangmyung_block_cell_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">CTY_CD</span>, <span class="va">geometry</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/km/km_cell_block.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="images/km/km_cell_block.png" class="img-fluid"></a></p>
</div>
</div>
</div>
</section><section id="행정동-결합" class="level2" data-number="3.2"><h2 data-number="3.2">
<span class="header-section-number">3.2</span> 행정동 결합</h2>
<section id="시군구-행정동명" class="level3" data-number="3.2.1"><h3 data-number="3.2.1">
<span class="header-section-number">3.2.1</span> 시군구 행정동명</h3>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sgg_cd_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/(공통)셀블록도로행정동/경기도_시군구_행정동_명,CD.csv"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>MEGA_NM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/iconv.html">iconv</a></span><span class="op">(</span><span class="va">MEGA_NM</span>, <span class="st">"euc-kr"</span>, <span class="st">"utf-8"</span><span class="op">)</span>,</span>
<span>         CTY_NM  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/iconv.html">iconv</a></span><span class="op">(</span><span class="va">CTY_NM</span>, <span class="st">"euc-kr"</span>, <span class="st">"utf-8"</span><span class="op">)</span>,</span>
<span>         ADMI_NM  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/iconv.html">iconv</a></span><span class="op">(</span><span class="va">ADMI_NM</span>, <span class="st">"euc-kr"</span>, <span class="st">"utf-8"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sgg_cd_tbl</span></span></code></pre></div>
</details>
</div>
</section><section id="셀코드" class="level3" data-number="3.2.2"><h3 data-number="3.2.2">
<span class="header-section-number">3.2.2</span> 셀코드</h3>
<p>시군구 행정동명에서 셀코드를 추출하는 방법을 기술한다.</p>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cell_cd_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/(공통)셀블록도로행정동/셀(격자)/cell_gg_square_admi2_20210614.csv"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">get_city_cd</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">city_name</span> <span class="op">=</span> <span class="st">"광명"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sgg_cd_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">CTY_NM</span>, <span class="va">city_name</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">CTY_CD</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">kwangmyung_cell</span> <span class="op">&lt;-</span> <span class="va">cell_cd_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CTY_CD</span> <span class="op">==</span> <span class="fu">get_city_cd</span><span class="op">(</span><span class="st">"광명"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">광명시 행정동 지도</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">셀 지도</a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_dong_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">"data/(공통)셀블록도로행정동/행정동경계/행정동경계_경기도/행정동경계_경기도_좌표4326.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_dong_sf</span> <span class="op">&lt;-</span> <span class="va">gg_dong_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">ADMI_CD</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">==</span> <span class="fu">get_city_cd</span><span class="op">(</span><span class="st">"광명"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">km_dong_sf</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/km/km_adm_map.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="images/km/km_adm_map.png" class="img-fluid"></a></p>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">rgdal</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_raw</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">"data/(공통)셀블록도로행정동/셀(중심점)/cell_gg_admi2_20210616.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 좌표계 변환 KATEC --&gt; WGS84</span></span>
<span><span class="va">km_sf</span> <span class="op">&lt;-</span> <span class="va">gg_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CTY_CD</span> <span class="op">==</span> <span class="fu">get_city_cd</span><span class="op">(</span><span class="st">"광명"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="st">"+proj=longlat +ellps=bessel +no_defs +towgs84=-115.80,474.99,674.11,1.16,-2.31,-1.63,6.43"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_write.html">st_write</a></span><span class="op">(</span><span class="st">"data/km_cell.geojson"</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/km/km_adm_cell.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="images/km/km_adm_cell.png" class="img-fluid"></a></p>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">"data/km_cell.geojson"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">km_sf</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
</div>
</div>
</div>
</section></section><section id="국가공간정보포털" class="level2" data-number="3.3"><h2 data-number="3.3">
<span class="header-section-number">3.3</span> 국가공간정보포털</h2>
<p><a href="http://data.nsdi.go.kr/dataset/20171206ds00001">국가공간정보포털</a> (센서스경계)행정동경계 파일을 다운로드 받아 이를 점검해보자.</p>
<p><span class="column-margin"><a href="https://hongun7.tistory.com/6">한국 주요 좌표계 EPSG코드 및 proj4 인자 정리</a></span></p>
<blockquote>
<p>*Bessel 1841 경위도: 한국과 일본에 잘 맞는 지역타원체를 사용한 좌표계 EPSG:4004, EPSG:4162 (Korean 1985) +proj=longlat +ellps=bessel +no_defs +towgs84=-115.80,474.99,674.11,1.16,-2.31,-1.63,6.43</p>
</blockquote>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">매칭</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">광명시 행정동</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">결합</a></li>
</ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nsdi_sf</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">"data/kosis_map/Z_SOP_BND_ADM_DONG_PG.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nsdi_sf</span> <span class="op">&lt;-</span> <span class="va">nsdi_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="st">"+proj=longlat +ellps=WGS84 +datum=WGS84 +n8o_defs"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">km_nsdi_sf</span> <span class="op">&lt;-</span> <span class="va">nsdi_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>CTY_CD <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">ADM_CD</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CTY_CD</span> <span class="op">==</span> <span class="fl">31060</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">km_sf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>,</span>
<span>          color <span class="op">=</span> <span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">0.01</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">km_nsdi_sf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>,</span>
<span>          color <span class="op">=</span> <span class="st">"red"</span>, fill <span class="op">=</span> <span class="st">"white"</span>, alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/km/km_adm_cell_map.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="images/km/km_adm_cell_map.png" class="img-fluid"></a></p>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_dong_sf</span> <span class="op">&lt;-</span> <span class="va">gg_dong_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">ADMI_CD</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">==</span> <span class="fu">get_city_cd</span><span class="op">(</span><span class="st">"광명"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>행정동 <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">ADMI_CD</span>, <span class="fl">1</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">행정동</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html">st_union</a></span><span class="op">(</span><span class="va">geometry</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="st">"+proj=longlat +ellps=bessel +no_defs +towgs84=-115.80,474.99,674.11,1.16,-2.31,-1.63,6.43"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">km_dong_sf</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/km/km_adm_dong.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="images/km/km_adm_dong.png" class="img-fluid"></a></p>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">km_sf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>,</span>
<span>          color <span class="op">=</span> <span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">0.01</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">km_dong_sf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>,</span>
<span>          color <span class="op">=</span> <span class="st">"red"</span>, fill <span class="op">=</span> <span class="st">"white"</span>, alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/km/km_adm_dong_cell.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="images/km/km_adm_dong_cell.png" class="img-fluid"></a></p>
</div>
</div>
</div>
</section><section id="광명시-유동인구" class="level2" data-number="3.4"><h2 data-number="3.4">
<span class="header-section-number">3.4</span> 광명시 유동인구</h2>
<section id="데이터셋" class="level3" data-number="3.4.1"><h3 data-number="3.4.1">
<span class="header-section-number">3.4.1</span> 데이터셋</h3>
<section id="년-6월-script" class="level4" data-number="3.4.1.1"><h4 data-number="3.4.1.1">
<span class="header-section-number">3.4.1.1</span> 2017년 6월 (Script)</h4>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">extrafont</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/extrafont/man/loadfonts.html">loadfonts</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kt_cell_files</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html">dir_ls</a></span><span class="op">(</span><span class="st">"data/KT유동인구데이터/셀단위/sex_age/"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sex_age_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/KT유동인구데이터/셀단위/sex_age/sex_age_201706.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_sex_age</span> <span class="op">&lt;-</span> <span class="va">sex_age_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co">## 광명시만 추출</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">cell_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">km_cell_sf</span><span class="op">$</span><span class="va">cell_id</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co">## 자료구조 변환</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">M00_09</span><span class="op">:</span><span class="va">F60_up</span>, names_to <span class="op">=</span> <span class="st">"name"</span>, values_to <span class="op">=</span> <span class="st">"인구수"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>성별 <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">name</span>, <span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>         연령대 <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">name</span>, <span class="fl">2</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co">## 자료형 변환</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>연령대 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">연령대</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"00_09"</span>, <span class="st">"10_19"</span>, <span class="st">"20_29"</span>, <span class="st">"30_39"</span>, <span class="st">"40_49"</span>, <span class="st">"50_59"</span>, <span class="st">"60_up"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         성별 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">성별</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M"</span>, <span class="st">"F"</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"남성"</span>, <span class="st">"여성"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">name</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_grid_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="va">grid_map</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="va">km_map</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_dong_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">km_grid_tbl</span>, <span class="va">km_tbl</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MEGA_CD"</span>, <span class="st">"ADMI_CD"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_sex_age_tbl</span> <span class="op">&lt;-</span> <span class="va">km_sex_age</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">km_dong_tbl</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">km_sex_age_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">etl_ym</span>, <span class="va">ADMI_NM</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>인구수 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">인구수</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
</section><section id="년-6월-함수" class="level4" data-number="3.4.1.2"><h4 data-number="3.4.1.2">
<span class="header-section-number">3.4.1.2</span> 2017년 6월 (함수)</h4>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## MEGA_CD, ADMI_CD, cell_id 결합</span></span>
<span><span class="va">km_grid_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="va">grid_map</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="va">km_map</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_dong_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">km_grid_tbl</span>, <span class="va">km_tbl</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MEGA_CD"</span>, <span class="st">"ADMI_CD"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 광명시 </span></span>
<span><span class="va">get_km_sex_age</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">yearmon</span><span class="op">=</span><span class="st">"data/KT유동인구데이터/셀단위/sex_age/sex_age_201706.csv"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\n ------------------\n"</span>, <span class="va">yearmon</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">sex_age_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="va">yearmon</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">km_sex_age</span> <span class="op">&lt;-</span> <span class="va">sex_age_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="co">## 광명시만 추출</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">cell_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">km_cell_sf</span><span class="op">$</span><span class="va">cell_id</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co">## 자료구조 변환</span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">M00_09</span><span class="op">:</span><span class="va">F60_up</span>, names_to <span class="op">=</span> <span class="st">"name"</span>, values_to <span class="op">=</span> <span class="st">"인구수"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>성별 <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">name</span>, <span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>           연령대 <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">name</span>, <span class="fl">2</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co">## 자료형 변환</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>연령대 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">연령대</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"00_09"</span>, <span class="st">"10_19"</span>, <span class="st">"20_29"</span>, <span class="st">"30_39"</span>, <span class="st">"40_49"</span>, <span class="st">"50_59"</span>, <span class="st">"60_up"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           성별 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">성별</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M"</span>, <span class="st">"F"</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"남성"</span>, <span class="st">"여성"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">name</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">km_sex_age_tbl</span> <span class="op">&lt;-</span> <span class="va">km_sex_age</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">km_dong_tbl</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">km_sex_age_tbl</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">get_km_sex_age</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
</section><section id="년" class="level4" data-number="3.4.1.3"><h4 data-number="3.4.1.3">
<span class="header-section-number">3.4.1.3</span> 2018~2022년</h4>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kt_cell_files_raw</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html">dir_ls</a></span><span class="op">(</span><span class="st">"data/KT유동인구데이터/셀단위/sex_age/"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kt_cell_files</span> <span class="op">&lt;-</span> <span class="va">kt_cell_files_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html">enframe</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co">## 2018~2022년만 추출</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>년월 <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">name</span>, <span class="st">"\\d+"</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">년월</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2017"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co">## 2018~2022년만 추출</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>년월 <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">name</span>, <span class="st">"\\d+"</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>년월 <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ym</a></span><span class="op">(</span><span class="va">년월</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_age_sex_yearmon</span> <span class="op">&lt;-</span> <span class="va">kt_cell_files</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">get_km_sex_age</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_age_sex_yearmon</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">write_rds</a></span><span class="op">(</span><span class="st">"data/km_age_sex_yearmon.rds"</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
</section></section></section><section id="분석" class="level2" data-number="3.5"><h2 data-number="3.5">
<span class="header-section-number">3.5</span> 분석</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">추세</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">행정동별</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">성별</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">연령대별</a></li>
</ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">extrafont</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/extrafont/man/loadfonts.html">loadfonts</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_age_sex_yearmon</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">read_rds</a></span><span class="op">(</span><span class="st">"data/km_age_sex_yearmon.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_age_sex_yearmon_tbl</span> <span class="op">&lt;-</span> <span class="va">km_age_sex_yearmon</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>년월 <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ym</a></span><span class="op">(</span><span class="va">etl_ym</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_year_mon_total</span> <span class="op">&lt;-</span> <span class="va">km_age_sex_yearmon_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">년월</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>인구수 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">인구수</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_year_mon_total_gg</span> <span class="op">&lt;-</span> <span class="va">km_year_mon_total</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>인구수 <span class="op">=</span> <span class="va">인구수</span> <span class="op">/</span> <span class="fl">10</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">년월</span>, y<span class="op">=</span><span class="va">인구수</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"Malgun Gothic"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"광명시 월별 유동인구"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="st">"2018년 1월 ~ 2022년 12월"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">""</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"유동인구(만명)"</span>,</span>
<span>         caption <span class="op">=</span> <span class="st">"데이터 출처: KT 유동인구 데이터(경기도 데이터분석센터"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html">comma</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_year_mon_total_gg</span></span>
<span></span>
<span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/create.html">dir_create</a></span><span class="op">(</span><span class="st">"images/KT"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_png.html">agg_png</a></span><span class="op">(</span><span class="st">"images/KT/광명시_월별_유동인구.png"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">km_year_mon_total_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/km/%EA%B4%91%EB%AA%85%EC%8B%9C_%EC%9B%94%EB%B3%84_%EC%9C%A0%EB%8F%99%EC%9D%B8%EA%B5%AC.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="images/km/%EA%B4%91%EB%AA%85%EC%8B%9C_%EC%9B%94%EB%B3%84_%EC%9C%A0%EB%8F%99%EC%9D%B8%EA%B5%AC.png" class="img-fluid"></a></p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km_year_mon_total_dong</span> <span class="op">&lt;-</span> <span class="va">km_age_sex_yearmon_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">년월</span>, <span class="va">ADMI_NM</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>인구수 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">인구수</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_year_mon_total_dong_gg</span> <span class="op">&lt;-</span> <span class="va">km_year_mon_total_dong</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>인구수 <span class="op">=</span> <span class="va">인구수</span> <span class="op">/</span> <span class="fl">10</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">년월</span>, y<span class="op">=</span><span class="va">인구수</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"Malgun Gothic"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"광명시 동별 유동인구"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="st">"2018년 1월 ~ 2022년 12월"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">""</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"유동인구(만명)"</span>,</span>
<span>         caption <span class="op">=</span> <span class="st">"데이터 출처: KT 유동인구 데이터(경기도 데이터분석센터"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html">comma</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">ADMI_NM</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_year_mon_total_dong_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_png.html">agg_png</a></span><span class="op">(</span><span class="st">"images/KT/광명시_월별_동별_유동인구.png"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">km_year_mon_total_dong_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/km/%EA%B4%91%EB%AA%85%EC%8B%9C_%EC%9B%94%EB%B3%84_%EB%8F%99%EB%B3%84_%EC%9C%A0%EB%8F%99%EC%9D%B8%EA%B5%AC.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="images/km/%EA%B4%91%EB%AA%85%EC%8B%9C_%EC%9B%94%EB%B3%84_%EB%8F%99%EB%B3%84_%EC%9C%A0%EB%8F%99%EC%9D%B8%EA%B5%AC.png" class="img-fluid"></a></p>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km_year_mon_total_dong_sex</span> <span class="op">&lt;-</span> <span class="va">km_age_sex_yearmon_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">년월</span>, <span class="va">ADMI_NM</span>, <span class="va">성별</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>인구수 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">인구수</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_year_mon_total_dong_sex_gg</span> <span class="op">&lt;-</span> <span class="va">km_year_mon_total_dong_sex</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>인구수 <span class="op">=</span> <span class="va">인구수</span> <span class="op">/</span> <span class="fl">10</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">년월</span>, y<span class="op">=</span><span class="va">인구수</span>, color <span class="op">=</span> <span class="va">성별</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"Malgun Gothic"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"광명시 동별 유동인구"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="st">"2018년 1월 ~ 2022년 12월"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">""</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"유동인구(만명)"</span>,</span>
<span>         caption <span class="op">=</span> <span class="st">"데이터 출처: KT 유동인구 데이터(경기도 데이터분석센터"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html">comma</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">ADMI_NM</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"남성"</span> <span class="op">=</span> <span class="st">"blue"</span>, <span class="st">"여성"</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_year_mon_total_dong_sex_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_png.html">agg_png</a></span><span class="op">(</span><span class="st">"images/KT/광명시_월별_동별_성별_유동인구.png"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">km_year_mon_total_dong_sex_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/km/%EA%B4%91%EB%AA%85%EC%8B%9C_%EC%9B%94%EB%B3%84_%EB%8F%99%EB%B3%84_%EC%84%B1%EB%B3%84_%EC%9C%A0%EB%8F%99%EC%9D%B8%EA%B5%AC.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="images/km/%EA%B4%91%EB%AA%85%EC%8B%9C_%EC%9B%94%EB%B3%84_%EB%8F%99%EB%B3%84_%EC%84%B1%EB%B3%84_%EC%9C%A0%EB%8F%99%EC%9D%B8%EA%B5%AC.png" class="img-fluid"></a></p>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/hrbrmstr/hrbrthemes">hrbrthemes</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_year_mon_total_dong_age</span> <span class="op">&lt;-</span> <span class="va">km_age_sex_yearmon_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>세대별 <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="va">연령대</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"00_09"</span>, <span class="st">"10_19"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"00~19"</span>,</span>
<span>                            <span class="va">연령대</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"20_29"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"20~29"</span>,</span>
<span>                            <span class="va">연령대</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"30_39"</span>, <span class="st">"40_49"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"30~49"</span>,</span>
<span>                            <span class="va">연령대</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"50_59"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"50~59"</span>,</span>
<span>                            <span class="va">연령대</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"60_up"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"60~이상"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">년월</span>, <span class="va">ADMI_NM</span>, <span class="va">세대별</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>인구수 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">인구수</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_year_mon_total_dong_age_gg</span> <span class="op">&lt;-</span> <span class="va">km_year_mon_total_dong_age</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>인구수 <span class="op">=</span> <span class="va">인구수</span> <span class="op">/</span> <span class="fl">10</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">년월</span>, y<span class="op">=</span><span class="va">인구수</span>, color <span class="op">=</span> <span class="va">세대별</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"Malgun Gothic"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"광명시 세대별 유동인구"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="st">"2018년 1월 ~ 2022년 12월"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">""</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"유동인구(만명)"</span>,</span>
<span>         caption <span class="op">=</span> <span class="st">"데이터 출처: KT 유동인구 데이터(경기도 데이터분석센터"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html">comma</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">ADMI_NM</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">km_year_mon_total_dong_age_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_png.html">agg_png</a></span><span class="op">(</span><span class="st">"images/KT/광명시_월별_동별_세대별_유동인구.png"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">km_year_mon_total_dong_age_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/km/%EA%B4%91%EB%AA%85%EC%8B%9C_%EC%9B%94%EB%B3%84_%EB%8F%99%EB%B3%84_%EC%84%B8%EB%8C%80%EB%B3%84_%EC%9C%A0%EB%8F%99%EC%9D%B8%EA%B5%AC.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="images/km/%EA%B4%91%EB%AA%85%EC%8B%9C_%EC%9B%94%EB%B3%84_%EB%8F%99%EB%B3%84_%EC%84%B8%EB%8C%80%EB%B3%84_%EC%9C%A0%EB%8F%99%EC%9D%B8%EA%B5%AC.png" class="img-fluid"></a></p>
</div>
</div>
</div>
</section><section id="소하2동" class="level2" data-number="3.6"><h2 data-number="3.6">
<span class="header-section-number">3.6</span> 소하2동</h2>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/classInt/">classInt</a></span><span class="op">)</span></span>
<span><span class="fu">extrafont</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/extrafont/man/loadfonts.html">loadfonts</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_dong_raw</span> <span class="op">&lt;-</span> <span class="va">km_age_sex_yearmon_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ADMI_NM</span> <span class="op">==</span> <span class="st">"소하2동"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_dong_tbl</span> <span class="op">&lt;-</span> <span class="va">km_dong_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>년도 <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">년월</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">cell_id</span>,  <span class="va">x_axis</span>, <span class="va">y_axis</span>, <span class="va">년도</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>인구수 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">인구수</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> </span>
<span>  </span>
<span></span>
<span><span class="va">breaks</span> <span class="op">&lt;-</span> <span class="fu">classInt</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/classInt/reference/classIntervals.html">classIntervals</a></span><span class="op">(</span></span>
<span>    <span class="va">km_dong_tbl</span><span class="op">$</span><span class="va">인구수</span>,</span>
<span>    n <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    style <span class="op">=</span> <span class="st">"fisher"</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">brks</span></span>
<span></span>
<span><span class="va">vmin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span></span>
<span>    <span class="va">km_dong_tbl</span><span class="op">$</span><span class="va">인구수</span>,</span>
<span>    na.rm <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">vmax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span></span>
<span>    <span class="va">km_dong_tbl</span><span class="op">$</span><span class="va">인구수</span>,</span>
<span>    na.rm <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_dong_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">km_dong_tbl</span>,                         </span>
<span>        coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x_axis"</span>, <span class="st">"y_axis"</span><span class="op">)</span>,</span>
<span>        crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">km_map</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_dong_year_gg</span> <span class="op">&lt;-</span> <span class="va">km_dong_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>geometry<span class="op">=</span><span class="va">geometry</span>, size <span class="op">=</span> <span class="va">인구수</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">년도</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html">scale_size_continuous</a></span><span class="op">(</span></span>
<span>      breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">breaks</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>      range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>      limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">vmin</span>, <span class="va">vmax</span><span class="op">)</span>,</span>
<span>      name <span class="op">=</span> <span class="st">"유동인구"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"Malgun Gothic"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"광명시 소하2동 연도별 유동인구"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="st">"2018년 1월 ~ 2022년 12월"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">""</span>,</span>
<span>         y <span class="op">=</span> <span class="st">""</span>,</span>
<span>         size <span class="op">=</span> <span class="st">"유동인구(만명)"</span>,</span>
<span>         caption <span class="op">=</span> <span class="st">"데이터 출처: KT 유동인구 데이터(경기도 데이터분석센터"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">km_dong_year_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_png.html">agg_png</a></span><span class="op">(</span><span class="st">"images/KT/광명시_소하2동_연도별_유동인구.png"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">5</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">km_dong_year_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/km/%EA%B4%91%EB%AA%85%EC%8B%9C_%EC%86%8C%ED%95%982%EB%8F%99_%EC%97%B0%EB%8F%84%EB%B3%84_%EC%9C%A0%EB%8F%99%EC%9D%B8%EA%B5%AC.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="images/km/%EA%B4%91%EB%AA%85%EC%8B%9C_%EC%86%8C%ED%95%982%EB%8F%99_%EC%97%B0%EB%8F%84%EB%B3%84_%EC%9C%A0%EB%8F%99%EC%9D%B8%EA%B5%AC.png" class="img-fluid"></a></p>
</section></section><section id="경기도-어항" class="level1" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> 경기도 어항</h1>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">경기도 지도</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">항구지도</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">시군구 어항</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false">항구 행정동(추출)</a></li>
</ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com/">gt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jthomasmock/gtExtras">gtExtras</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">camcorder</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">katec_crs</span> <span class="op">&lt;-</span> <span class="st">"+proj=tmerc +lat_0=38 +lon_0=128 +k=0.9999 +x_0=400000 +y_0=600000 +ellps=bessel +units=m +no_defs"</span></span>
<span></span>
<span></span>
<span><span class="va">gg_admin_map</span> <span class="op">&lt;-</span> </span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">"data/(공통)셀블록도로행정동/행정동경계/행정동경계_경기도/tbshp_admi_gg_20210614.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_admin_map</span> <span class="op">&lt;-</span> <span class="va">gg_admin_map</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_set_crs</a></span><span class="op">(</span><span class="va">katec_crs</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_city_map</span> <span class="op">&lt;-</span> <span class="va">gg_admin_map</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">cty_nm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html">st_union</a></span><span class="op">(</span><span class="va">geometry</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">gg_city_map</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/gg_map.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="images/gg/gg_map.png" class="img-fluid"></a></p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">port_tbl</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data/국가어항.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"경기어항"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">port_sf</span> <span class="op">&lt;-</span> <span class="va">port_tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># WGS84</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># KATEC</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="st">"+proj=tmerc +lat_0=38 +lon_0=128 +k=0.9999 +x_0=400000 +y_0=600000 +ellps=bessel +units=m +no_defs"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">port_sf</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div>
<figure><p><a href="gg_analytics_center_files/figure-html/unnamed-chunk-40-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="gg_analytics_center_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg_city_bbox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">gg_city_map</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_port_map_gg</span> <span class="op">&lt;-</span> <span class="va">gg_city_map</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">gg_city_map</span>,</span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">cty_nm</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>        min.segment.length <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">4</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>      family <span class="op">=</span> <span class="st">"MaruBrui"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">port_sf</span>, size <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">port_sf</span>,</span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">어항명</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>        min.segment.length <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">5</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>        hjust <span class="op">=</span> <span class="fl">10</span>,</span>
<span>        family <span class="op">=</span> <span class="st">"MaruBrui"</span>, fontface <span class="op">=</span> <span class="st">'bold'</span></span>
<span>    <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">gg_city_bbox</span><span class="op">[</span><span class="st">'xmin'</span><span class="op">]</span><span class="op">-</span><span class="fl">10000</span>, </span>
<span>                    <span class="va">gg_city_bbox</span><span class="op">[</span><span class="st">'xmax'</span><span class="op">]</span><span class="op">-</span><span class="fl">50000</span><span class="op">)</span>,</span>
<span>           ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">gg_city_bbox</span><span class="op">[</span><span class="st">'ymin'</span><span class="op">]</span>, </span>
<span>                    <span class="va">gg_city_bbox</span><span class="op">[</span><span class="st">'ymax'</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"MaruBuri"</span>, size <span class="op">=</span> <span class="fl">24</span><span class="op">)</span>, </span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"경기도 지방 항구"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"출처: 경기도 데이터분석센터"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span>  </span>
<span></span>
<span><span class="va">gg_port_map_gg</span> </span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_jpeg.html">agg_jpeg</a></span><span class="op">(</span><span class="st">"images/항구_통계/01_경기도_어항_행정동.jpg"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">gg_port_map_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/01_%EA%B2%BD%EA%B8%B0%EB%8F%84_%EC%96%B4%ED%95%AD_%ED%96%89%EC%A0%95%EB%8F%99.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img src="images/gg/01_%EA%B2%BD%EA%B8%B0%EB%8F%84_%EC%96%B4%ED%95%AD_%ED%96%89%EC%A0%95%EB%8F%99.jpg" class="img-fluid"></a></p>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ports_adm_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_join.html">st_join</a></span><span class="op">(</span><span class="va">gg_admin_map</span>, <span class="va">port_sf</span>, maxdist <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>                        join <span class="op">=</span> <span class="fu">nngeo</span><span class="fu">::</span><span class="va"><a href="https://michaeldorman.github.io/nngeo/reference/st_nn.html">st_nn</a></span>, left <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span>ascii <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>sgg_name <span class="op">=</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"{어항명}"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># mutate(sgg_name = glue::glue("{어항명}: {cty_nm}"))</span></span>
<span></span>
<span><span class="va">ports_adm_dong_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">ports_adm_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">port_sf</span>,</span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">어항명</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>      size <span class="op">=</span> <span class="fl">3</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>, family <span class="op">=</span> <span class="st">"MaruBrui"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">port_sf</span>, size <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"red"</span>, alpha<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">gg_city_bbox</span><span class="op">[</span><span class="st">'xmin'</span><span class="op">]</span><span class="op">-</span><span class="fl">10000</span>, </span>
<span>                  <span class="va">gg_city_bbox</span><span class="op">[</span><span class="st">'xmax'</span><span class="op">]</span><span class="op">-</span><span class="fl">60000</span><span class="op">)</span>,</span>
<span>         ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">gg_city_bbox</span><span class="op">[</span><span class="st">'ymin'</span><span class="op">]</span>, </span>
<span>                  <span class="va">gg_city_bbox</span><span class="op">[</span><span class="st">'ymax'</span><span class="op">]</span><span class="op">-</span><span class="fl">65000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"MaruBuri"</span>, size <span class="op">=</span> <span class="fl">24</span><span class="op">)</span>, </span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"경기도 지방 항구"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"지방항구 시군구 행정동"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"출처: 경기도 데이터분석센터"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span>  </span>
<span>  </span>
<span><span class="va">ports_adm_dong_gg</span> </span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_jpeg.html">agg_jpeg</a></span><span class="op">(</span><span class="st">"images/항구_통계/01_경기도_어항_행정동_추출.jpg"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">ports_adm_dong_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/01_%EA%B2%BD%EA%B8%B0%EB%8F%84_%EC%96%B4%ED%95%AD_%ED%96%89%EC%A0%95%EB%8F%99_%EC%B6%94%EC%B6%9C.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-24"><img src="images/gg/01_%EA%B2%BD%EA%B8%B0%EB%8F%84_%EC%96%B4%ED%95%AD_%ED%96%89%EC%A0%95%EB%8F%99_%EC%B6%94%EC%B6%9C.jpg" class="img-fluid"></a></p>
</div>
</div>
</div>
</section><section id="각-항구" class="level1" data-number="5"><h1 data-number="5">
<span class="header-section-number">5</span> 각 항구</h1>
<section id="김포시-대명항" class="level2" data-number="5.1"><h2 data-number="5.1">
<span class="header-section-number">5.1</span> 김포시 대명항</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">김포시 위치</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">김포시 대명항</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">대명항 인근 1 KM</a></li>
</ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com/">gt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jthomasmock/gtExtras">gtExtras</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">katec_crs</span> <span class="op">&lt;-</span> <span class="st">"+proj=tmerc +lat_0=38 +lon_0=128 +k=0.9999 +x_0=400000 +y_0=600000 +ellps=bessel +units=m +no_defs"</span></span>
<span></span>
<span><span class="va">gg_admin_map</span> <span class="op">&lt;-</span> </span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">"data/(공통)셀블록도로행정동/행정동경계/행정동경계_경기도/tbshp_admi_gg_20210614.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_admin_map</span> <span class="op">&lt;-</span> <span class="va">gg_admin_map</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_set_crs</a></span><span class="op">(</span><span class="va">katec_crs</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_city_map</span> <span class="op">&lt;-</span> <span class="va">gg_admin_map</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">cty_nm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html">st_union</a></span><span class="op">(</span><span class="va">geometry</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>cty_target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">cty_nm</span>, <span class="st">"김포"</span><span class="op">)</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_gimpo_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gg_city_map</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">cty_target</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gray90"</span>, <span class="st">"skyblue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">gg_city_map</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">cty_target</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">cty_nm</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>        min.segment.length <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">4</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>      family <span class="op">=</span> <span class="st">"MaruBrui"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_gimpo_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_jpeg.html">agg_jpeg</a></span><span class="op">(</span><span class="st">"images/항구_통계/02_경기도_김포시.jpg"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">gg_gimpo_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/02_%EA%B2%BD%EA%B8%B0%EB%8F%84_%EA%B9%80%ED%8F%AC%EC%8B%9C.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img src="images/gg/02_%EA%B2%BD%EA%B8%B0%EB%8F%84_%EA%B9%80%ED%8F%AC%EC%8B%9C.jpg" class="img-fluid"></a></p>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 김포시 </span></span>
<span><span class="va">gimpo_adm_sf</span> <span class="op">&lt;-</span> <span class="va">gg_admin_map</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CTY_NM</span> <span class="op">==</span> <span class="st">"김포시"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 항구</span></span>
<span><span class="va">port_tbl</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data/국가어항.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"경기어항"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">port_sf</span> <span class="op">&lt;-</span> <span class="va">port_tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># WGS84</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># KATEC</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">katec_crs</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_gimpo_port_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gimpo_adm_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gray90"</span>, <span class="st">"skyblue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">gimpo_adm_sf</span>,</span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">ADMI_NM</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>      min.segment.length <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">4</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>, family <span class="op">=</span> <span class="st">"MaruBrui"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"대명항"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"red"</span>, alpha<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"대명항"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">어항명</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>      min.segment.length <span class="op">=</span> <span class="fl">3</span>, size <span class="op">=</span> <span class="fl">4</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>, family <span class="op">=</span> <span class="st">"MaruBrui"</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>    </span>
<span></span>
<span><span class="va">gg_gimpo_port_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_jpeg.html">agg_jpeg</a></span><span class="op">(</span><span class="st">"images/항구_통계/02_경기도_김포시_대명항.jpg"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">gg_gimpo_port_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/02_%EA%B2%BD%EA%B8%B0%EB%8F%84_%EA%B9%80%ED%8F%AC%EC%8B%9C_%EB%8C%80%EB%AA%85%ED%95%AD.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-26"><img src="images/gg/02_%EA%B2%BD%EA%B8%B0%EB%8F%84_%EA%B9%80%ED%8F%AC%EC%8B%9C_%EB%8C%80%EB%AA%85%ED%95%AD.jpg" class="img-fluid"></a></p>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">cell_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">"data/(공통)셀블록도로행정동/셀(중심점)/cell_gg_admi2_20210616.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gimpo_cty_cell_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">cell_sf</span>, <span class="va">katec_crs</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CTY_CD</span> <span class="op">==</span> <span class="va">gg_admin_map</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CTY_NM</span> <span class="op">==</span> <span class="st">"김포시"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">CTY_CD</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 항구 인근 1 KM</span></span>
<span><span class="va">gimpo_ports_cell_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_join.html">st_join</a></span><span class="op">(</span><span class="va">gimpo_cty_cell_sf</span>,</span>
<span>                               <span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"대명항"</span><span class="op">)</span>, </span>
<span>                         maxdist <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>                         join <span class="op">=</span> <span class="fu">nngeo</span><span class="fu">::</span><span class="va"><a href="https://michaeldorman.github.io/nngeo/reference/st_nn.html">st_nn</a></span>, left <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gimpo_ports_bbox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">gimpo_ports_cell_sf</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### 1. 김포시 Inset</span></span>
<span></span>
<span><span class="va">inset_gimpo_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">## 1. 행정동 ---------</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gimpo_adm_sf</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">gimpo_adm_sf</span>,</span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">ADMI_NM</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>      min.segment.length <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">2</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>, family <span class="op">=</span> <span class="st">"MaruBrui"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">## 2. 항구 ---------  </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"대명항"</span><span class="op">)</span>, </span>
<span>          size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"blue"</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">gimpo_ports_bbox</span><span class="op">[</span><span class="st">'xmin'</span><span class="op">]</span><span class="op">-</span><span class="fl">1000</span>, </span>
<span>                xmax <span class="op">=</span> <span class="va">gimpo_ports_bbox</span><span class="op">[</span><span class="st">'xmax'</span><span class="op">]</span><span class="op">+</span><span class="fl">1000</span>, </span>
<span>                ymin <span class="op">=</span> <span class="va">gimpo_ports_bbox</span><span class="op">[</span><span class="st">'ymin'</span><span class="op">]</span><span class="op">-</span><span class="fl">1000</span>, </span>
<span>                ymax <span class="op">=</span> <span class="va">gimpo_ports_bbox</span><span class="op">[</span><span class="st">'ymax'</span><span class="op">]</span><span class="op">+</span><span class="fl">1000</span><span class="op">)</span>, fill<span class="op">=</span><span class="cn">NA</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">inset_gimpo_gg</span></span>
<span></span>
<span><span class="co">### 2. 김포시 대명항</span></span>
<span></span>
<span><span class="va">inset_gimpo_daemyung_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gimpo_adm_sf</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span> <span class="va">gimpo_ports_cell_sf</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"대명항"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span>, </span>
<span>          color <span class="op">=</span> <span class="st">"blue"</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"대명항"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">어항명</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>      min.segment.length <span class="op">=</span> <span class="fl">3</span>, size <span class="op">=</span> <span class="fl">4</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>, family <span class="op">=</span> <span class="st">"MaruBrui"</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">gimpo_ports_bbox</span><span class="op">[</span><span class="st">'xmin'</span><span class="op">]</span><span class="op">-</span><span class="fl">1000</span>, </span>
<span>                      <span class="va">gimpo_ports_bbox</span><span class="op">[</span><span class="st">'xmax'</span><span class="op">]</span><span class="op">+</span><span class="fl">1000</span><span class="op">)</span>,</span>
<span>             ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">gimpo_ports_bbox</span><span class="op">[</span><span class="st">'ymin'</span><span class="op">]</span><span class="op">-</span><span class="fl">1000</span>, </span>
<span>                      <span class="va">gimpo_ports_bbox</span><span class="op">[</span><span class="st">'ymax'</span><span class="op">]</span><span class="op">+</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggspatial</span><span class="fu">::</span><span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_scale.html">annotation_scale</a></span><span class="op">(</span>location <span class="op">=</span> <span class="st">"br"</span>, width_hint <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                               height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 3. 김포시 + 대명항 지도 -------------------------------  </span></span>
<span><span class="va">daemyung_port_inset_map</span> <span class="op">&lt;-</span> <span class="va">inset_gimpo_daemyung_gg</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/inset_element.html">inset_element</a></span><span class="op">(</span><span class="va">inset_gimpo_gg</span>, <span class="fl">0.6</span>, <span class="fl">0.6</span>, <span class="fl">1</span>, <span class="fl">1</span>, align_to <span class="op">=</span> <span class="st">'full'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'김포시 대명항 및 인근 1 KM지역'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">daemyung_port_inset_map</span></span>
<span></span>
<span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/create.html">dir_create</a></span><span class="op">(</span><span class="st">"images/항구_통계/"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_png.html">agg_png</a></span><span class="op">(</span><span class="st">"images/항구_통계/2_김포_대명항_최종.png"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">daemyung_port_inset_map</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/02_%EA%B9%80%ED%8F%AC_%EB%8C%80%EB%AA%85%ED%95%AD_%EC%B5%9C%EC%A2%85.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27"><img src="images/gg/02_%EA%B9%80%ED%8F%AC_%EB%8C%80%EB%AA%85%ED%95%AD_%EC%B5%9C%EC%A2%85.png" class="img-fluid"></a></p>
</div>
</div>
</div>
</section><section id="화성시-궁평항" class="level2" data-number="5.2"><h2 data-number="5.2">
<span class="header-section-number">5.2</span> 화성시 궁평항</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">화성시 위치</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">화성시 궁평항</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">궁평항 인근 1 KM</a></li>
</ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com/">gt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jthomasmock/gtExtras">gtExtras</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">katec_crs</span> <span class="op">&lt;-</span> <span class="st">"+proj=tmerc +lat_0=38 +lon_0=128 +k=0.9999 +x_0=400000 +y_0=600000 +ellps=bessel +units=m +no_defs"</span></span>
<span></span>
<span><span class="va">gg_admin_map</span> <span class="op">&lt;-</span> </span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">"data/(공통)셀블록도로행정동/행정동경계/행정동경계_경기도/tbshp_admi_gg_20210614.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_admin_map</span> <span class="op">&lt;-</span> <span class="va">gg_admin_map</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_set_crs</a></span><span class="op">(</span><span class="va">katec_crs</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_city_map</span> <span class="op">&lt;-</span> <span class="va">gg_admin_map</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">cty_nm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html">st_union</a></span><span class="op">(</span><span class="va">geometry</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>cty_target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">cty_nm</span>, <span class="st">"화성"</span><span class="op">)</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_hw_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gg_city_map</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">cty_target</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gray90"</span>, <span class="st">"skyblue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">gg_city_map</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">cty_target</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">cty_nm</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>        min.segment.length <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">4</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>      family <span class="op">=</span> <span class="st">"MaruBrui"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_hw_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_jpeg.html">agg_jpeg</a></span><span class="op">(</span><span class="st">"images/항구_통계/02_경기도_화성시.jpg"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">gg_hw_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/02_%EA%B2%BD%EA%B8%B0%EB%8F%84_%ED%99%94%EC%84%B1%EC%8B%9C.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-28"><img src="images/gg/02_%EA%B2%BD%EA%B8%B0%EB%8F%84_%ED%99%94%EC%84%B1%EC%8B%9C.jpg" class="img-fluid"></a></p>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 김포시 </span></span>
<span><span class="va">hw_adm_sf</span> <span class="op">&lt;-</span> <span class="va">gg_admin_map</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CTY_NM</span> <span class="op">==</span> <span class="st">"화성시"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 항구</span></span>
<span><span class="va">port_tbl</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data/국가어항.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"경기어항"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">port_sf</span> <span class="op">&lt;-</span> <span class="va">port_tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># WGS84</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># KATEC</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">katec_crs</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_hw_port_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">hw_adm_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gray90"</span>, <span class="st">"skyblue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">hw_adm_sf</span>,</span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">ADMI_NM</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>      min.segment.length <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">4</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>, family <span class="op">=</span> <span class="st">"MaruBrui"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"궁평항"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"red"</span>, alpha<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"궁평항"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">어항명</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>      min.segment.length <span class="op">=</span> <span class="fl">3</span>, size <span class="op">=</span> <span class="fl">4</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>, family <span class="op">=</span> <span class="st">"MaruBrui"</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>   </span>
<span></span>
<span><span class="va">gg_hw_port_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_jpeg.html">agg_jpeg</a></span><span class="op">(</span><span class="st">"images/항구_통계/02_경기도_화성시_궁평항.jpg"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">gg_hw_port_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/02_%EA%B2%BD%EA%B8%B0%EB%8F%84_%ED%99%94%EC%84%B1%EC%8B%9C_%EA%B6%81%ED%8F%89%ED%95%AD.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-29"><img src="images/gg/02_%EA%B2%BD%EA%B8%B0%EB%8F%84_%ED%99%94%EC%84%B1%EC%8B%9C_%EA%B6%81%ED%8F%89%ED%95%AD.jpg" class="img-fluid"></a></p>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># cell_sf &lt;- st_read("data/(공통)셀블록도로행정동/셀(중심점)/cell_gg_admi2_20210616.shp")</span></span>
<span></span>
<span><span class="va">hw_cty_cell_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">cell_sf</span>, <span class="va">katec_crs</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CTY_CD</span> <span class="op">==</span> <span class="va">gg_admin_map</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CTY_NM</span> <span class="op">==</span> <span class="st">"화성시"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">CTY_CD</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 항구 인근 1 KM</span></span>
<span><span class="va">hw_ports_cell_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_join.html">st_join</a></span><span class="op">(</span><span class="va">hw_cty_cell_sf</span>,</span>
<span>                               <span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"궁평항"</span><span class="op">)</span>, </span>
<span>                         maxdist <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>                         join <span class="op">=</span> <span class="fu">nngeo</span><span class="fu">::</span><span class="va"><a href="https://michaeldorman.github.io/nngeo/reference/st_nn.html">st_nn</a></span>, left <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hw_ports_bbox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">hw_ports_cell_sf</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### 1. 화성시 Inset</span></span>
<span></span>
<span><span class="va">inset_hw_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">## 1. 행정동 ---------</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">hw_adm_sf</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">hw_adm_sf</span>,</span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">ADMI_NM</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>      min.segment.length <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">2</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>, family <span class="op">=</span> <span class="st">"MaruBrui"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">## 2. 항구 ---------  </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"궁평항"</span><span class="op">)</span>, </span>
<span>          size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"blue"</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">hw_ports_bbox</span><span class="op">[</span><span class="st">'xmin'</span><span class="op">]</span><span class="op">-</span><span class="fl">1000</span>, </span>
<span>                xmax <span class="op">=</span> <span class="va">hw_ports_bbox</span><span class="op">[</span><span class="st">'xmax'</span><span class="op">]</span><span class="op">+</span><span class="fl">1000</span>, </span>
<span>                ymin <span class="op">=</span> <span class="va">hw_ports_bbox</span><span class="op">[</span><span class="st">'ymin'</span><span class="op">]</span><span class="op">-</span><span class="fl">1000</span>, </span>
<span>                ymax <span class="op">=</span> <span class="va">hw_ports_bbox</span><span class="op">[</span><span class="st">'ymax'</span><span class="op">]</span><span class="op">+</span><span class="fl">1000</span><span class="op">)</span>, fill<span class="op">=</span><span class="cn">NA</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">inset_hw_gg</span></span>
<span></span>
<span><span class="co">### 2. 화성시 궁평항</span></span>
<span></span>
<span><span class="va">inset_hw_goongpyung_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">hw_adm_sf</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span> <span class="va">hw_ports_cell_sf</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"궁평항"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span>, </span>
<span>          color <span class="op">=</span> <span class="st">"blue"</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"궁평항"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">어항명</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>      min.segment.length <span class="op">=</span> <span class="fl">3</span>, size <span class="op">=</span> <span class="fl">4</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>, family <span class="op">=</span> <span class="st">"MaruBrui"</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">hw_ports_bbox</span><span class="op">[</span><span class="st">'xmin'</span><span class="op">]</span><span class="op">-</span><span class="fl">1000</span>, </span>
<span>                      <span class="va">hw_ports_bbox</span><span class="op">[</span><span class="st">'xmax'</span><span class="op">]</span><span class="op">+</span><span class="fl">1000</span><span class="op">)</span>,</span>
<span>             ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">hw_ports_bbox</span><span class="op">[</span><span class="st">'ymin'</span><span class="op">]</span><span class="op">-</span><span class="fl">1000</span>, </span>
<span>                      <span class="va">hw_ports_bbox</span><span class="op">[</span><span class="st">'ymax'</span><span class="op">]</span><span class="op">+</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggspatial</span><span class="fu">::</span><span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_scale.html">annotation_scale</a></span><span class="op">(</span>location <span class="op">=</span> <span class="st">"br"</span>, width_hint <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                               height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 3. 화성시 + 궁평항 지도 -------------------------------  </span></span>
<span><span class="va">goongpyung_port_inset_map</span> <span class="op">&lt;-</span> <span class="va">inset_hw_goongpyung_gg</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/inset_element.html">inset_element</a></span><span class="op">(</span><span class="va">inset_hw_gg</span>, <span class="fl">0.6</span>, <span class="fl">0.6</span>, <span class="fl">1</span>, <span class="fl">1</span>, align_to <span class="op">=</span> <span class="st">'full'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'화성시 궁평항 및 인근 1 KM지역'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">goongpyung_port_inset_map</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_png.html">agg_png</a></span><span class="op">(</span><span class="st">"images/항구_통계/2_화성_궁평항_최종.png"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">goongpyung_port_inset_map</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/02_%ED%99%94%EC%84%B1_%EA%B6%81%ED%8F%89%ED%95%AD_%EC%B5%9C%EC%A2%85.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30"><img src="images/gg/02_%ED%99%94%EC%84%B1_%EA%B6%81%ED%8F%89%ED%95%AD_%EC%B5%9C%EC%A2%85.png" class="img-fluid"></a></p>
</div>
</div>
</div>
</section><section id="안산시-탄도항" class="level2" data-number="5.3"><h2 data-number="5.3">
<span class="header-section-number">5.3</span> 안산시 탄도항</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">안산시 위치</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">안산시 탄도항</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">안산시 탄도항 인근 1 KM</a></li>
</ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com/">gt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jthomasmock/gtExtras">gtExtras</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">katec_crs</span> <span class="op">&lt;-</span> <span class="st">"+proj=tmerc +lat_0=38 +lon_0=128 +k=0.9999 +x_0=400000 +y_0=600000 +ellps=bessel +units=m +no_defs"</span></span>
<span></span>
<span><span class="va">gg_admin_map</span> <span class="op">&lt;-</span> </span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">"data/(공통)셀블록도로행정동/행정동경계/행정동경계_경기도/tbshp_admi_gg_20210614.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_admin_map</span> <span class="op">&lt;-</span> <span class="va">gg_admin_map</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_set_crs</a></span><span class="op">(</span><span class="va">katec_crs</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_city_map</span> <span class="op">&lt;-</span> <span class="va">gg_admin_map</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">cty_nm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html">st_union</a></span><span class="op">(</span><span class="va">geometry</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>cty_target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">cty_nm</span>, <span class="st">"안산"</span><span class="op">)</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_ansan_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gg_city_map</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">cty_target</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gray90"</span>, <span class="st">"skyblue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">gg_city_map</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">cty_target</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">cty_nm</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>        min.segment.length <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">4</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>      family <span class="op">=</span> <span class="st">"MaruBrui"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_ansan_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_jpeg.html">agg_jpeg</a></span><span class="op">(</span><span class="st">"images/항구_통계/02_경기도_안산시.jpg"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">gg_ansan_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/02_%EA%B2%BD%EA%B8%B0%EB%8F%84_%EC%95%88%EC%82%B0%EC%8B%9C.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-31"><img src="images/gg/02_%EA%B2%BD%EA%B8%B0%EB%8F%84_%EC%95%88%EC%82%B0%EC%8B%9C.jpg" class="img-fluid"></a></p>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 안산시</span></span>
<span><span class="va">ansan_adm_sf</span> <span class="op">&lt;-</span> <span class="va">gg_admin_map</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CTY_NM</span> <span class="op">==</span> <span class="st">"안산시"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 항구</span></span>
<span><span class="va">port_tbl</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data/국가어항.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"경기어항"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">port_sf</span> <span class="op">&lt;-</span> <span class="va">port_tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># WGS84</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># KATEC</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">katec_crs</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_ansan_port_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ansan_adm_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gray90"</span>, <span class="st">"skyblue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">ansan_adm_sf</span>,</span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">ADMI_NM</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>      min.segment.length <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">4</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>, family <span class="op">=</span> <span class="st">"MaruBrui"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"탄도항"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"red"</span>, alpha<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"탄도항"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">어항명</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>      min.segment.length <span class="op">=</span> <span class="fl">3</span>, size <span class="op">=</span> <span class="fl">4</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>, family <span class="op">=</span> <span class="st">"MaruBrui"</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>   </span>
<span></span>
<span><span class="va">gg_ansan_port_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_jpeg.html">agg_jpeg</a></span><span class="op">(</span><span class="st">"images/항구_통계/02_경기도_안산시_탄도항.jpg"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">gg_ansan_port_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/02_%EA%B2%BD%EA%B8%B0%EB%8F%84_%EC%95%88%EC%82%B0%EC%8B%9C_%ED%83%84%EB%8F%84%ED%95%AD.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-32"><img src="images/gg/02_%EA%B2%BD%EA%B8%B0%EB%8F%84_%EC%95%88%EC%82%B0%EC%8B%9C_%ED%83%84%EB%8F%84%ED%95%AD.jpg" class="img-fluid"></a></p>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># cell_sf &lt;- st_read("data/(공통)셀블록도로행정동/셀(중심점)/cell_gg_admi2_20210616.shp")</span></span>
<span></span>
<span><span class="va">ansan_cty_cell_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">cell_sf</span>, <span class="va">katec_crs</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CTY_CD</span> <span class="op">==</span> <span class="va">gg_admin_map</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CTY_NM</span> <span class="op">==</span> <span class="st">"안산시"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">CTY_CD</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 항구 인근 1 KM</span></span>
<span><span class="va">ansan_ports_cell_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_join.html">st_join</a></span><span class="op">(</span><span class="va">ansan_cty_cell_sf</span>,</span>
<span>                               <span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"탄도항"</span><span class="op">)</span>, </span>
<span>                         maxdist <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>                         join <span class="op">=</span> <span class="fu">nngeo</span><span class="fu">::</span><span class="va"><a href="https://michaeldorman.github.io/nngeo/reference/st_nn.html">st_nn</a></span>, left <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ansan_ports_bbox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">ansan_ports_cell_sf</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### 1. 안산시 Inset</span></span>
<span></span>
<span><span class="va">inset_ansan_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">## 1. 행정동 ---------</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ansan_adm_sf</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">ansan_adm_sf</span>,</span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">ADMI_NM</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>      min.segment.length <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">2</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>, family <span class="op">=</span> <span class="st">"MaruBrui"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">## 2. 항구 ---------  </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"탄도항"</span><span class="op">)</span>, </span>
<span>          size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"blue"</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">ansan_ports_bbox</span><span class="op">[</span><span class="st">'xmin'</span><span class="op">]</span><span class="op">-</span><span class="fl">1000</span>, </span>
<span>                xmax <span class="op">=</span> <span class="va">ansan_ports_bbox</span><span class="op">[</span><span class="st">'xmax'</span><span class="op">]</span><span class="op">+</span><span class="fl">1000</span>, </span>
<span>                ymin <span class="op">=</span> <span class="va">ansan_ports_bbox</span><span class="op">[</span><span class="st">'ymin'</span><span class="op">]</span><span class="op">-</span><span class="fl">1000</span>, </span>
<span>                ymax <span class="op">=</span> <span class="va">ansan_ports_bbox</span><span class="op">[</span><span class="st">'ymax'</span><span class="op">]</span><span class="op">+</span><span class="fl">1000</span><span class="op">)</span>, fill<span class="op">=</span><span class="cn">NA</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      axis.ticks.length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"pt"</span><span class="op">)</span>,</span>
<span>      axis.title<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>      panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">inset_ansan_gg</span></span>
<span></span>
<span><span class="co">### 2. 안산시 탄도항</span></span>
<span></span>
<span><span class="va">inset_ansan_tando_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ansan_adm_sf</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span> <span class="va">ansan_ports_cell_sf</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"탄도항"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span>, </span>
<span>          color <span class="op">=</span> <span class="st">"blue"</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"탄도항"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">어항명</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>      min.segment.length <span class="op">=</span> <span class="fl">3</span>, size <span class="op">=</span> <span class="fl">4</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>, family <span class="op">=</span> <span class="st">"MaruBrui"</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ansan_ports_bbox</span><span class="op">[</span><span class="st">'xmin'</span><span class="op">]</span><span class="op">-</span><span class="fl">1000</span>, </span>
<span>                      <span class="va">ansan_ports_bbox</span><span class="op">[</span><span class="st">'xmax'</span><span class="op">]</span><span class="op">+</span><span class="fl">1000</span><span class="op">)</span>,</span>
<span>             ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ansan_ports_bbox</span><span class="op">[</span><span class="st">'ymin'</span><span class="op">]</span><span class="op">-</span><span class="fl">1000</span>, </span>
<span>                      <span class="va">ansan_ports_bbox</span><span class="op">[</span><span class="st">'ymax'</span><span class="op">]</span><span class="op">+</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggspatial</span><span class="fu">::</span><span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_scale.html">annotation_scale</a></span><span class="op">(</span>location <span class="op">=</span> <span class="st">"br"</span>, width_hint <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                               height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 3. 안산시 + 탄도항 지도 -------------------------------  </span></span>
<span><span class="va">tando_port_inset_map</span> <span class="op">&lt;-</span> <span class="va">inset_ansan_tando_gg</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/inset_element.html">inset_element</a></span><span class="op">(</span><span class="va">inset_ansan_gg</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">1</span>, align_to <span class="op">=</span> <span class="st">'full'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'안산시 탄도항 및 인근 1 KM지역'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tando_port_inset_map</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_png.html">agg_png</a></span><span class="op">(</span><span class="st">"images/항구_통계/3_안산_탄도항_최종.png"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">tando_port_inset_map</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/02_%EC%95%88%EC%82%B0_%ED%83%84%EB%8F%84%ED%95%AD_%EC%B5%9C%EC%A2%85.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33"><img src="images/gg/02_%EC%95%88%EC%82%B0_%ED%83%84%EB%8F%84%ED%95%AD_%EC%B5%9C%EC%A2%85.png" class="img-fluid"></a></p>
</div>
</div>
</div>
</section></section><section id="대명항-유동인구-결재금액" class="level1" data-number="6"><h1 data-number="6">
<span class="header-section-number">6</span> 대명항 유동인구, 결재금액</h1>
<section id="김포시-대명항-위치" class="level2" data-number="6.1"><h2 data-number="6.1">
<span class="header-section-number">6.1</span> 김포시 대명항 위치</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">김포시 위치</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">김포시 대명항</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false">대명항 인근 1 KM</a></li>
</ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com/">gt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jthomasmock/gtExtras">gtExtras</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">katec_crs</span> <span class="op">&lt;-</span> <span class="st">"+proj=tmerc +lat_0=38 +lon_0=128 +k=0.9999 +x_0=400000 +y_0=600000 +ellps=bessel +units=m +no_defs"</span></span>
<span></span>
<span><span class="va">gg_admin_map</span> <span class="op">&lt;-</span> </span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">"data/(공통)셀블록도로행정동/행정동경계/행정동경계_경기도/tbshp_admi_gg_20210614.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_admin_map</span> <span class="op">&lt;-</span> <span class="va">gg_admin_map</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_set_crs</a></span><span class="op">(</span><span class="va">katec_crs</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_city_map</span> <span class="op">&lt;-</span> <span class="va">gg_admin_map</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">cty_nm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html">st_union</a></span><span class="op">(</span><span class="va">geometry</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>cty_target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">cty_nm</span>, <span class="st">"김포"</span><span class="op">)</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_gimpo_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gg_city_map</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">cty_target</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gray90"</span>, <span class="st">"skyblue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">gg_city_map</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">cty_target</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">cty_nm</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>        min.segment.length <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">4</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>      family <span class="op">=</span> <span class="st">"MaruBrui"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_gimpo_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_jpeg.html">agg_jpeg</a></span><span class="op">(</span><span class="st">"images/항구_통계/02_경기도_김포시.jpg"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">gg_gimpo_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/02_%EA%B2%BD%EA%B8%B0%EB%8F%84_%EA%B9%80%ED%8F%AC%EC%8B%9C.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-34"><img src="images/gg/02_%EA%B2%BD%EA%B8%B0%EB%8F%84_%EA%B9%80%ED%8F%AC%EC%8B%9C.jpg" class="img-fluid"></a></p>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 김포시 </span></span>
<span><span class="va">gimpo_adm_sf</span> <span class="op">&lt;-</span> <span class="va">gg_admin_map</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CTY_NM</span> <span class="op">==</span> <span class="st">"김포시"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 항구</span></span>
<span><span class="va">port_tbl</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data/국가어항.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"경기어항"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">port_sf</span> <span class="op">&lt;-</span> <span class="va">port_tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># WGS84</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># KATEC</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">katec_crs</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_gimpo_port_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gimpo_adm_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gray90"</span>, <span class="st">"skyblue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">gimpo_adm_sf</span>,</span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">ADMI_NM</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>      min.segment.length <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">4</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>, family <span class="op">=</span> <span class="st">"MaruBrui"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"대명항"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"red"</span>, alpha<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"대명항"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">어항명</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>      min.segment.length <span class="op">=</span> <span class="fl">3</span>, size <span class="op">=</span> <span class="fl">4</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>, family <span class="op">=</span> <span class="st">"MaruBrui"</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>    </span>
<span></span>
<span><span class="va">gg_gimpo_port_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_jpeg.html">agg_jpeg</a></span><span class="op">(</span><span class="st">"images/항구_통계/02_경기도_김포시_대명항.jpg"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">gg_gimpo_port_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/02_%EA%B2%BD%EA%B8%B0%EB%8F%84_%EA%B9%80%ED%8F%AC%EC%8B%9C_%EB%8C%80%EB%AA%85%ED%95%AD.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-35"><img src="images/gg/02_%EA%B2%BD%EA%B8%B0%EB%8F%84_%EA%B9%80%ED%8F%AC%EC%8B%9C_%EB%8C%80%EB%AA%85%ED%95%AD.jpg" class="img-fluid"></a></p>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">cell_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">"data/(공통)셀블록도로행정동/셀(중심점)/cell_gg_admi2_20210616.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gimpo_cty_cell_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">cell_sf</span>, <span class="va">katec_crs</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CTY_CD</span> <span class="op">==</span> <span class="va">gg_admin_map</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CTY_NM</span> <span class="op">==</span> <span class="st">"김포시"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">CTY_CD</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 항구 인근 1 KM</span></span>
<span><span class="va">gimpo_ports_cell_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_join.html">st_join</a></span><span class="op">(</span><span class="va">gimpo_cty_cell_sf</span>,</span>
<span>                               <span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"대명항"</span><span class="op">)</span>, </span>
<span>                         maxdist <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>                         join <span class="op">=</span> <span class="fu">nngeo</span><span class="fu">::</span><span class="va"><a href="https://michaeldorman.github.io/nngeo/reference/st_nn.html">st_nn</a></span>, left <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gimpo_ports_cell_sf</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">write_rds</a></span><span class="op">(</span><span class="st">"data/gimpo_ports_cell_sf.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gimpo_ports_bbox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">gimpo_ports_cell_sf</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### 1. 김포시 Inset</span></span>
<span></span>
<span><span class="va">inset_gimpo_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">## 1. 행정동 ---------</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gimpo_adm_sf</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">gimpo_adm_sf</span>,</span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">ADMI_NM</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>      min.segment.length <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">2</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>, family <span class="op">=</span> <span class="st">"MaruBrui"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">## 2. 항구 ---------  </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"대명항"</span><span class="op">)</span>, </span>
<span>          size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"blue"</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">gimpo_ports_bbox</span><span class="op">[</span><span class="st">'xmin'</span><span class="op">]</span><span class="op">-</span><span class="fl">1000</span>, </span>
<span>                xmax <span class="op">=</span> <span class="va">gimpo_ports_bbox</span><span class="op">[</span><span class="st">'xmax'</span><span class="op">]</span><span class="op">+</span><span class="fl">1000</span>, </span>
<span>                ymin <span class="op">=</span> <span class="va">gimpo_ports_bbox</span><span class="op">[</span><span class="st">'ymin'</span><span class="op">]</span><span class="op">-</span><span class="fl">1000</span>, </span>
<span>                ymax <span class="op">=</span> <span class="va">gimpo_ports_bbox</span><span class="op">[</span><span class="st">'ymax'</span><span class="op">]</span><span class="op">+</span><span class="fl">1000</span><span class="op">)</span>, fill<span class="op">=</span><span class="cn">NA</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">inset_gimpo_gg</span></span>
<span></span>
<span><span class="co">### 2. 김포시 대명항</span></span>
<span></span>
<span><span class="va">inset_gimpo_daemyung_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gimpo_adm_sf</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span> <span class="va">gimpo_ports_cell_sf</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"대명항"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span>, </span>
<span>          color <span class="op">=</span> <span class="st">"blue"</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">port_sf</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">어항명</span> <span class="op">==</span> <span class="st">"대명항"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">어항명</span>, geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, </span>
<span>      min.segment.length <span class="op">=</span> <span class="fl">3</span>, size <span class="op">=</span> <span class="fl">4</span>, max.overlaps <span class="op">=</span> <span class="cn">Inf</span>, family <span class="op">=</span> <span class="st">"MaruBrui"</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBuri"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">gimpo_ports_bbox</span><span class="op">[</span><span class="st">'xmin'</span><span class="op">]</span><span class="op">-</span><span class="fl">1000</span>, </span>
<span>                      <span class="va">gimpo_ports_bbox</span><span class="op">[</span><span class="st">'xmax'</span><span class="op">]</span><span class="op">+</span><span class="fl">1000</span><span class="op">)</span>,</span>
<span>             ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">gimpo_ports_bbox</span><span class="op">[</span><span class="st">'ymin'</span><span class="op">]</span><span class="op">-</span><span class="fl">1000</span>, </span>
<span>                      <span class="va">gimpo_ports_bbox</span><span class="op">[</span><span class="st">'ymax'</span><span class="op">]</span><span class="op">+</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggspatial</span><span class="fu">::</span><span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_scale.html">annotation_scale</a></span><span class="op">(</span>location <span class="op">=</span> <span class="st">"br"</span>, width_hint <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                               height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 3. 김포시 + 대명항 지도 -------------------------------  </span></span>
<span><span class="va">daemyung_port_inset_map</span> <span class="op">&lt;-</span> <span class="va">inset_gimpo_daemyung_gg</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/inset_element.html">inset_element</a></span><span class="op">(</span><span class="va">inset_gimpo_gg</span>, <span class="fl">0.6</span>, <span class="fl">0.6</span>, <span class="fl">1</span>, <span class="fl">1</span>, align_to <span class="op">=</span> <span class="st">'full'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'김포시 대명항 및 인근 1 KM지역'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">daemyung_port_inset_map</span></span>
<span></span>
<span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/create.html">dir_create</a></span><span class="op">(</span><span class="st">"images/항구_통계/"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_png.html">agg_png</a></span><span class="op">(</span><span class="st">"images/항구_통계/2_김포_대명항_최종.png"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">daemyung_port_inset_map</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/02_%EA%B9%80%ED%8F%AC_%EB%8C%80%EB%AA%85%ED%95%AD_%EC%B5%9C%EC%A2%85.png" class="lightbox" data-gallery="quarto-lightbox-gallery-36"><img src="images/gg/02_%EA%B9%80%ED%8F%AC_%EB%8C%80%EB%AA%85%ED%95%AD_%EC%B5%9C%EC%A2%85.png" class="img-fluid"></a></p>
</div>
</div>
</div>
</section><section id="유동인구" class="level2" data-number="6.2"><h2 data-number="6.2">
<span class="header-section-number">6.2</span> 유동인구</h2>
<section id="kt-데이터" class="level3" data-number="6.2.1"><h3 data-number="6.2.1">
<span class="header-section-number">6.2.1</span> KT 데이터</h3>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 1. 대상파일</span></span>
<span><span class="va">kt_cell_files_raw</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html">dir_ls</a></span><span class="op">(</span><span class="st">"data/KT유동인구데이터/셀단위/sex_age/"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kt_cell_files_raw</span> <span class="op">&lt;-</span> <span class="va">kt_cell_files_raw</span><span class="op">[</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">kt_cell_files_raw</span>, <span class="st">"sex_age_\\d{6}"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## 2. 함수</span></span>
<span></span>
<span><span class="va">point_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">"data/sgg_cell_point/광명시.geojson"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">get_sex_age</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">yearmon</span><span class="op">=</span><span class="st">"data/KT유동인구데이터/셀단위/sex_age/sex_age_201801.csv"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\n ------------------\n"</span>, <span class="va">yearmon</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">sex_age_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="va">yearmon</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">km_sex_age</span> <span class="op">&lt;-</span> <span class="va">sex_age_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="co">## 광명시만 추출</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">cell_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">point_map</span><span class="op">$</span><span class="va">cell_id</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co">## 자료구조 변환</span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">M00_09</span><span class="op">:</span><span class="va">F60_up</span>, names_to <span class="op">=</span> <span class="st">"name"</span>, values_to <span class="op">=</span> <span class="st">"인구수"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>성별 <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">name</span>, <span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>           연령대 <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">name</span>, <span class="fl">2</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co">## 자료형 변환</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>연령대 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">연령대</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"00_09"</span>, <span class="st">"10_19"</span>, <span class="st">"20_29"</span>, <span class="st">"30_39"</span>, <span class="st">"40_49"</span>, <span class="st">"50_59"</span>, <span class="st">"60_up"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           성별 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">성별</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M"</span>, <span class="st">"F"</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"남성"</span>, <span class="st">"여성"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">name</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">km_sex_age</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">get_sex_age</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 3. 김포시 데이터</span></span>
<span></span>
<span><span class="va">kt_cell_files</span> <span class="op">&lt;-</span> <span class="va">kt_cell_files_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html">enframe</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co">## 2018~2022년만 추출</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>년월 <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">name</span>, <span class="st">"\\d+"</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">년월</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2017"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co">## 2018~2022년만 추출</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>년월 <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">name</span>, <span class="st">"\\d+"</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>년월 <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ym</a></span><span class="op">(</span><span class="va">년월</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">age_sex_yearmon</span> <span class="op">&lt;-</span> <span class="va">kt_cell_files</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">get_sex_age</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">age_sex_yearmon</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">write_rds</a></span><span class="op">(</span><span class="st">"data/gimpo_age_sex_2018_2022.rds"</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
</section><section id="대명항-1-km-유동인구" class="level3" data-number="6.2.2"><h3 data-number="6.2.2">
<span class="header-section-number">6.2.2</span> 대명항 1 KM 유동인구</h3>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gimpo_ports_cell_sf</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">read_rds</a></span><span class="op">(</span><span class="st">"data/gimpo_ports_cell_sf.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">port_cell_id</span> <span class="op">&lt;-</span> <span class="va">gimpo_ports_cell_sf</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell_id</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">age_sex_yearmon</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">read_rds</a></span><span class="op">(</span><span class="st">"data/gimpo_age_sex_2018_2022.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">age_sex_yearmon_tbl</span> <span class="op">&lt;-</span> <span class="va">age_sex_yearmon</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">년월</span>, <span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">port_age_sex_tbl</span> <span class="op">&lt;-</span> <span class="va">age_sex_yearmon_tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">cell_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">port_cell_id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">port_age_sex_tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">write_rds</a></span><span class="op">(</span><span class="st">"data/port_age_sex_tbl.rds"</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
</section></section><section id="유동인구-분석" class="level2" data-number="6.3"><h2 data-number="6.3">
<span class="header-section-number">6.3</span> 유동인구 분석</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">성별</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">연령별</a></li>
</ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">extrafont</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/extrafont/man/loadfonts.html">loadfonts</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">port_age_sex_tbl</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">read_rds</a></span><span class="op">(</span><span class="st">"data/port_age_sex_tbl.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">port_kt_sex_gg</span> <span class="op">&lt;-</span> <span class="va">port_age_sex_tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">년월</span>, <span class="va">성별</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>유동인구 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">인구수</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">년월</span>, y <span class="op">=</span> <span class="va">유동인구</span>, color <span class="op">=</span> <span class="va">성별</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBrui"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"김포시 대명항 인근 1 KM 유동인구"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="st">"성별, 2018년 1월 ~ 2022년 12월"</span>,</span>
<span>         caption <span class="op">=</span> <span class="st">"자료출처: 경기도 분석센터 KT 유동인구"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">""</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"유동인구 (만명)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"black"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">port_kt_sex_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_jpeg.html">agg_jpeg</a></span><span class="op">(</span><span class="st">"images/항구_통계/김포_대명항_유동인구_성별.jpg"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">port_kt_sex_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/%EA%B9%80%ED%8F%AC_%EB%8C%80%EB%AA%85%ED%95%AD_%EC%9C%A0%EB%8F%99%EC%9D%B8%EA%B5%AC_%EC%84%B1%EB%B3%84.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-37"><img src="images/gg/%EA%B9%80%ED%8F%AC_%EB%8C%80%EB%AA%85%ED%95%AD_%EC%9C%A0%EB%8F%99%EC%9D%B8%EA%B5%AC_%EC%84%B1%EB%B3%84.jpg" class="img-fluid"></a></p>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">port_kt_age_gg</span> <span class="op">&lt;-</span> <span class="va">port_age_sex_tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">년월</span>,<span class="va">연령대</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>유동인구 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">인구수</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">년월</span>, y <span class="op">=</span> <span class="va">유동인구</span>, color <span class="op">=</span> <span class="va">연령대</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBrui"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"김포시 대명항 인근 1 KM 유동인구"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="st">"연령별, 2018년 1월 ~ 2022년 12월"</span>,</span>
<span>         caption <span class="op">=</span> <span class="st">"자료출처: 경기도 분석센터 KT 유동인구"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">""</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"유동인구 (만명)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>  </span>
<span></span>
<span><span class="va">port_kt_age_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_jpeg.html">agg_jpeg</a></span><span class="op">(</span><span class="st">"images/항구_통계/김포_대명항_유동인구_연령별.jpg"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">port_kt_age_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/%EA%B9%80%ED%8F%AC_%EB%8C%80%EB%AA%85%ED%95%AD_%EC%9C%A0%EB%8F%99%EC%9D%B8%EA%B5%AC_%EC%97%B0%EB%A0%B9%EB%B3%84.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-38"><img src="images/gg/%EA%B9%80%ED%8F%AC_%EB%8C%80%EB%AA%85%ED%95%AD_%EC%9C%A0%EB%8F%99%EC%9D%B8%EA%B5%AC_%EC%97%B0%EB%A0%B9%EB%B3%84.jpg" class="img-fluid"></a></p>
</div>
</div>
</div>
</section><section id="매출금액" class="level2" data-number="6.4"><h2 data-number="6.4">
<span class="header-section-number">6.4</span> 매출금액</h2>
<section id="데이터" class="level3" data-number="6.4.1"><h3 data-number="6.4.1">
<span class="header-section-number">6.4.1</span> 데이터</h3>
<section id="bc-카드" class="level4" data-number="6.4.1.1"><h4 data-number="6.4.1.1">
<span class="header-section-number">6.4.1.1</span> BC 카드</h4>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 1. 대상파일</span></span>
<span></span>
<span><span class="va">amt_files</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html">dir_ls</a></span><span class="op">(</span><span class="st">"data/BC카드데이터/TBSH_GYEONGGI_SELNG/"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">amt_raw</span> <span class="op">&lt;-</span> <span class="va">amt_files</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html">enframe</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">value</span>, <span class="va">read_delim</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">name</span>, <span class="st">"\\d+\\.txt$"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">amt_tbl</span> <span class="op">&lt;-</span> <span class="va">amt_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ta_ym <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ym</a></span><span class="op">(</span><span class="va">ta_ym</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
</section><section id="셀_블록" class="level4" data-number="6.4.1.2"><h4 data-number="6.4.1.2">
<span class="header-section-number">6.4.1.2</span> 셀_블록</h4>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cell_blk_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span><span class="st">"data/(공통)셀블록도로행정동/셀_블록_행정동/kt_cell_v6_20210528.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">port_cell_blk_raw</span> <span class="op">&lt;-</span> <span class="va">cell_blk_raw</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>cell_id <span class="op">=</span> <span class="va">id</span><span class="op">)</span> <span class="op">|&gt;</span>   </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">cell_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">port_cell_id</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">port_cell_blk_cd</span> <span class="op">&lt;-</span> <span class="va">port_cell_blk_raw</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">blk_cd</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
</section><section id="대명항-인근-1-km-2" class="level4" data-number="6.4.1.3"><h4 data-number="6.4.1.3">
<span class="header-section-number">6.4.1.3</span> 대명항 인근 1 KM</h4>
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">port_amt_tbl</span> <span class="op">&lt;-</span> <span class="va">amt_tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">blk_cd</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">port_cell_blk_cd</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
</section></section></section><section id="결재금액-분석" class="level2" data-number="6.5"><h2 data-number="6.5">
<span class="header-section-number">6.5</span> 결재금액 분석</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">연도별</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">음식점별</a></li>
</ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bc_yearmon_gg</span> <span class="op">&lt;-</span> <span class="va">port_amt_tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ta_ym</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>결재건수 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">total_cnt</span><span class="op">)</span><span class="op">/</span> <span class="fl">10</span><span class="op">^</span><span class="fl">4</span>,</span>
<span>            결재금액 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">total_amt</span><span class="op">)</span><span class="op">/</span> <span class="fl">10</span><span class="op">^</span><span class="fl">8</span>,<span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ta_ym</span>, y <span class="op">=</span> <span class="va">결재금액</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBrui"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"김포시 대명항 인근 1 KM 결재금액"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="st">"연령별, 2018년 1월 ~ 2022년 12월"</span>,</span>
<span>         caption <span class="op">=</span> <span class="st">"자료출처: 경기도 분석센터 KT 유동인구"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">""</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"결재금액(억원)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">bc_yearmon_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_jpeg.html">agg_jpeg</a></span><span class="op">(</span><span class="st">"images/항구_통계/김포_대명항_결재금액.jpg"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">bc_yearmon_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<p><a href="images/gg/%EA%B9%80%ED%8F%AC_%EB%8C%80%EB%AA%85%ED%95%AD_%EA%B2%B0%EC%9E%AC%EA%B8%88%EC%95%A1.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-39"><img src="images/gg/%EA%B9%80%ED%8F%AC_%EB%8C%80%EB%AA%85%ED%95%AD_%EA%B2%B0%EC%9E%AC%EA%B8%88%EC%95%A1.jpg" class="img-fluid"></a></p>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<details class="code-fold"><summary>코드</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">code_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span><span class="op">~</span><span class="st">"mer_buz_code"</span>, <span class="op">~</span><span class="st">"업종명"</span>,</span>
<span><span class="fl">8001</span>,   <span class="st">"일반한식"</span>,</span>
<span><span class="fl">8002</span>,   <span class="st">"갈비전문점"</span>,</span>
<span><span class="fl">8003</span>,   <span class="st">"한정식"</span>,</span>
<span><span class="fl">8004</span>,   <span class="st">"일식회집"</span>,</span>
<span><span class="fl">8005</span>,   <span class="st">"중국음식"</span>,</span>
<span><span class="fl">8006</span>,   <span class="st">"서양음식"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">bc_type_yearmon_gg</span> <span class="op">&lt;-</span> <span class="va">port_amt_tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">mer_buz_code</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8001</span>, <span class="fl">8004</span>, <span class="fl">8005</span>, <span class="fl">8006</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">code_table</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ta_ym</span>, <span class="va">업종명</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>결재건수 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">total_cnt</span><span class="op">)</span><span class="op">/</span> <span class="fl">10</span><span class="op">^</span><span class="fl">4</span>,</span>
<span>            결재금액 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">total_amt</span><span class="op">)</span><span class="op">/</span> <span class="fl">10</span><span class="op">^</span><span class="fl">8</span>,<span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ta_ym</span>, y <span class="op">=</span> <span class="va">결재금액</span>, color <span class="op">=</span> <span class="va">업종명</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"MaruBrui"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"김포시 대명항 인근 1 KM 업종별 결재금액"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="st">"연령별, 2018년 1월 ~ 2022년 12월"</span>,</span>
<span>         caption <span class="op">=</span> <span class="st">"자료출처: 경기도 분석센터 KT 유동인구"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">""</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"결재금액(억원)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">bc_type_yearmon_gg</span></span>
<span></span>
<span><span class="fu">ragg</span><span class="fu">::</span><span class="fu"><a href="https://ragg.r-lib.org/reference/agg_jpeg.html">agg_jpeg</a></span><span class="op">(</span><span class="st">"images/항구_통계/김포_대명항_음식점_결재금액.jpg"</span>, </span>
<span>              width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">7</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="va">bc_type_yearmon_gg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span></code></pre></div>
</details>
</div>
<p><a href="images/gg/%EA%B9%80%ED%8F%AC_%EB%8C%80%EB%AA%85%ED%95%AD_%EC%9D%8C%EC%8B%9D%EC%A0%90_%EA%B2%B0%EC%9E%AC%EA%B8%88%EC%95%A1.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-40"><img src="images/gg/%EA%B9%80%ED%8F%AC_%EB%8C%80%EB%AA%85%ED%95%AD_%EC%9D%8C%EC%8B%9D%EC%A0%90_%EA%B2%B0%EC%9E%AC%EA%B8%88%EC%95%A1.jpg" class="img-fluid"></a></p>
</div>
</div>
</div>
<div id="quarto-navigation-envelope" class="hidden">
<p><span class="hidden" data-render-id="quarto-int-sidebar-title">지도제작 대회</span> <span class="hidden" data-render-id="quarto-int-navbar-title">지도제작 대회</span> <span class="hidden" data-render-id="quarto-int-navbar:Home">Home</span> <span class="hidden" data-render-id="quarto-int-navbar:/index.html">/index.html</span> <span class="hidden" data-render-id="quarto-int-navbar:지도 그리기">지도 그리기</span> <span class="hidden" data-render-id="quarto-int-navbar:지도 색칠">지도 색칠</span> <span class="hidden" data-render-id="quarto-int-navbar:/day_01.html">/day_01.html</span> <span class="hidden" data-render-id="quarto-int-navbar:인구수 점(Point)">인구수 점(Point)</span> <span class="hidden" data-render-id="quarto-int-navbar:/day_02.html">/day_02.html</span> <span class="hidden" data-render-id="quarto-int-navbar:스파이크(Spike map)">스파이크(Spike map)</span> <span class="hidden" data-render-id="quarto-int-navbar:/day_03.html">/day_03.html</span> <span class="hidden" data-render-id="quarto-int-navbar:지형도(Topographic map)">지형도(Topographic map)</span> <span class="hidden" data-render-id="quarto-int-navbar:/day_04.html">/day_04.html</span> <span class="hidden" data-render-id="quarto-int-navbar:3D 표고 지도(독도)">3D 표고 지도(독도)</span> <span class="hidden" data-render-id="quarto-int-navbar:/day_05.html">/day_05.html</span> <span class="hidden" data-render-id="quarto-int-navbar:아시아국가 실업율(%)">아시아국가 실업율(%)</span> <span class="hidden" data-render-id="quarto-int-navbar:/day_06.html">/day_06.html</span> <span class="hidden" data-render-id="quarto-int-navbar:인터랙티브 지도(Mapview)">인터랙티브 지도(Mapview)</span> <span class="hidden" data-render-id="quarto-int-navbar:/day_07.html">/day_07.html</span> <span class="hidden" data-render-id="quarto-int-navbar:지오코딩">지오코딩</span> <span class="hidden" data-render-id="quarto-int-navbar:/day_08.html">/day_08.html</span> <span class="hidden" data-render-id="quarto-int-navbar:열지도(heatmap)">열지도(heatmap)</span> <span class="hidden" data-render-id="quarto-int-navbar:/day_heatmap.html">/day_heatmap.html</span> <span class="hidden" data-render-id="quarto-int-navbar:지도 기본기">지도 기본기</span> <span class="hidden" data-render-id="quarto-int-navbar:/spatial_basics.html">/spatial_basics.html</span> <span class="hidden" data-render-id="quarto-int-navbar:대통령 해외순방">대통령 해외순방</span> <span class="hidden" data-render-id="quarto-int-navbar:/tour.html">/tour.html</span> <span class="hidden" data-render-id="quarto-int-navbar:인구비례 선거구">인구비례 선거구</span> <span class="hidden" data-render-id="quarto-int-navbar:/cartogram.html">/cartogram.html</span> <span class="hidden" data-render-id="quarto-int-navbar:GIS 분석&amp;챗GPT">GIS 분석&amp;챗GPT</span> <span class="hidden" data-render-id="quarto-int-navbar:지도(Map)">지도(Map)</span> <span class="hidden" data-render-id="quarto-int-navbar:/spatial_map.html">/spatial_map.html</span> <span class="hidden" data-render-id="quarto-int-navbar:제주도 높이 지도">제주도 높이 지도</span> <span class="hidden" data-render-id="quarto-int-navbar:/jeju_map.html">/jeju_map.html</span> <span class="hidden" data-render-id="quarto-int-navbar:황해">황해</span> <span class="hidden" data-render-id="quarto-int-navbar:/yellow_sea.html">/yellow_sea.html</span> <span class="hidden" data-render-id="quarto-int-navbar:황해2">황해2</span> <span class="hidden" data-render-id="quarto-int-navbar:/yellow_sea2.html">/yellow_sea2.html</span> <span class="hidden" data-render-id="quarto-int-navbar:경기 데이터 분석 센터">경기 데이터 분석 센터</span> <span class="hidden" data-render-id="quarto-int-navbar:/gg_analytics_center.html">/gg_analytics_center.html</span> <span class="hidden" data-render-id="quarto-int-navbar:광명시 학교와 CCTV">광명시 학교와 CCTV</span> <span class="hidden" data-render-id="quarto-int-navbar:/km_school.html">/km_school.html</span> <span class="hidden" data-render-id="quarto-int-navbar:----------------">—————-</span> <span class="hidden" data-render-id="quarto-int-navbar:Code Interpreter">Code Interpreter</span> <span class="hidden" data-render-id="quarto-int-navbar:/km_BitGPT.html">/km_BitGPT.html</span> <span class="hidden" data-render-id="quarto-int-navbar:시각화">시각화</span> <span class="hidden" data-render-id="quarto-int-navbar:한국영화">한국영화</span> <span class="hidden" data-render-id="quarto-int-navbar:/movie.html">/movie.html</span> <span class="hidden" data-render-id="quarto-int-navbar:대쉬보드 Python">대쉬보드 Python</span> <span class="hidden" data-render-id="quarto-int-navbar:/dashboards.html">/dashboards.html</span> <span class="hidden" data-render-id="quarto-int-navbar:대쉬보드 R">대쉬보드 R</span> <span class="hidden" data-render-id="quarto-int-navbar:/dashboards_quakes.qmd">/dashboards_quakes.qmd</span> <span class="hidden" data-render-id="quarto-int-navbar:제21대 국회의원 선거(I)">제21대 국회의원 선거(I)</span> <span class="hidden" data-render-id="quarto-int-navbar:국회의원 선거구">국회의원 선거구</span> <span class="hidden" data-render-id="quarto-int-navbar:/precinct.html">/precinct.html</span> <span class="hidden" data-render-id="quarto-int-navbar:민주당 전략공천 성과">민주당 전략공천 성과</span> <span class="hidden" data-render-id="quarto-int-navbar:/minju_nomination.html">/minju_nomination.html</span> <span class="hidden" data-render-id="quarto-int-navbar:선거구와 정수">선거구와 정수</span> <span class="hidden" data-render-id="quarto-int-navbar:/precinct_history.html">/precinct_history.html</span> <span class="hidden" data-render-id="quarto-int-navbar:변경된 선거구">변경된 선거구</span> <span class="hidden" data-render-id="quarto-int-navbar:/electorate.html">/electorate.html</span> <span class="hidden" data-render-id="quarto-int-navbar:선거구 평균 인구수">선거구 평균 인구수</span> <span class="hidden" data-render-id="quarto-int-navbar:/precinct_district.html">/precinct_district.html</span> <span class="hidden" data-render-id="quarto-int-navbar:인구수 문제 선거구">인구수 문제 선거구</span> <span class="hidden" data-render-id="quarto-int-navbar:/district_issue.html">/district_issue.html</span> <span class="hidden" data-render-id="quarto-int-navbar:광명시(총/대/지)">광명시(총/대/지)</span> <span class="hidden" data-render-id="quarto-int-navbar:/kwangmyung.html">/kwangmyung.html</span> <span class="hidden" data-render-id="quarto-int-navbar:대통령 지지율">대통령 지지율</span> <span class="hidden" data-render-id="quarto-int-navbar:/approval_rate.html">/approval_rate.html</span> <span class="hidden" data-render-id="quarto-int-navbar:민주당은 전국정당(?)">민주당은 전국정당(?)</span> <span class="hidden" data-render-id="quarto-int-navbar:/minju_party.html">/minju_party.html</span> <span class="hidden" data-render-id="quarto-int-navbar:재보궐: 강서구청장">재보궐: 강서구청장</span> <span class="hidden" data-render-id="quarto-int-navbar:/by_election.html">/by_election.html</span> <span class="hidden" data-render-id="quarto-int-navbar:재보궐: 강서구청장(동별)">재보궐: 강서구청장(동별)</span> <span class="hidden" data-render-id="quarto-int-navbar:/by_election_dong.html">/by_election_dong.html</span> <span class="hidden" data-render-id="quarto-int-navbar:서울 재보궐 이후">서울 재보궐 이후</span> <span class="hidden" data-render-id="quarto-int-navbar:/after_by_election.html">/after_by_election.html</span> <span class="hidden" data-render-id="quarto-int-navbar:재보궐: 강서구 위치">재보궐: 강서구 위치</span> <span class="hidden" data-render-id="quarto-int-navbar:/gs_position.html">/gs_position.html</span> <span class="hidden" data-render-id="quarto-int-navbar:리얼미터 PDF">리얼미터 PDF</span> <span class="hidden" data-render-id="quarto-int-navbar:/realmeter_metro.html">/realmeter_metro.html</span> <span class="hidden" data-render-id="quarto-int-navbar:한국갤럽 PDF">한국갤럽 PDF</span> <span class="hidden" data-render-id="quarto-int-navbar:/gallop_metro.html">/gallop_metro.html</span> <span class="hidden" data-render-id="quarto-int-navbar:전국지표조사 PDF">전국지표조사 PDF</span> <span class="hidden" data-render-id="quarto-int-navbar:/nbs_metro.html">/nbs_metro.html</span> <span class="hidden" data-render-id="quarto-int-navbar:제21대 국회의원 선거(II)">제21대 국회의원 선거(II)</span> <span class="hidden" data-render-id="quarto-int-navbar:권역별 의석수 변화">권역별 의석수 변화</span> <span class="hidden" data-render-id="quarto-int-navbar:/legislators.html">/legislators.html</span> <span class="hidden" data-render-id="quarto-int-navbar:예비 후보자">예비 후보자</span> <span class="hidden" data-render-id="quarto-int-navbar:/candidate.html">/candidate.html</span> <span class="hidden" data-render-id="quarto-int-navbar:지역/당협 위원장">지역/당협 위원장</span> <span class="hidden" data-render-id="quarto-int-navbar:/district_chair.html">/district_chair.html</span> <span class="hidden" data-render-id="quarto-int-navbar:수박 당도 선별기">수박 당도 선별기</span> <span class="hidden" data-render-id="quarto-int-navbar:/watermellon.html">/watermellon.html</span> <span class="hidden" data-render-id="quarto-int-navbar:시도별 역대 국회의원">시도별 역대 국회의원</span> <span class="hidden" data-render-id="quarto-int-navbar:/sido_legislator.html">/sido_legislator.html</span> <span class="hidden" data-render-id="quarto-int-navbar:수도권 국힘의원">수도권 국힘의원</span> <span class="hidden" data-render-id="quarto-int-navbar:/metro_people_power.html">/metro_people_power.html</span> <span class="hidden" data-render-id="quarto-int-navbar:당원과 정당 수입지출">당원과 정당 수입지출</span> <span class="hidden" data-render-id="quarto-int-navbar:/party_numbers.html">/party_numbers.html</span> <span class="hidden" data-render-id="quarto-int-navbar:국회의원 초선 당선">국회의원 초선 당선</span> <span class="hidden" data-render-id="quarto-int-navbar:/elected_numbers.html">/elected_numbers.html</span> <span class="hidden" data-render-id="quarto-int-navbar:총선 예측">총선 예측</span> <span class="hidden" data-render-id="quarto-int-navbar:/forecast.html">/forecast.html</span> <span class="hidden" data-render-id="quarto-int-navbar:투개표 API">투개표 API</span> <span class="hidden" data-render-id="quarto-int-navbar:/nec_api.html">/nec_api.html</span> <span class="hidden" data-render-id="quarto-int-navbar:양당과 소선구제">양당과 소선구제</span> <span class="hidden" data-render-id="quarto-int-navbar:/single_member.html">/single_member.html</span> <span class="hidden" data-render-id="quarto-int-navbar:비례 국회의원">비례 국회의원</span> <span class="hidden" data-render-id="quarto-int-navbar:/proportion_member.html">/proportion_member.html</span> <span class="hidden" data-render-id="quarto-int-navbar:최고 관심 격돌">최고 관심 격돌</span> <span class="hidden" data-render-id="quarto-int-navbar:/best_matches.html">/best_matches.html</span></p>
<div class="hidden" data-render-id="footer-left">
<p><a href="https://quarto.org/">Quarto</a> 로 제작</p>
</div>
</div>
<div id="quarto-meta-markdown" class="hidden">
<p><span class="hidden" data-render-id="quarto-metatitle">지도제작 대회</span> <span class="hidden" data-render-id="quarto-twittercardtitle">지도제작 대회</span> <span class="hidden" data-render-id="quarto-ogcardtitle">지도제작 대회</span> <span class="hidden" data-render-id="quarto-metasitename">지도제작 대회</span> <span class="hidden" data-render-id="quarto-twittercarddesc">경기도 데이터 분석센터에서 제공하는 민간데이터(KT 유동인구, BC카드 결재)를 통해 한걸음 더 들어가 보이지 않던 새로운 것을 찾아보자.</span> <span class="hidden" data-render-id="quarto-ogcardddesc">경기도 데이터 분석센터에서 제공하는 민간데이터(KT 유동인구, BC카드 결재)를 통해 한걸음 더 들어가 보이지 않던 새로운 것을 찾아보자.</span></p>
</div>
<!-- -->
<div class="quarto-embedded-source-code">
<div class="sourceCode" id="cb64" data-shortcodes="false"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "지도제작 대회"</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "경기 데이터 분석센터"</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> |</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co">  경기도 데이터 분석센터에서 제공하는 민간데이터(KT 유동인구, BC카드 결재)를 통해 한걸음 더 들어가 보이지 않던 새로운 것을 찾아보자.</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: 이광춘</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co">    url: https://www.linkedin.com/in/kwangchunlee/</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliation: 한국 R 사용자회</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliation-url: https://github.com/bit2r</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="an">title-block-banner:</span><span class="co"> true</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: flatly</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: 목차</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: github    </span></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a><span class="co">    self-contained: false</span></span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a><span class="co">    default-image-extension: jpg</span></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a><span class="an">filters:</span></span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a><span class="co">   - lightbox</span></span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a><span class="an">lightbox:</span><span class="co"> auto</span></span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a><span class="an">link-citations:</span><span class="co"> true</span></span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a><span class="an">knitr:</span></span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a><span class="co">  opts_chunk: </span></span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a><span class="co">    eval: false</span></span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a><span class="co">    message: false</span></span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a><span class="co">    warning: false</span></span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a><span class="co">    collapse: true</span></span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a><span class="co">    comment: "#&gt;" </span></span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a><span class="co">    R.options:</span></span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a><span class="co">      knitr.graphics.auto_pdf: true</span></span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a><span class="fu"># 민간 데이터셋</span></span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-45"><a href="#cb64-45" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb64-46"><a href="#cb64-46" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-47"><a href="#cb64-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-48"><a href="#cb64-48" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> camelot</span>
<span id="cb64-49"><a href="#cb64-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-50"><a href="#cb64-50" aria-hidden="true" tabindex="-1"></a><span class="co"># PDF 파일에서 표를 읽어옵니다.</span></span>
<span id="cb64-51"><a href="#cb64-51" aria-hidden="true" tabindex="-1"></a>tables <span class="op">=</span> camelot.read_pdf(<span class="st">'data/민간데이터 목록.pdf'</span>, pages<span class="op">=</span><span class="st">'1'</span>)</span>
<span id="cb64-52"><a href="#cb64-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-53"><a href="#cb64-53" aria-hidden="true" tabindex="-1"></a>tables_pd <span class="op">=</span> tables[<span class="dv">0</span>].df</span>
<span id="cb64-54"><a href="#cb64-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-55"><a href="#cb64-55" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터프레임을 CSV 파일로 저장합니다.</span></span>
<span id="cb64-56"><a href="#cb64-56" aria-hidden="true" tabindex="-1"></a><span class="co"># df.to_csv('output.csv', index=False)</span></span>
<span id="cb64-57"><a href="#cb64-57" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-58"><a href="#cb64-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-59"><a href="#cb64-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-60"><a href="#cb64-60" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-61"><a href="#cb64-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-62"><a href="#cb64-62" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-63"><a href="#cb64-63" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-64"><a href="#cb64-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-65"><a href="#cb64-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb64-66"><a href="#cb64-66" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb64-67"><a href="#cb64-67" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb64-68"><a href="#cb64-68" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtExtras)</span>
<span id="cb64-69"><a href="#cb64-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-70"><a href="#cb64-70" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> py<span class="sc">$</span>tables_pd</span>
<span id="cb64-71"><a href="#cb64-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-72"><a href="#cb64-72" aria-hidden="true" tabindex="-1"></a>dataset <span class="sc">|&gt;</span> </span>
<span id="cb64-73"><a href="#cb64-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb64-74"><a href="#cb64-74" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">row_to_names</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-75"><a href="#cb64-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(제공기관, <span class="at">.before =</span> 분석구분) <span class="sc">|&gt;</span> </span>
<span id="cb64-76"><a href="#cb64-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">groupname_col =</span> <span class="st">"제공기관"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-77"><a href="#cb64-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt_theme_538</span>() <span class="sc">|&gt;</span> </span>
<span id="cb64-78"><a href="#cb64-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb64-79"><a href="#cb64-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.title.font.size =</span> <span class="fu">px</span>(<span class="dv">16</span>L),</span>
<span id="cb64-80"><a href="#cb64-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.font.size =</span> <span class="fu">px</span>(<span class="dv">14</span>L),</span>
<span id="cb64-81"><a href="#cb64-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.font.size =</span> <span class="fu">px</span>(<span class="dv">12</span>L)</span>
<span id="cb64-82"><a href="#cb64-82" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span>   </span>
<span id="cb64-83"><a href="#cb64-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(<span class="st">"center"</span>)</span>
<span id="cb64-84"><a href="#cb64-84" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-85"><a href="#cb64-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-86"><a href="#cb64-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-87"><a href="#cb64-87" aria-hidden="true" tabindex="-1"></a><span class="fu"># 경기 연도별 카드매출 </span></span>
<span id="cb64-88"><a href="#cb64-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-89"><a href="#cb64-89" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb64-90"><a href="#cb64-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-91"><a href="#cb64-91" aria-hidden="true" tabindex="-1"></a><span class="fu">## 월별 매출금액</span></span>
<span id="cb64-92"><a href="#cb64-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-93"><a href="#cb64-93" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-94"><a href="#cb64-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-95"><a href="#cb64-95" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-96"><a href="#cb64-96" aria-hidden="true" tabindex="-1"></a>extrafont<span class="sc">::</span><span class="fu">loadfonts</span>()</span>
<span id="cb64-97"><a href="#cb64-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-98"><a href="#cb64-98" aria-hidden="true" tabindex="-1"></a>amt_files <span class="ot">&lt;-</span> fs<span class="sc">::</span><span class="fu">dir_ls</span>(<span class="st">"data/BC카드데이터/TBSH_GYEONGGI_SELNG/"</span>)</span>
<span id="cb64-99"><a href="#cb64-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-100"><a href="#cb64-100" aria-hidden="true" tabindex="-1"></a>amt_raw <span class="ot">&lt;-</span> amt_files <span class="sc">%&gt;%</span> </span>
<span id="cb64-101"><a href="#cb64-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">enframe</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-102"><a href="#cb64-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(value, read_delim)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-103"><a href="#cb64-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, data) <span class="sc">%&gt;%</span> </span>
<span id="cb64-104"><a href="#cb64-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">str_extract</span>(name, <span class="st">"</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">.txt$"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-105"><a href="#cb64-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data)</span>
<span id="cb64-106"><a href="#cb64-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-107"><a href="#cb64-107" aria-hidden="true" tabindex="-1"></a>amt_tbl <span class="ot">&lt;-</span> amt_raw <span class="sc">%&gt;%</span> </span>
<span id="cb64-108"><a href="#cb64-108" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-109"><a href="#cb64-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ta_ym =</span> lubridate<span class="sc">::</span><span class="fu">ym</span>(ta_ym))</span>
<span id="cb64-110"><a href="#cb64-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-111"><a href="#cb64-111" aria-hidden="true" tabindex="-1"></a>monthly_amt_tbl <span class="ot">&lt;-</span> amt_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb64-112"><a href="#cb64-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ta_ym) <span class="sc">%&gt;%</span> </span>
<span id="cb64-113"><a href="#cb64-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(결재건수 <span class="ot">=</span> <span class="fu">sum</span>(total_cnt, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>,</span>
<span id="cb64-114"><a href="#cb64-114" aria-hidden="true" tabindex="-1"></a>            결재금액 <span class="ot">=</span> <span class="fu">sum</span>(total_amt, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">8</span>)</span>
<span id="cb64-115"><a href="#cb64-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-116"><a href="#cb64-116" aria-hidden="true" tabindex="-1"></a>monthly_amt_gg <span class="ot">&lt;-</span> monthly_amt_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb64-117"><a href="#cb64-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>ta_ym) <span class="sc">%&gt;%</span> </span>
<span id="cb64-118"><a href="#cb64-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-119"><a href="#cb64-119" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> ta_ym, <span class="at">y =</span> value, <span class="at">color =</span> name))  <span class="sc">+</span></span>
<span id="cb64-120"><a href="#cb64-120" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb64-121"><a href="#cb64-121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>) <span class="sc">+</span></span>
<span id="cb64-122"><a href="#cb64-122" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span> <span class="st">""</span>,</span>
<span id="cb64-123"><a href="#cb64-123" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"경기도 카드 매출 추세"</span>,</span>
<span id="cb64-124"><a href="#cb64-124" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"BC 카드 월별 결재건수(단위: 만건)와 금액(단위:억원)"</span>,</span>
<span id="cb64-125"><a href="#cb64-125" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"출처: 경기도 데이터분석포털 민간 데이터셋"</span>) <span class="sc">+</span></span>
<span id="cb64-126"><a href="#cb64-126" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb64-127"><a href="#cb64-127" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) </span>
<span id="cb64-128"><a href="#cb64-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-129"><a href="#cb64-129" aria-hidden="true" tabindex="-1"></a>monthly_amt_gg</span>
<span id="cb64-130"><a href="#cb64-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-131"><a href="#cb64-131" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_png</span>(<span class="st">"images/BC/카드매출_월별_매출_건수_추세.png"</span>, </span>
<span id="cb64-132"><a href="#cb64-132" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-133"><a href="#cb64-133" aria-hidden="true" tabindex="-1"></a>monthly_amt_gg</span>
<span id="cb64-134"><a href="#cb64-134" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-135"><a href="#cb64-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-136"><a href="#cb64-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-137"><a href="#cb64-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-138"><a href="#cb64-138" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/카드매출_월별_매출_건수_추세.png)</span></span>
<span id="cb64-139"><a href="#cb64-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-140"><a href="#cb64-140" aria-hidden="true" tabindex="-1"></a><span class="fu">## 개인/법인 매출</span></span>
<span id="cb64-141"><a href="#cb64-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-142"><a href="#cb64-142" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-143"><a href="#cb64-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-144"><a href="#cb64-144" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-145"><a href="#cb64-145" aria-hidden="true" tabindex="-1"></a>monthly_type_amt_tbl <span class="ot">&lt;-</span> amt_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb64-146"><a href="#cb64-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ta_ym) <span class="sc">%&gt;%</span> </span>
<span id="cb64-147"><a href="#cb64-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(개인건수 <span class="ot">=</span> <span class="fu">sum</span>(indv_cnt, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>,</span>
<span id="cb64-148"><a href="#cb64-148" aria-hidden="true" tabindex="-1"></a>            개인금액 <span class="ot">=</span> <span class="fu">sum</span>(indv_amt, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">8</span>,</span>
<span id="cb64-149"><a href="#cb64-149" aria-hidden="true" tabindex="-1"></a>            법인건수 <span class="ot">=</span> <span class="fu">sum</span>(entp_cnt, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>,</span>
<span id="cb64-150"><a href="#cb64-150" aria-hidden="true" tabindex="-1"></a>            법인금액 <span class="ot">=</span> <span class="fu">sum</span>(entp_amt, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">8</span>)</span>
<span id="cb64-151"><a href="#cb64-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-152"><a href="#cb64-152" aria-hidden="true" tabindex="-1"></a>monthly_type_amt_gg <span class="ot">&lt;-</span> monthly_type_amt_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb64-153"><a href="#cb64-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>ta_ym) <span class="sc">%&gt;%</span> </span>
<span id="cb64-154"><a href="#cb64-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(구분 <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(name, <span class="st">"개인"</span>), <span class="st">"개인카드"</span>, <span class="st">"법인카드"</span>),</span>
<span id="cb64-155"><a href="#cb64-155" aria-hidden="true" tabindex="-1"></a>         금액건수 <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(name, <span class="st">"건수"</span>), <span class="st">"건수"</span>, <span class="st">"금액"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-156"><a href="#cb64-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-157"><a href="#cb64-157" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> ta_ym, <span class="at">y =</span> value, <span class="at">color =</span> 구분))  <span class="sc">+</span></span>
<span id="cb64-158"><a href="#cb64-158" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>금액건수, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb64-159"><a href="#cb64-159" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>) <span class="sc">+</span></span>
<span id="cb64-160"><a href="#cb64-160" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span> <span class="st">""</span>,</span>
<span id="cb64-161"><a href="#cb64-161" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"경기도 카드 매출 추세"</span>,</span>
<span id="cb64-162"><a href="#cb64-162" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"BC 카드 월별 카드유형별 결재건수(단위: 만건)와 금액(단위:억원)"</span>,</span>
<span id="cb64-163"><a href="#cb64-163" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"출처: 경기도 데이터분석포털 민간 데이터셋"</span>) <span class="sc">+</span></span>
<span id="cb64-164"><a href="#cb64-164" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_sqrt</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb64-165"><a href="#cb64-165" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb64-166"><a href="#cb64-166" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb64-167"><a href="#cb64-167" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_date</span>(<span class="at">breaks =</span> <span class="st">"1 year"</span>, <span class="at">minor_breaks =</span> <span class="st">"3 months"</span>,</span>
<span id="cb64-168"><a href="#cb64-168" aria-hidden="true" tabindex="-1"></a>                 <span class="at">date_labels =</span> <span class="st">"%Y"</span>)</span>
<span id="cb64-169"><a href="#cb64-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-170"><a href="#cb64-170" aria-hidden="true" tabindex="-1"></a>monthly_type_amt_gg</span>
<span id="cb64-171"><a href="#cb64-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-172"><a href="#cb64-172" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_png</span>(<span class="st">"images/BC/카드매출_월별_카드유형_매출_건수_추세.png"</span>, </span>
<span id="cb64-173"><a href="#cb64-173" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-174"><a href="#cb64-174" aria-hidden="true" tabindex="-1"></a>monthly_type_amt_gg</span>
<span id="cb64-175"><a href="#cb64-175" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-176"><a href="#cb64-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-177"><a href="#cb64-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-178"><a href="#cb64-178" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/카드매출_월별_카드유형_매출_건수_추세.png)</span></span>
<span id="cb64-179"><a href="#cb64-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-180"><a href="#cb64-180" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-181"><a href="#cb64-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-182"><a href="#cb64-182" aria-hidden="true" tabindex="-1"></a><span class="fu">## 블록코드 시군구 매칭작업</span></span>
<span id="cb64-183"><a href="#cb64-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-184"><a href="#cb64-184" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-185"><a href="#cb64-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-186"><a href="#cb64-186" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-187"><a href="#cb64-187" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb64-188"><a href="#cb64-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-189"><a href="#cb64-189" aria-hidden="true" tabindex="-1"></a>mst_tbl <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/(공통)셀블록도로행정동/경기도_시군구_행정동_명,CD.csv"</span>,</span>
<span id="cb64-190"><a href="#cb64-190" aria-hidden="true" tabindex="-1"></a>                    <span class="at">locale =</span> <span class="fu">locale</span>(<span class="st">'ko'</span>,<span class="at">encoding=</span><span class="st">'euc-kr'</span>))</span>
<span id="cb64-191"><a href="#cb64-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-192"><a href="#cb64-192" aria-hidden="true" tabindex="-1"></a>gg_blk_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/(공통)셀블록도로행정동/블록경계/블록_v6_경기도/tbshp_block_v6_gg_20210412.shp"</span>)</span>
<span id="cb64-193"><a href="#cb64-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-194"><a href="#cb64-194" aria-hidden="true" tabindex="-1"></a>gg_blk_tbl <span class="ot">&lt;-</span> gg_blk_sf  <span class="sc">%&gt;%</span> </span>
<span id="cb64-195"><a href="#cb64-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-196"><a href="#cb64-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb64-197"><a href="#cb64-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-198"><a href="#cb64-198" aria-hidden="true" tabindex="-1"></a>gg_blk_mst_raw <span class="ot">&lt;-</span> mst_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb64-199"><a href="#cb64-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(gg_blk_tbl)</span>
<span id="cb64-200"><a href="#cb64-200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-201"><a href="#cb64-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-202"><a href="#cb64-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-203"><a href="#cb64-203" aria-hidden="true" tabindex="-1"></a><span class="fu">## 시군구별 월별 매출금액</span></span>
<span id="cb64-204"><a href="#cb64-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-205"><a href="#cb64-205" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-206"><a href="#cb64-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-207"><a href="#cb64-207" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-208"><a href="#cb64-208" aria-hidden="true" tabindex="-1"></a>gg_blk_mst_tbl <span class="ot">&lt;-</span> gg_blk_mst_raw <span class="sc">%&gt;%</span> janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-209"><a href="#cb64-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cty_cd, cty_nm, admi_cd, admi_nm, blk_cd)</span>
<span id="cb64-210"><a href="#cb64-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-211"><a href="#cb64-211" aria-hidden="true" tabindex="-1"></a>sgg_amt_tbl <span class="ot">&lt;-</span> amt_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb64-212"><a href="#cb64-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(gg_blk_mst_tbl) <span class="sc">%&gt;%</span> </span>
<span id="cb64-213"><a href="#cb64-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ta_ym, cty_cd, cty_nm) <span class="sc">%&gt;%</span> </span>
<span id="cb64-214"><a href="#cb64-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(결재금액 <span class="ot">=</span> <span class="fu">sum</span>(total_amt, <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">8</span>,</span>
<span id="cb64-215"><a href="#cb64-215" aria-hidden="true" tabindex="-1"></a>            결재건수 <span class="ot">=</span> <span class="fu">sum</span>(total_cnt, <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-216"><a href="#cb64-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb64-217"><a href="#cb64-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-218"><a href="#cb64-218" aria-hidden="true" tabindex="-1"></a>sgg_amt_max_tbl <span class="ot">&lt;-</span> sgg_amt_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb64-219"><a href="#cb64-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ta_ym <span class="sc">==</span> <span class="fu">max</span>(ta_ym)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-220"><a href="#cb64-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(결재금액<span class="sc">:</span>결재건수)</span>
<span id="cb64-221"><a href="#cb64-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-222"><a href="#cb64-222" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb64-223"><a href="#cb64-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-224"><a href="#cb64-224" aria-hidden="true" tabindex="-1"></a>sgg_amt_tbl_gg <span class="ot">&lt;-</span> sgg_amt_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb64-225"><a href="#cb64-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(결재금액<span class="sc">:</span>결재건수) <span class="sc">%&gt;%</span> </span>
<span id="cb64-226"><a href="#cb64-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-227"><a href="#cb64-227" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> ta_ym, <span class="at">y =</span> value, <span class="at">color =</span> cty_nm))  <span class="sc">+</span></span>
<span id="cb64-228"><a href="#cb64-228" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb64-229"><a href="#cb64-229" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>) <span class="sc">+</span></span>
<span id="cb64-230"><a href="#cb64-230" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span> <span class="st">""</span>,</span>
<span id="cb64-231"><a href="#cb64-231" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"경기도 카드 매출 추세"</span>,</span>
<span id="cb64-232"><a href="#cb64-232" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"BC 카드 월별 시군구 결재건수(단위: 만건)와 금액(단위:억원)"</span>,</span>
<span id="cb64-233"><a href="#cb64-233" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"출처: 경기도 데이터분석포털 민간 데이터셋"</span>) <span class="sc">+</span></span>
<span id="cb64-234"><a href="#cb64-234" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_sqrt</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb64-235"><a href="#cb64-235" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb64-236"><a href="#cb64-236" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_date</span>(<span class="at">breaks =</span> <span class="st">"1 year"</span>, <span class="at">minor_breaks =</span> <span class="st">"3 months"</span>,</span>
<span id="cb64-237"><a href="#cb64-237" aria-hidden="true" tabindex="-1"></a>                 <span class="at">date_labels =</span> <span class="st">"%Y"</span>) <span class="sc">+</span></span>
<span id="cb64-238"><a href="#cb64-238" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> sgg_amt_max_tbl, <span class="fu">aes</span>(<span class="at">x=</span>ta_ym, <span class="at">y =</span> value, <span class="at">color =</span> cty_nm)) <span class="sc">+</span></span>
<span id="cb64-239"><a href="#cb64-239" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">data =</span> sgg_amt_max_tbl, <span class="fu">aes</span>(<span class="at">x=</span>ta_ym, <span class="at">y =</span> value, <span class="at">color =</span> cty_nm, <span class="at">label=</span> cty_nm), <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb64-240"><a href="#cb64-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-241"><a href="#cb64-241" aria-hidden="true" tabindex="-1"></a>sgg_amt_tbl_gg</span>
<span id="cb64-242"><a href="#cb64-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-243"><a href="#cb64-243" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_png</span>(<span class="st">"images/BC/카드매출_월별_시군구_매출_건수_추세.png"</span>, </span>
<span id="cb64-244"><a href="#cb64-244" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-245"><a href="#cb64-245" aria-hidden="true" tabindex="-1"></a>sgg_amt_tbl_gg</span>
<span id="cb64-246"><a href="#cb64-246" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-247"><a href="#cb64-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-248"><a href="#cb64-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-249"><a href="#cb64-249" aria-hidden="true" tabindex="-1"></a><span class="fu">## 서해 인접 시군구</span></span>
<span id="cb64-250"><a href="#cb64-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-251"><a href="#cb64-251" aria-hidden="true" tabindex="-1"></a><span class="fu">### 블록코드 시군구 매칭작업</span></span>
<span id="cb64-252"><a href="#cb64-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-253"><a href="#cb64-253" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-254"><a href="#cb64-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-255"><a href="#cb64-255" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-256"><a href="#cb64-256" aria-hidden="true" tabindex="-1"></a>sea_sgg_mst <span class="ot">&lt;-</span> gg_blk_mst_raw <span class="sc">%&gt;%</span> </span>
<span id="cb64-257"><a href="#cb64-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(CTY_NM, <span class="st">"(^김포)|(^안산)|(^평택)|(^화성)|(^시흥)"</span>))</span>
<span id="cb64-258"><a href="#cb64-258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-259"><a href="#cb64-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-260"><a href="#cb64-260" aria-hidden="true" tabindex="-1"></a><span class="fu">### 서해인접 시군구 월별 매출금액</span></span>
<span id="cb64-261"><a href="#cb64-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-262"><a href="#cb64-262" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-263"><a href="#cb64-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-264"><a href="#cb64-264" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-265"><a href="#cb64-265" aria-hidden="true" tabindex="-1"></a>sea_sgg_mst_tbl <span class="ot">&lt;-</span> sea_sgg_mst <span class="sc">%&gt;%</span> janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-266"><a href="#cb64-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cty_cd, cty_nm, admi_cd, admi_nm, blk_cd)</span>
<span id="cb64-267"><a href="#cb64-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-268"><a href="#cb64-268" aria-hidden="true" tabindex="-1"></a>sea_sgg_amt_tbl <span class="ot">&lt;-</span> amt_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb64-269"><a href="#cb64-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sea_sgg_mst_tbl) <span class="sc">%&gt;%</span> </span>
<span id="cb64-270"><a href="#cb64-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ta_ym, cty_cd, cty_nm) <span class="sc">%&gt;%</span> </span>
<span id="cb64-271"><a href="#cb64-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(결재금액 <span class="ot">=</span> <span class="fu">sum</span>(total_amt, <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">8</span>,</span>
<span id="cb64-272"><a href="#cb64-272" aria-hidden="true" tabindex="-1"></a>            결재건수 <span class="ot">=</span> <span class="fu">sum</span>(total_cnt, <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-273"><a href="#cb64-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-274"><a href="#cb64-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb64-275"><a href="#cb64-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-276"><a href="#cb64-276" aria-hidden="true" tabindex="-1"></a>sea_sgg_amt_max_tbl <span class="ot">&lt;-</span> sea_sgg_amt_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb64-277"><a href="#cb64-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ta_ym <span class="sc">==</span> <span class="fu">max</span>(ta_ym)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-278"><a href="#cb64-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(결재금액<span class="sc">:</span>결재건수)</span>
<span id="cb64-279"><a href="#cb64-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-280"><a href="#cb64-280" aria-hidden="true" tabindex="-1"></a>sea_sgg_amt_tbl_gg <span class="ot">&lt;-</span> sea_sgg_amt_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb64-281"><a href="#cb64-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(결재금액<span class="sc">:</span>결재건수) <span class="sc">%&gt;%</span> </span>
<span id="cb64-282"><a href="#cb64-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-283"><a href="#cb64-283" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> ta_ym, <span class="at">y =</span> value, <span class="at">color =</span> cty_nm))  <span class="sc">+</span></span>
<span id="cb64-284"><a href="#cb64-284" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb64-285"><a href="#cb64-285" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>) <span class="sc">+</span></span>
<span id="cb64-286"><a href="#cb64-286" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span> <span class="st">""</span>,</span>
<span id="cb64-287"><a href="#cb64-287" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"경기도 카드 매출 추세"</span>,</span>
<span id="cb64-288"><a href="#cb64-288" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"BC 카드 월별 서해인접 시군구 결재건수(단위: 만건)와 금액(단위:억원)"</span>,</span>
<span id="cb64-289"><a href="#cb64-289" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"출처: 경기도 데이터분석포털 민간 데이터셋"</span>) <span class="sc">+</span></span>
<span id="cb64-290"><a href="#cb64-290" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_sqrt</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb64-291"><a href="#cb64-291" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb64-292"><a href="#cb64-292" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_date</span>(<span class="at">breaks =</span> <span class="st">"1 year"</span>, <span class="at">minor_breaks =</span> <span class="st">"3 months"</span>,</span>
<span id="cb64-293"><a href="#cb64-293" aria-hidden="true" tabindex="-1"></a>                 <span class="at">date_labels =</span> <span class="st">"%Y"</span>) <span class="sc">+</span></span>
<span id="cb64-294"><a href="#cb64-294" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> sea_sgg_amt_max_tbl, <span class="fu">aes</span>(<span class="at">x=</span>ta_ym, <span class="at">y =</span> value, <span class="at">color =</span> cty_nm)) <span class="sc">+</span></span>
<span id="cb64-295"><a href="#cb64-295" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">data =</span> sea_sgg_amt_max_tbl, <span class="fu">aes</span>(<span class="at">x=</span>ta_ym, <span class="at">y =</span> value, <span class="at">color =</span> cty_nm, <span class="at">label=</span> cty_nm), <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb64-296"><a href="#cb64-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-297"><a href="#cb64-297" aria-hidden="true" tabindex="-1"></a>sea_sgg_amt_tbl_gg</span>
<span id="cb64-298"><a href="#cb64-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-299"><a href="#cb64-299" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_png</span>(<span class="st">"images/BC/카드매출_월별_서해인접_시군구_매출_건수_추세.png"</span>, </span>
<span id="cb64-300"><a href="#cb64-300" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-301"><a href="#cb64-301" aria-hidden="true" tabindex="-1"></a>sea_sgg_amt_tbl_gg</span>
<span id="cb64-302"><a href="#cb64-302" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-303"><a href="#cb64-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-304"><a href="#cb64-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-305"><a href="#cb64-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-306"><a href="#cb64-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-307"><a href="#cb64-307" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/카드매출_월별_서해인접_시군구_매출_건수_추세.png)</span></span>
<span id="cb64-308"><a href="#cb64-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-309"><a href="#cb64-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-310"><a href="#cb64-310" aria-hidden="true" tabindex="-1"></a><span class="fu">## 서해 인접 행정동</span></span>
<span id="cb64-311"><a href="#cb64-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-312"><a href="#cb64-312" aria-hidden="true" tabindex="-1"></a><span class="fu">### 서해인접 시군구</span></span>
<span id="cb64-313"><a href="#cb64-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-314"><a href="#cb64-314" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-315"><a href="#cb64-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-316"><a href="#cb64-316" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-317"><a href="#cb64-317" aria-hidden="true" tabindex="-1"></a>gg_blk_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/(공통)셀블록도로행정동/블록경계/블록_v6_경기도/tbshp_block_v6_gg_20210412.shp"</span>)</span>
<span id="cb64-318"><a href="#cb64-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-319"><a href="#cb64-319" aria-hidden="true" tabindex="-1"></a>mst_tbl <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/(공통)셀블록도로행정동/경기도_시군구_행정동_명,CD.csv"</span>,</span>
<span id="cb64-320"><a href="#cb64-320" aria-hidden="true" tabindex="-1"></a>                    <span class="at">locale =</span> <span class="fu">locale</span>(<span class="st">'ko'</span>,<span class="at">encoding=</span><span class="st">'euc-kr'</span>))</span>
<span id="cb64-321"><a href="#cb64-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-322"><a href="#cb64-322" aria-hidden="true" tabindex="-1"></a>sea_blk_sf <span class="ot">&lt;-</span> gg_blk_sf <span class="sc">%&gt;%</span> </span>
<span id="cb64-323"><a href="#cb64-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mst_tbl) <span class="sc">%&gt;%</span> </span>
<span id="cb64-324"><a href="#cb64-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(CTY_NM, <span class="st">"(^김포)|(^안산)|(^평택)|(^화성)|(^시흥)"</span>)) </span>
<span id="cb64-325"><a href="#cb64-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-326"><a href="#cb64-326" aria-hidden="true" tabindex="-1"></a>sea_blk_sf <span class="sc">%&gt;%</span> </span>
<span id="cb64-327"><a href="#cb64-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-328"><a href="#cb64-328" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>() <span class="sc">+</span></span>
<span id="cb64-329"><a href="#cb64-329" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>()</span>
<span id="cb64-330"><a href="#cb64-330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-331"><a href="#cb64-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-332"><a href="#cb64-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-333"><a href="#cb64-333" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb64-334"><a href="#cb64-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-335"><a href="#cb64-335" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2017년 1월</span></span>
<span id="cb64-336"><a href="#cb64-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-337"><a href="#cb64-337" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-338"><a href="#cb64-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-339"><a href="#cb64-339" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-340"><a href="#cb64-340" aria-hidden="true" tabindex="-1"></a>김포_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/sgg_map/김포시.geojson"</span>)</span>
<span id="cb64-341"><a href="#cb64-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-342"><a href="#cb64-342" aria-hidden="true" tabindex="-1"></a>amt_start_tbl <span class="ot">&lt;-</span> amt_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb64-343"><a href="#cb64-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ta_ym <span class="sc">==</span> <span class="fu">min</span>(ta_ym))</span>
<span id="cb64-344"><a href="#cb64-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-345"><a href="#cb64-345" aria-hidden="true" tabindex="-1"></a>amt_end_tbl <span class="ot">&lt;-</span> amt_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb64-346"><a href="#cb64-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ta_ym <span class="sc">==</span> <span class="fu">max</span>(ta_ym))</span>
<span id="cb64-347"><a href="#cb64-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-348"><a href="#cb64-348" aria-hidden="true" tabindex="-1"></a>sea_blk_amt_sf <span class="ot">&lt;-</span> sea_blk_sf <span class="sc">%&gt;%</span> </span>
<span id="cb64-349"><a href="#cb64-349" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-350"><a href="#cb64-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(amt_start_tbl) <span class="sc">%&gt;%</span> </span>
<span id="cb64-351"><a href="#cb64-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_manwon_amt =</span> total_amt <span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">8</span>)</span>
<span id="cb64-352"><a href="#cb64-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-353"><a href="#cb64-353" aria-hidden="true" tabindex="-1"></a>sea_blk_amt_sf <span class="ot">&lt;-</span> <span class="fu">st_set_crs</span>(sea_blk_amt_sf, sf<span class="sc">::</span><span class="fu">st_crs</span>(김포_sf))</span>
<span id="cb64-354"><a href="#cb64-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-355"><a href="#cb64-355" aria-hidden="true" tabindex="-1"></a>sea_blk_amt_sf_gg <span class="ot">&lt;-</span> sea_blk_amt_sf <span class="sc">%&gt;%</span> </span>
<span id="cb64-356"><a href="#cb64-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-357"><a href="#cb64-357" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> total_manwon_amt)) <span class="sc">+</span></span>
<span id="cb64-358"><a href="#cb64-358" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> sea_blk_amt_sf, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">fill =</span> <span class="st">"transparent"</span>) <span class="sc">+</span></span>
<span id="cb64-359"><a href="#cb64-359" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"D"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb64-360"><a href="#cb64-360" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb64-361"><a href="#cb64-361" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"결재금액(억원)"</span>)</span>
<span id="cb64-362"><a href="#cb64-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-363"><a href="#cb64-363" aria-hidden="true" tabindex="-1"></a>sea_blk_amt_sf_gg</span>
<span id="cb64-364"><a href="#cb64-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-365"><a href="#cb64-365" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_png</span>(<span class="st">"images/BC/카드매출_월별_서해인접_시군구_매출_201701.png"</span>, </span>
<span id="cb64-366"><a href="#cb64-366" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-367"><a href="#cb64-367" aria-hidden="true" tabindex="-1"></a>sea_blk_amt_sf_gg</span>
<span id="cb64-368"><a href="#cb64-368" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-369"><a href="#cb64-369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-370"><a href="#cb64-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-371"><a href="#cb64-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-372"><a href="#cb64-372" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/카드매출_월별_서해인접_시군구_매출_201701.png)</span></span>
<span id="cb64-373"><a href="#cb64-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-374"><a href="#cb64-374" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2023년 5월</span></span>
<span id="cb64-375"><a href="#cb64-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-376"><a href="#cb64-376" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-377"><a href="#cb64-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-378"><a href="#cb64-378" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-379"><a href="#cb64-379" aria-hidden="true" tabindex="-1"></a>sea_blk_end_amt_sf <span class="ot">&lt;-</span> sea_blk_sf <span class="sc">%&gt;%</span> </span>
<span id="cb64-380"><a href="#cb64-380" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-381"><a href="#cb64-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(amt_end_tbl) <span class="sc">%&gt;%</span> </span>
<span id="cb64-382"><a href="#cb64-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_manwon_amt =</span> total_amt <span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">8</span>)</span>
<span id="cb64-383"><a href="#cb64-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-384"><a href="#cb64-384" aria-hidden="true" tabindex="-1"></a>sea_blk_end_amt_sf <span class="ot">&lt;-</span> <span class="fu">st_set_crs</span>(sea_blk_end_amt_sf, sf<span class="sc">::</span><span class="fu">st_crs</span>(김포_sf))</span>
<span id="cb64-385"><a href="#cb64-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-386"><a href="#cb64-386" aria-hidden="true" tabindex="-1"></a>sea_blk_end_amt_gg <span class="ot">&lt;-</span> sea_blk_end_amt_sf <span class="sc">%&gt;%</span> </span>
<span id="cb64-387"><a href="#cb64-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-388"><a href="#cb64-388" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> total_manwon_amt)) <span class="sc">+</span></span>
<span id="cb64-389"><a href="#cb64-389" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"D"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb64-390"><a href="#cb64-390" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb64-391"><a href="#cb64-391" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"결재금액(억원)"</span>)</span>
<span id="cb64-392"><a href="#cb64-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-393"><a href="#cb64-393" aria-hidden="true" tabindex="-1"></a>sea_blk_end_amt_gg</span>
<span id="cb64-394"><a href="#cb64-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-395"><a href="#cb64-395" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_png</span>(<span class="st">"images/BC/카드매출_월별_서해인접_시군구_매출_202305.png"</span>, </span>
<span id="cb64-396"><a href="#cb64-396" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-397"><a href="#cb64-397" aria-hidden="true" tabindex="-1"></a>sea_blk_end_amt_gg</span>
<span id="cb64-398"><a href="#cb64-398" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-399"><a href="#cb64-399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-400"><a href="#cb64-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-401"><a href="#cb64-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-402"><a href="#cb64-402" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/카드매출_월별_서해인접_시군구_매출_202305.png)</span></span>
<span id="cb64-403"><a href="#cb64-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-404"><a href="#cb64-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-405"><a href="#cb64-405" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-406"><a href="#cb64-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-407"><a href="#cb64-407" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-408"><a href="#cb64-408" aria-hidden="true" tabindex="-1"></a>bbox_lim <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(sea_blk_end_amt_sf)</span>
<span id="cb64-409"><a href="#cb64-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-410"><a href="#cb64-410" aria-hidden="true" tabindex="-1"></a>sea_blk_end_amt_sf <span class="sc">%&gt;%</span> </span>
<span id="cb64-411"><a href="#cb64-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-412"><a href="#cb64-412" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> total_manwon_amt)) <span class="sc">+</span></span>
<span id="cb64-413"><a href="#cb64-413" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"D"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb64-414"><a href="#cb64-414" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb64-415"><a href="#cb64-415" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"결재금액(억원)"</span>) <span class="sc">+</span></span>
<span id="cb64-416"><a href="#cb64-416" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(bbox_lim[<span class="dv">1</span>]<span class="sc">-</span><span class="dv">100000</span>, bbox_lim[<span class="dv">3</span>]),</span>
<span id="cb64-417"><a href="#cb64-417" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylim =</span> bbox_lim[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>)])</span>
<span id="cb64-418"><a href="#cb64-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-419"><a href="#cb64-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-420"><a href="#cb64-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-421"><a href="#cb64-421" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5개 시군구별</span></span>
<span id="cb64-422"><a href="#cb64-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-423"><a href="#cb64-423" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-424"><a href="#cb64-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-425"><a href="#cb64-425" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-426"><a href="#cb64-426" aria-hidden="true" tabindex="-1"></a>sgg_names <span class="ot">&lt;-</span> sea_blk_end_amt_sf <span class="sc">%&gt;%</span> </span>
<span id="cb64-427"><a href="#cb64-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-428"><a href="#cb64-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(cty_nm) <span class="sc">%&gt;%</span> </span>
<span id="cb64-429"><a href="#cb64-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(cty_nm)</span>
<span id="cb64-430"><a href="#cb64-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-431"><a href="#cb64-431" aria-hidden="true" tabindex="-1"></a>sgg_maps <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="at">.x =</span> sgg_names, </span>
<span id="cb64-432"><a href="#cb64-432" aria-hidden="true" tabindex="-1"></a>            <span class="at">.f =</span> <span class="cf">function</span>(x) sea_blk_end_amt_sf <span class="sc">%&gt;%</span> </span>
<span id="cb64-433"><a href="#cb64-433" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(cty_nm <span class="sc">==</span> x) <span class="sc">%&gt;%</span> </span>
<span id="cb64-434"><a href="#cb64-434" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-435"><a href="#cb64-435" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> total_manwon_amt)) <span class="sc">+</span></span>
<span id="cb64-436"><a href="#cb64-436" aria-hidden="true" tabindex="-1"></a>                <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"D"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb64-437"><a href="#cb64-437" aria-hidden="true" tabindex="-1"></a>                <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb64-438"><a href="#cb64-438" aria-hidden="true" tabindex="-1"></a>                <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"결재금액(억원)"</span>))</span>
<span id="cb64-439"><a href="#cb64-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-440"><a href="#cb64-440" aria-hidden="true" tabindex="-1"></a><span class="do">## use COWplot to combine and add single legend</span></span>
<span id="cb64-441"><a href="#cb64-441" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb64-442"><a href="#cb64-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-443"><a href="#cb64-443" aria-hidden="true" tabindex="-1"></a>sgg_individual_plot <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> sgg_maps, <span class="at">labels =</span> sgg_names, <span class="at">label_size =</span> <span class="dv">10</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb64-444"><a href="#cb64-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-445"><a href="#cb64-445" aria-hidden="true" tabindex="-1"></a>sgg_individual_plot</span>
<span id="cb64-446"><a href="#cb64-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-447"><a href="#cb64-447" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_png</span>(<span class="st">"images/BC/카드매출_월별_서해인접_시군구_개별_매출_202305.png"</span>, </span>
<span id="cb64-448"><a href="#cb64-448" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-449"><a href="#cb64-449" aria-hidden="true" tabindex="-1"></a>sgg_individual_plot</span>
<span id="cb64-450"><a href="#cb64-450" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-451"><a href="#cb64-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-452"><a href="#cb64-452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-453"><a href="#cb64-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-454"><a href="#cb64-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-455"><a href="#cb64-455" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/카드매출_월별_서해인접_시군구_개별_매출_202305.png)</span></span>
<span id="cb64-456"><a href="#cb64-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-457"><a href="#cb64-457" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-458"><a href="#cb64-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-459"><a href="#cb64-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-460"><a href="#cb64-460" aria-hidden="true" tabindex="-1"></a><span class="fu"># 광명시</span></span>
<span id="cb64-461"><a href="#cb64-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-462"><a href="#cb64-462" aria-hidden="true" tabindex="-1"></a><span class="fu">## 지도</span></span>
<span id="cb64-463"><a href="#cb64-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-464"><a href="#cb64-464" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb64-465"><a href="#cb64-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-466"><a href="#cb64-466" aria-hidden="true" tabindex="-1"></a><span class="fu">### 경기도</span></span>
<span id="cb64-467"><a href="#cb64-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-468"><a href="#cb64-468" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-469"><a href="#cb64-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-470"><a href="#cb64-470" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-471"><a href="#cb64-471" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb64-472"><a href="#cb64-472" aria-hidden="true" tabindex="-1"></a><span class="co"># gg_sf &lt;- sf::read_sf("(공통)셀블록도로행정동/행정동경계/행정동경계_경기도/행정동경계_경기도_좌표4326.shp")</span></span>
<span id="cb64-473"><a href="#cb64-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-474"><a href="#cb64-474" aria-hidden="true" tabindex="-1"></a>gg_sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">read_sf</span>(<span class="st">"(공통)셀블록도로행정동/행정동경계/행정동경계_경기도/tbshp_admi_gg_20210614.shp"</span>)</span>
<span id="cb64-475"><a href="#cb64-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-476"><a href="#cb64-476" aria-hidden="true" tabindex="-1"></a>gg_sf <span class="sc">%&gt;%</span> </span>
<span id="cb64-477"><a href="#cb64-477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(CTY_NM, geometry) <span class="sc">%&gt;%</span> </span>
<span id="cb64-478"><a href="#cb64-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span>
<span id="cb64-479"><a href="#cb64-479" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-480"><a href="#cb64-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-481"><a href="#cb64-481" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/km/km_gg_map.png)</span></span>
<span id="cb64-482"><a href="#cb64-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-483"><a href="#cb64-483" aria-hidden="true" tabindex="-1"></a>자료구조는 다음과 같다.</span>
<span id="cb64-484"><a href="#cb64-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-485"><a href="#cb64-485" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-486"><a href="#cb64-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-487"><a href="#cb64-487" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-488"><a href="#cb64-488" aria-hidden="true" tabindex="-1"></a>gg_sf <span class="sc">%&gt;%</span> </span>
<span id="cb64-489"><a href="#cb64-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() </span>
<span id="cb64-490"><a href="#cb64-490" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-491"><a href="#cb64-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-492"><a href="#cb64-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-493"><a href="#cb64-493" aria-hidden="true" tabindex="-1"></a><span class="fu">### 셀(격자)</span></span>
<span id="cb64-494"><a href="#cb64-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-495"><a href="#cb64-495" aria-hidden="true" tabindex="-1"></a>광명시 <span class="in">`CTY_CD`</span> == 4121</span>
<span id="cb64-496"><a href="#cb64-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-497"><a href="#cb64-497" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-498"><a href="#cb64-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-499"><a href="#cb64-499" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-500"><a href="#cb64-500" aria-hidden="true" tabindex="-1"></a><span class="co"># cell_sf &lt;- sf::read_sf("(공통)셀블록도로행정동/셀(격자)/cell_gg_square_admi2_20210614.shp")</span></span>
<span id="cb64-501"><a href="#cb64-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-502"><a href="#cb64-502" aria-hidden="true" tabindex="-1"></a><span class="co"># fs::dir_create("km_sf")</span></span>
<span id="cb64-503"><a href="#cb64-503" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb64-504"><a href="#cb64-504" aria-hidden="true" tabindex="-1"></a><span class="co"># cell_sf %&gt;% </span></span>
<span id="cb64-505"><a href="#cb64-505" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(CTY_CD == "4121") %&gt;% </span></span>
<span id="cb64-506"><a href="#cb64-506" aria-hidden="true" tabindex="-1"></a><span class="co">#   sf::write_sf("km_sf/kwangmyung.shp")</span></span>
<span id="cb64-507"><a href="#cb64-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-508"><a href="#cb64-508" aria-hidden="true" tabindex="-1"></a>kwangmyung_cell_sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">read_sf</span>(<span class="st">"km_sf/kwangmyung.shp"</span>)</span>
<span id="cb64-509"><a href="#cb64-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-510"><a href="#cb64-510" aria-hidden="true" tabindex="-1"></a>kwangmyung_cell_sf <span class="sc">%&gt;%</span> </span>
<span id="cb64-511"><a href="#cb64-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CTY_CD <span class="sc">==</span> <span class="st">"4121"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-512"><a href="#cb64-512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(CTY_CD, geometry) <span class="sc">%&gt;%</span> </span>
<span id="cb64-513"><a href="#cb64-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span>
<span id="cb64-514"><a href="#cb64-514" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-515"><a href="#cb64-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-516"><a href="#cb64-516" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/km/km_cell_grid.png)</span></span>
<span id="cb64-517"><a href="#cb64-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-518"><a href="#cb64-518" aria-hidden="true" tabindex="-1"></a>자료구조는 다음과 같다.</span>
<span id="cb64-519"><a href="#cb64-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-520"><a href="#cb64-520" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-521"><a href="#cb64-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-522"><a href="#cb64-522" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-523"><a href="#cb64-523" aria-hidden="true" tabindex="-1"></a>kwangmyung_cell_sf</span>
<span id="cb64-524"><a href="#cb64-524" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-525"><a href="#cb64-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-526"><a href="#cb64-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-527"><a href="#cb64-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-528"><a href="#cb64-528" aria-hidden="true" tabindex="-1"></a><span class="fu">### 도로</span></span>
<span id="cb64-529"><a href="#cb64-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-530"><a href="#cb64-530" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-531"><a href="#cb64-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-532"><a href="#cb64-532" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-533"><a href="#cb64-533" aria-hidden="true" tabindex="-1"></a>road_sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">read_sf</span>(<span class="st">"(공통)셀블록도로행정동/도로/addr_line_50m.shp"</span>)</span>
<span id="cb64-534"><a href="#cb64-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-535"><a href="#cb64-535" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(road_sf <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>))</span>
<span id="cb64-536"><a href="#cb64-536" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-537"><a href="#cb64-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-538"><a href="#cb64-538" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/km/km_road.png)</span></span>
<span id="cb64-539"><a href="#cb64-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-540"><a href="#cb64-540" aria-hidden="true" tabindex="-1"></a>자료구조는 다음과 같다.</span>
<span id="cb64-541"><a href="#cb64-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-542"><a href="#cb64-542" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-543"><a href="#cb64-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-544"><a href="#cb64-544" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-545"><a href="#cb64-545" aria-hidden="true" tabindex="-1"></a>road_sf</span>
<span id="cb64-546"><a href="#cb64-546" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-547"><a href="#cb64-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-548"><a href="#cb64-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-549"><a href="#cb64-549" aria-hidden="true" tabindex="-1"></a><span class="fu">### 셀블럭</span></span>
<span id="cb64-550"><a href="#cb64-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-551"><a href="#cb64-551" aria-hidden="true" tabindex="-1"></a>광명시 <span class="in">`CTY_CD`</span> == 4121</span>
<span id="cb64-552"><a href="#cb64-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-553"><a href="#cb64-553" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-554"><a href="#cb64-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-555"><a href="#cb64-555" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-556"><a href="#cb64-556" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb64-557"><a href="#cb64-557" aria-hidden="true" tabindex="-1"></a>cell_block_raw <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"(공통)셀블록도로행정동/셀_블록_행정동/kt_cell_v6_20210528.csv"</span>)</span>
<span id="cb64-558"><a href="#cb64-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-559"><a href="#cb64-559" aria-hidden="true" tabindex="-1"></a>cell_block_mask <span class="ot">&lt;-</span> cell_block_raw <span class="sc">%&gt;%</span> </span>
<span id="cb64-560"><a href="#cb64-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete.cases</span>()</span>
<span id="cb64-561"><a href="#cb64-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-562"><a href="#cb64-562" aria-hidden="true" tabindex="-1"></a>cell_block_raw <span class="ot">&lt;-</span> cell_block_raw <span class="sc">%&gt;%</span> </span>
<span id="cb64-563"><a href="#cb64-563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cell_block_mask)</span>
<span id="cb64-564"><a href="#cb64-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-565"><a href="#cb64-565" aria-hidden="true" tabindex="-1"></a>cell_block_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="at">x =</span> cell_block_raw, </span>
<span id="cb64-566"><a href="#cb64-566" aria-hidden="true" tabindex="-1"></a>                          <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"X_AXIS"</span>, <span class="st">"Y_AXIS"</span>),</span>
<span id="cb64-567"><a href="#cb64-567" aria-hidden="true" tabindex="-1"></a>                          <span class="at">crs =</span> <span class="st">"+proj=tmerc +lat_0=38 +lon_0=128 +k=0.9999 +x_0=400000 +y_0=600000 +ellps=bessel +towgs84=-115.8,474.99,674.11,1.16,-2.31,-1.63,6.43 +units=m +no_defs"</span>)</span>
<span id="cb64-568"><a href="#cb64-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-569"><a href="#cb64-569" aria-hidden="true" tabindex="-1"></a>kwangmyung_block_cell_sf <span class="ot">&lt;-</span> cell_block_sf <span class="sc">%&gt;%</span> </span>
<span id="cb64-570"><a href="#cb64-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CTY_CD =</span> <span class="fu">str_sub</span>(ADMI_CD, <span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-571"><a href="#cb64-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CTY_CD <span class="sc">==</span> <span class="st">"4121"</span>)</span>
<span id="cb64-572"><a href="#cb64-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-573"><a href="#cb64-573" aria-hidden="true" tabindex="-1"></a>kwangmyung_block_cell_sf <span class="sc">%&gt;%</span></span>
<span id="cb64-574"><a href="#cb64-574" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">write_sf</span>(<span class="st">"km_sf/kwangmyung_cell_block.shp"</span>)</span>
<span id="cb64-575"><a href="#cb64-575" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-576"><a href="#cb64-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-577"><a href="#cb64-577" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-578"><a href="#cb64-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-579"><a href="#cb64-579" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-580"><a href="#cb64-580" aria-hidden="true" tabindex="-1"></a>kwangmyung_block_cell_sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">read_sf</span>(<span class="st">"km_sf/kwangmyung_cell_block.shp"</span>)</span>
<span id="cb64-581"><a href="#cb64-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-582"><a href="#cb64-582" aria-hidden="true" tabindex="-1"></a>kwangmyung_block_cell_sf <span class="sc">%&gt;%</span> </span>
<span id="cb64-583"><a href="#cb64-583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(CTY_CD, geometry) <span class="sc">%&gt;%</span> </span>
<span id="cb64-584"><a href="#cb64-584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span>
<span id="cb64-585"><a href="#cb64-585" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-586"><a href="#cb64-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-587"><a href="#cb64-587" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/km/km_cell_block.png)</span></span>
<span id="cb64-588"><a href="#cb64-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-589"><a href="#cb64-589" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-590"><a href="#cb64-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-591"><a href="#cb64-591" aria-hidden="true" tabindex="-1"></a><span class="fu">## 행정동 결합</span></span>
<span id="cb64-592"><a href="#cb64-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-593"><a href="#cb64-593" aria-hidden="true" tabindex="-1"></a><span class="fu">### 시군구 행정동명</span></span>
<span id="cb64-594"><a href="#cb64-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-595"><a href="#cb64-595" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-596"><a href="#cb64-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-597"><a href="#cb64-597" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-598"><a href="#cb64-598" aria-hidden="true" tabindex="-1"></a>sgg_cd_tbl <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/(공통)셀블록도로행정동/경기도_시군구_행정동_명,CD.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-599"><a href="#cb64-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MEGA_NM =</span> <span class="fu">iconv</span>(MEGA_NM, <span class="st">"euc-kr"</span>, <span class="st">"utf-8"</span>),</span>
<span id="cb64-600"><a href="#cb64-600" aria-hidden="true" tabindex="-1"></a>         <span class="at">CTY_NM  =</span> <span class="fu">iconv</span>(CTY_NM, <span class="st">"euc-kr"</span>, <span class="st">"utf-8"</span>),</span>
<span id="cb64-601"><a href="#cb64-601" aria-hidden="true" tabindex="-1"></a>         <span class="at">ADMI_NM  =</span> <span class="fu">iconv</span>(ADMI_NM, <span class="st">"euc-kr"</span>, <span class="st">"utf-8"</span>))</span>
<span id="cb64-602"><a href="#cb64-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-603"><a href="#cb64-603" aria-hidden="true" tabindex="-1"></a>sgg_cd_tbl</span>
<span id="cb64-604"><a href="#cb64-604" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-605"><a href="#cb64-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-606"><a href="#cb64-606" aria-hidden="true" tabindex="-1"></a><span class="fu">### 셀코드</span></span>
<span id="cb64-607"><a href="#cb64-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-608"><a href="#cb64-608" aria-hidden="true" tabindex="-1"></a>시군구 행정동명에서 셀코드를 추출하는 방법을 기술한다.</span>
<span id="cb64-609"><a href="#cb64-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-610"><a href="#cb64-610" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-611"><a href="#cb64-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-612"><a href="#cb64-612" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-613"><a href="#cb64-613" aria-hidden="true" tabindex="-1"></a>cell_cd_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/(공통)셀블록도로행정동/셀(격자)/cell_gg_square_admi2_20210614.csv"</span>) </span>
<span id="cb64-614"><a href="#cb64-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-615"><a href="#cb64-615" aria-hidden="true" tabindex="-1"></a>get_city_cd <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">city_name =</span> <span class="st">"광명"</span>) {</span>
<span id="cb64-616"><a href="#cb64-616" aria-hidden="true" tabindex="-1"></a>  sgg_cd_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb64-617"><a href="#cb64-617" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">str_detect</span>(CTY_NM, city_name)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-618"><a href="#cb64-618" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(CTY_CD) <span class="sc">%&gt;%</span> </span>
<span id="cb64-619"><a href="#cb64-619" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unique</span>()</span>
<span id="cb64-620"><a href="#cb64-620" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-621"><a href="#cb64-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-622"><a href="#cb64-622" aria-hidden="true" tabindex="-1"></a>kwangmyung_cell <span class="ot">&lt;-</span> cell_cd_raw <span class="sc">%&gt;%</span> </span>
<span id="cb64-623"><a href="#cb64-623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CTY_CD <span class="sc">==</span> <span class="fu">get_city_cd</span>(<span class="st">"광명"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-624"><a href="#cb64-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(cell_id) <span class="sc">%&gt;%</span> </span>
<span id="cb64-625"><a href="#cb64-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>(.)</span>
<span id="cb64-626"><a href="#cb64-626" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-627"><a href="#cb64-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-628"><a href="#cb64-628" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb64-629"><a href="#cb64-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-630"><a href="#cb64-630" aria-hidden="true" tabindex="-1"></a><span class="fu">### 광명시 행정동 지도</span></span>
<span id="cb64-631"><a href="#cb64-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-632"><a href="#cb64-632" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-633"><a href="#cb64-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-634"><a href="#cb64-634" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-635"><a href="#cb64-635" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb64-636"><a href="#cb64-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-637"><a href="#cb64-637" aria-hidden="true" tabindex="-1"></a>gg_dong_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/(공통)셀블록도로행정동/행정동경계/행정동경계_경기도/행정동경계_경기도_좌표4326.shp"</span>)</span>
<span id="cb64-638"><a href="#cb64-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-639"><a href="#cb64-639" aria-hidden="true" tabindex="-1"></a>km_dong_sf <span class="ot">&lt;-</span> gg_dong_sf <span class="sc">%&gt;%</span> </span>
<span id="cb64-640"><a href="#cb64-640" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_sub</span>(ADMI_CD, <span class="dv">1</span>, <span class="dv">4</span>) <span class="sc">==</span> <span class="fu">get_city_cd</span>(<span class="st">"광명"</span>))</span>
<span id="cb64-641"><a href="#cb64-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-642"><a href="#cb64-642" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(km_dong_sf))</span>
<span id="cb64-643"><a href="#cb64-643" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-644"><a href="#cb64-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-645"><a href="#cb64-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-646"><a href="#cb64-646" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/km/km_adm_map.png)</span></span>
<span id="cb64-647"><a href="#cb64-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-648"><a href="#cb64-648" aria-hidden="true" tabindex="-1"></a><span class="fu">### 셀 지도</span></span>
<span id="cb64-649"><a href="#cb64-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-650"><a href="#cb64-650" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-651"><a href="#cb64-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-652"><a href="#cb64-652" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-653"><a href="#cb64-653" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb64-654"><a href="#cb64-654" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb64-655"><a href="#cb64-655" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgdal)</span>
<span id="cb64-656"><a href="#cb64-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-657"><a href="#cb64-657" aria-hidden="true" tabindex="-1"></a>gg_raw <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_read</span>(<span class="st">"data/(공통)셀블록도로행정동/셀(중심점)/cell_gg_admi2_20210616.shp"</span>)</span>
<span id="cb64-658"><a href="#cb64-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-659"><a href="#cb64-659" aria-hidden="true" tabindex="-1"></a><span class="do">## 좌표계 변환 KATEC --&gt; WGS84</span></span>
<span id="cb64-660"><a href="#cb64-660" aria-hidden="true" tabindex="-1"></a>km_sf <span class="ot">&lt;-</span> gg_raw <span class="sc">%&gt;%</span> </span>
<span id="cb64-661"><a href="#cb64-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CTY_CD <span class="sc">==</span> <span class="fu">get_city_cd</span>(<span class="st">"광명"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-662"><a href="#cb64-662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="st">"+proj=longlat +ellps=bessel +no_defs +towgs84=-115.80,474.99,674.11,1.16,-2.31,-1.63,6.43"</span>)</span>
<span id="cb64-663"><a href="#cb64-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-664"><a href="#cb64-664" aria-hidden="true" tabindex="-1"></a>km_sf <span class="sc">%&gt;%</span></span>
<span id="cb64-665"><a href="#cb64-665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_write</span>(<span class="st">"data/km_cell.geojson"</span>)</span>
<span id="cb64-666"><a href="#cb64-666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-667"><a href="#cb64-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-668"><a href="#cb64-668" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/km/km_adm_cell.png)</span></span>
<span id="cb64-669"><a href="#cb64-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-670"><a href="#cb64-670" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-671"><a href="#cb64-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-672"><a href="#cb64-672" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-673"><a href="#cb64-673" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb64-674"><a href="#cb64-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-675"><a href="#cb64-675" aria-hidden="true" tabindex="-1"></a>km_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/km_cell.geojson"</span>)</span>
<span id="cb64-676"><a href="#cb64-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-677"><a href="#cb64-677" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(km_sf))</span>
<span id="cb64-678"><a href="#cb64-678" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-679"><a href="#cb64-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-680"><a href="#cb64-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-681"><a href="#cb64-681" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-682"><a href="#cb64-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-683"><a href="#cb64-683" aria-hidden="true" tabindex="-1"></a><span class="fu">## 국가공간정보포털</span></span>
<span id="cb64-684"><a href="#cb64-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-685"><a href="#cb64-685" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">국가공간정보포털</span><span class="co">](http://data.nsdi.go.kr/dataset/20171206ds00001)</span> (센서스경계)행정동경계 파일을 다운로드 받아 이를 점검해보자.</span>
<span id="cb64-686"><a href="#cb64-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-687"><a href="#cb64-687" aria-hidden="true" tabindex="-1"></a>[<span class="co">[</span><span class="ot">한국 주요 좌표계 EPSG코드 및 proj4 인자 정리</span><span class="co">](https://hongun7.tistory.com/6)</span>]{.aside}</span>
<span id="cb64-688"><a href="#cb64-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-689"><a href="#cb64-689" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *Bessel 1841 경위도: 한국과 일본에 잘 맞는 지역타원체를 사용한 좌표계</span></span>
<span id="cb64-690"><a href="#cb64-690" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; EPSG:4004, EPSG:4162 (Korean 1985)</span></span>
<span id="cb64-691"><a href="#cb64-691" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; +proj=longlat +ellps=bessel +no_defs +towgs84=-115.80,474.99,674.11,1.16,-2.31,-1.63,6.43</span></span>
<span id="cb64-692"><a href="#cb64-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-693"><a href="#cb64-693" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb64-694"><a href="#cb64-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-695"><a href="#cb64-695" aria-hidden="true" tabindex="-1"></a><span class="fu">### 매칭</span></span>
<span id="cb64-696"><a href="#cb64-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-697"><a href="#cb64-697" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-698"><a href="#cb64-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-699"><a href="#cb64-699" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-700"><a href="#cb64-700" aria-hidden="true" tabindex="-1"></a>nsdi_sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_read</span>(<span class="st">"data/kosis_map/Z_SOP_BND_ADM_DONG_PG.shp"</span>)</span>
<span id="cb64-701"><a href="#cb64-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-702"><a href="#cb64-702" aria-hidden="true" tabindex="-1"></a>nsdi_sf <span class="ot">&lt;-</span> nsdi_sf <span class="sc">%&gt;%</span> </span>
<span id="cb64-703"><a href="#cb64-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="st">"+proj=longlat +ellps=WGS84 +datum=WGS84 +n8o_defs"</span>)</span>
<span id="cb64-704"><a href="#cb64-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-705"><a href="#cb64-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-706"><a href="#cb64-706" aria-hidden="true" tabindex="-1"></a>km_nsdi_sf <span class="ot">&lt;-</span> nsdi_sf <span class="sc">%&gt;%</span> </span>
<span id="cb64-707"><a href="#cb64-707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CTY_CD =</span> <span class="fu">str_sub</span>(ADM_CD, <span class="dv">1</span>, <span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-708"><a href="#cb64-708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CTY_CD <span class="sc">==</span> <span class="dv">31060</span>)</span>
<span id="cb64-709"><a href="#cb64-709" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-710"><a href="#cb64-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-711"><a href="#cb64-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-712"><a href="#cb64-712" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-713"><a href="#cb64-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-714"><a href="#cb64-714" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-715"><a href="#cb64-715" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-716"><a href="#cb64-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> km_sf, <span class="fu">aes</span>(<span class="at">geometry =</span> geometry),</span>
<span id="cb64-717"><a href="#cb64-717" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  </span>
<span id="cb64-718"><a href="#cb64-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> km_nsdi_sf, <span class="fu">aes</span>(<span class="at">geometry =</span> geometry),</span>
<span id="cb64-719"><a href="#cb64-719" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="dv">0</span>)</span>
<span id="cb64-720"><a href="#cb64-720" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-721"><a href="#cb64-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-722"><a href="#cb64-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-723"><a href="#cb64-723" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/km/km_adm_cell_map.png)</span></span>
<span id="cb64-724"><a href="#cb64-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-725"><a href="#cb64-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-726"><a href="#cb64-726" aria-hidden="true" tabindex="-1"></a><span class="fu">### 광명시 행정동</span></span>
<span id="cb64-727"><a href="#cb64-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-728"><a href="#cb64-728" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-729"><a href="#cb64-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-730"><a href="#cb64-730" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-731"><a href="#cb64-731" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb64-732"><a href="#cb64-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-733"><a href="#cb64-733" aria-hidden="true" tabindex="-1"></a>km_dong_sf <span class="ot">&lt;-</span> gg_dong_sf <span class="sc">%&gt;%</span> </span>
<span id="cb64-734"><a href="#cb64-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_sub</span>(ADMI_CD, <span class="dv">1</span>, <span class="dv">4</span>) <span class="sc">==</span> <span class="fu">get_city_cd</span>(<span class="st">"광명"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-735"><a href="#cb64-735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(행정동 <span class="ot">=</span> <span class="fu">str_sub</span>(ADMI_CD, <span class="dv">1</span>, <span class="dv">7</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-736"><a href="#cb64-736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(행정동) <span class="sc">%&gt;%</span> </span>
<span id="cb64-737"><a href="#cb64-737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">geometry =</span> <span class="fu">st_union</span>(geometry)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-738"><a href="#cb64-738" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="st">"+proj=longlat +ellps=bessel +no_defs +towgs84=-115.80,474.99,674.11,1.16,-2.31,-1.63,6.43"</span>)</span>
<span id="cb64-739"><a href="#cb64-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-740"><a href="#cb64-740" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(km_dong_sf))</span>
<span id="cb64-741"><a href="#cb64-741" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-742"><a href="#cb64-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-743"><a href="#cb64-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-744"><a href="#cb64-744" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/km/km_adm_dong.png)</span></span>
<span id="cb64-745"><a href="#cb64-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-746"><a href="#cb64-746" aria-hidden="true" tabindex="-1"></a><span class="fu">### 결합</span></span>
<span id="cb64-747"><a href="#cb64-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-748"><a href="#cb64-748" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-749"><a href="#cb64-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-750"><a href="#cb64-750" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-751"><a href="#cb64-751" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-752"><a href="#cb64-752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> km_sf, <span class="fu">aes</span>(<span class="at">geometry =</span> geometry),</span>
<span id="cb64-753"><a href="#cb64-753" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  </span>
<span id="cb64-754"><a href="#cb64-754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> km_dong_sf, <span class="fu">aes</span>(<span class="at">geometry =</span> geometry),</span>
<span id="cb64-755"><a href="#cb64-755" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="dv">0</span>)</span>
<span id="cb64-756"><a href="#cb64-756" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-757"><a href="#cb64-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-758"><a href="#cb64-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-759"><a href="#cb64-759" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/km/km_adm_dong_cell.png)</span></span>
<span id="cb64-760"><a href="#cb64-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-761"><a href="#cb64-761" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-762"><a href="#cb64-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-763"><a href="#cb64-763" aria-hidden="true" tabindex="-1"></a><span class="fu">## 광명시 유동인구</span></span>
<span id="cb64-764"><a href="#cb64-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-765"><a href="#cb64-765" aria-hidden="true" tabindex="-1"></a><span class="fu">### 데이터셋</span></span>
<span id="cb64-766"><a href="#cb64-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-767"><a href="#cb64-767" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 2017년 6월 (Script)</span></span>
<span id="cb64-768"><a href="#cb64-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-769"><a href="#cb64-769" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-770"><a href="#cb64-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-771"><a href="#cb64-771" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-772"><a href="#cb64-772" aria-hidden="true" tabindex="-1"></a>extrafont<span class="sc">::</span><span class="fu">loadfonts</span>()</span>
<span id="cb64-773"><a href="#cb64-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-774"><a href="#cb64-774" aria-hidden="true" tabindex="-1"></a>kt_cell_files <span class="ot">&lt;-</span> fs<span class="sc">::</span><span class="fu">dir_ls</span>(<span class="st">"data/KT유동인구데이터/셀단위/sex_age/"</span>)</span>
<span id="cb64-775"><a href="#cb64-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-776"><a href="#cb64-776" aria-hidden="true" tabindex="-1"></a>sex_age_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/KT유동인구데이터/셀단위/sex_age/sex_age_201706.csv"</span>)</span>
<span id="cb64-777"><a href="#cb64-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-778"><a href="#cb64-778" aria-hidden="true" tabindex="-1"></a>km_sex_age <span class="ot">&lt;-</span> sex_age_raw <span class="sc">%&gt;%</span> </span>
<span id="cb64-779"><a href="#cb64-779" aria-hidden="true" tabindex="-1"></a>    <span class="do">## 광명시만 추출</span></span>
<span id="cb64-780"><a href="#cb64-780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cell_id <span class="sc">%in%</span> <span class="fu">unique</span>(km_cell_sf<span class="sc">$</span>cell_id)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-781"><a href="#cb64-781" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 자료구조 변환</span></span>
<span id="cb64-782"><a href="#cb64-782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> M00_09<span class="sc">:</span>F60_up, <span class="at">names_to =</span> <span class="st">"name"</span>, <span class="at">values_to =</span> <span class="st">"인구수"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-783"><a href="#cb64-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(성별 <span class="ot">=</span> <span class="fu">str_sub</span>(name, <span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb64-784"><a href="#cb64-784" aria-hidden="true" tabindex="-1"></a>         연령대 <span class="ot">=</span> <span class="fu">str_sub</span>(name, <span class="dv">2</span>, <span class="dv">6</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-785"><a href="#cb64-785" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 자료형 변환</span></span>
<span id="cb64-786"><a href="#cb64-786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(연령대 <span class="ot">=</span> <span class="fu">factor</span>(연령대, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"00_09"</span>, <span class="st">"10_19"</span>, <span class="st">"20_29"</span>, <span class="st">"30_39"</span>, <span class="st">"40_49"</span>, <span class="st">"50_59"</span>, <span class="st">"60_up"</span>)),</span>
<span id="cb64-787"><a href="#cb64-787" aria-hidden="true" tabindex="-1"></a>         성별 <span class="ot">=</span> <span class="fu">factor</span>(성별, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"F"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"남성"</span>, <span class="st">"여성"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb64-788"><a href="#cb64-788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>name)</span>
<span id="cb64-789"><a href="#cb64-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-790"><a href="#cb64-790" aria-hidden="true" tabindex="-1"></a>km_grid_tbl <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(grid_map) <span class="sc">%&gt;%</span> </span>
<span id="cb64-791"><a href="#cb64-791" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb64-792"><a href="#cb64-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-793"><a href="#cb64-793" aria-hidden="true" tabindex="-1"></a>km_tbl <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(km_map) <span class="sc">%&gt;%</span> </span>
<span id="cb64-794"><a href="#cb64-794" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb64-795"><a href="#cb64-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-796"><a href="#cb64-796" aria-hidden="true" tabindex="-1"></a>km_dong_tbl <span class="ot">&lt;-</span> <span class="fu">left_join</span>(km_grid_tbl, km_tbl, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"MEGA_CD"</span>, <span class="st">"ADMI_CD"</span>))</span>
<span id="cb64-797"><a href="#cb64-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-798"><a href="#cb64-798" aria-hidden="true" tabindex="-1"></a>km_sex_age_tbl <span class="ot">&lt;-</span> km_sex_age <span class="sc">%&gt;%</span> </span>
<span id="cb64-799"><a href="#cb64-799" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(km_dong_tbl)</span>
<span id="cb64-800"><a href="#cb64-800" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-801"><a href="#cb64-801" aria-hidden="true" tabindex="-1"></a>km_sex_age_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb64-802"><a href="#cb64-802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(etl_ym, ADMI_NM) <span class="sc">%&gt;%</span> </span>
<span id="cb64-803"><a href="#cb64-803" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(인구수 <span class="ot">=</span> <span class="fu">sum</span>(인구수))</span>
<span id="cb64-804"><a href="#cb64-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-805"><a href="#cb64-805" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-806"><a href="#cb64-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-807"><a href="#cb64-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-808"><a href="#cb64-808" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 2017년 6월 (함수)</span></span>
<span id="cb64-809"><a href="#cb64-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-810"><a href="#cb64-810" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-811"><a href="#cb64-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-812"><a href="#cb64-812" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-813"><a href="#cb64-813" aria-hidden="true" tabindex="-1"></a><span class="do">## MEGA_CD, ADMI_CD, cell_id 결합</span></span>
<span id="cb64-814"><a href="#cb64-814" aria-hidden="true" tabindex="-1"></a>km_grid_tbl <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(grid_map) <span class="sc">%&gt;%</span> </span>
<span id="cb64-815"><a href="#cb64-815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb64-816"><a href="#cb64-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-817"><a href="#cb64-817" aria-hidden="true" tabindex="-1"></a>km_tbl <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(km_map) <span class="sc">%&gt;%</span> </span>
<span id="cb64-818"><a href="#cb64-818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb64-819"><a href="#cb64-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-820"><a href="#cb64-820" aria-hidden="true" tabindex="-1"></a>km_dong_tbl <span class="ot">&lt;-</span> <span class="fu">left_join</span>(km_grid_tbl, km_tbl, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"MEGA_CD"</span>, <span class="st">"ADMI_CD"</span>))</span>
<span id="cb64-821"><a href="#cb64-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-822"><a href="#cb64-822" aria-hidden="true" tabindex="-1"></a><span class="do">## 광명시 </span></span>
<span id="cb64-823"><a href="#cb64-823" aria-hidden="true" tabindex="-1"></a>get_km_sex_age <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">yearmon=</span><span class="st">"data/KT유동인구데이터/셀단위/sex_age/sex_age_201706.csv"</span>) {</span>
<span id="cb64-824"><a href="#cb64-824" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-825"><a href="#cb64-825" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> ------------------</span><span class="sc">\n</span><span class="st">"</span>, yearmon, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb64-826"><a href="#cb64-826" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-827"><a href="#cb64-827" aria-hidden="true" tabindex="-1"></a>  sex_age_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(yearmon)</span>
<span id="cb64-828"><a href="#cb64-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-829"><a href="#cb64-829" aria-hidden="true" tabindex="-1"></a>  km_sex_age <span class="ot">&lt;-</span> sex_age_raw <span class="sc">%&gt;%</span> </span>
<span id="cb64-830"><a href="#cb64-830" aria-hidden="true" tabindex="-1"></a>      <span class="do">## 광명시만 추출</span></span>
<span id="cb64-831"><a href="#cb64-831" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(cell_id <span class="sc">%in%</span> <span class="fu">unique</span>(km_cell_sf<span class="sc">$</span>cell_id)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-832"><a href="#cb64-832" aria-hidden="true" tabindex="-1"></a>    <span class="do">## 자료구조 변환</span></span>
<span id="cb64-833"><a href="#cb64-833" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> M00_09<span class="sc">:</span>F60_up, <span class="at">names_to =</span> <span class="st">"name"</span>, <span class="at">values_to =</span> <span class="st">"인구수"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-834"><a href="#cb64-834" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(성별 <span class="ot">=</span> <span class="fu">str_sub</span>(name, <span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb64-835"><a href="#cb64-835" aria-hidden="true" tabindex="-1"></a>           연령대 <span class="ot">=</span> <span class="fu">str_sub</span>(name, <span class="dv">2</span>, <span class="dv">6</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-836"><a href="#cb64-836" aria-hidden="true" tabindex="-1"></a>    <span class="do">## 자료형 변환</span></span>
<span id="cb64-837"><a href="#cb64-837" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(연령대 <span class="ot">=</span> <span class="fu">factor</span>(연령대, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"00_09"</span>, <span class="st">"10_19"</span>, <span class="st">"20_29"</span>, <span class="st">"30_39"</span>, <span class="st">"40_49"</span>, <span class="st">"50_59"</span>, <span class="st">"60_up"</span>)),</span>
<span id="cb64-838"><a href="#cb64-838" aria-hidden="true" tabindex="-1"></a>           성별 <span class="ot">=</span> <span class="fu">factor</span>(성별, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"F"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"남성"</span>, <span class="st">"여성"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb64-839"><a href="#cb64-839" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>name)</span>
<span id="cb64-840"><a href="#cb64-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-841"><a href="#cb64-841" aria-hidden="true" tabindex="-1"></a>  km_sex_age_tbl <span class="ot">&lt;-</span> km_sex_age <span class="sc">%&gt;%</span> </span>
<span id="cb64-842"><a href="#cb64-842" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(km_dong_tbl)</span>
<span id="cb64-843"><a href="#cb64-843" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-844"><a href="#cb64-844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(km_sex_age_tbl)</span>
<span id="cb64-845"><a href="#cb64-845" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-846"><a href="#cb64-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-847"><a href="#cb64-847" aria-hidden="true" tabindex="-1"></a><span class="fu">get_km_sex_age</span>()</span>
<span id="cb64-848"><a href="#cb64-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-849"><a href="#cb64-849" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-850"><a href="#cb64-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-851"><a href="#cb64-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-852"><a href="#cb64-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-853"><a href="#cb64-853" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 2018~2022년</span></span>
<span id="cb64-854"><a href="#cb64-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-855"><a href="#cb64-855" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-856"><a href="#cb64-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-857"><a href="#cb64-857" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-858"><a href="#cb64-858" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb64-859"><a href="#cb64-859" aria-hidden="true" tabindex="-1"></a>kt_cell_files_raw <span class="ot">&lt;-</span> fs<span class="sc">::</span><span class="fu">dir_ls</span>(<span class="st">"data/KT유동인구데이터/셀단위/sex_age/"</span>)</span>
<span id="cb64-860"><a href="#cb64-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-861"><a href="#cb64-861" aria-hidden="true" tabindex="-1"></a>kt_cell_files <span class="ot">&lt;-</span> kt_cell_files_raw <span class="sc">%&gt;%</span> </span>
<span id="cb64-862"><a href="#cb64-862" aria-hidden="true" tabindex="-1"></a>  <span class="fu">enframe</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-863"><a href="#cb64-863" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 2018~2022년만 추출</span></span>
<span id="cb64-864"><a href="#cb64-864" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(년월 <span class="ot">=</span> <span class="fu">str_sub</span>(<span class="fu">str_extract</span>(name, <span class="st">"</span><span class="sc">\\</span><span class="st">d+"</span>), <span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-865"><a href="#cb64-865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>년월 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"2017"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-866"><a href="#cb64-866" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 2018~2022년만 추출</span></span>
<span id="cb64-867"><a href="#cb64-867" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(년월 <span class="ot">=</span> <span class="fu">str_sub</span>(<span class="fu">str_extract</span>(name, <span class="st">"</span><span class="sc">\\</span><span class="st">d+"</span>), <span class="dv">1</span>, <span class="dv">6</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-868"><a href="#cb64-868" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(년월 <span class="ot">=</span> lubridate<span class="sc">::</span><span class="fu">ym</span>(년월))</span>
<span id="cb64-869"><a href="#cb64-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-870"><a href="#cb64-870" aria-hidden="true" tabindex="-1"></a>km_age_sex_yearmon <span class="ot">&lt;-</span> kt_cell_files  <span class="sc">%&gt;%</span> </span>
<span id="cb64-871"><a href="#cb64-871" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(name, get_km_sex_age))</span>
<span id="cb64-872"><a href="#cb64-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-873"><a href="#cb64-873" aria-hidden="true" tabindex="-1"></a>km_age_sex_yearmon <span class="sc">%&gt;%</span> </span>
<span id="cb64-874"><a href="#cb64-874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_rds</span>(<span class="st">"data/km_age_sex_yearmon.rds"</span>)</span>
<span id="cb64-875"><a href="#cb64-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-876"><a href="#cb64-876" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-877"><a href="#cb64-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-878"><a href="#cb64-878" aria-hidden="true" tabindex="-1"></a><span class="fu">## 분석</span></span>
<span id="cb64-879"><a href="#cb64-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-880"><a href="#cb64-880" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb64-881"><a href="#cb64-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-882"><a href="#cb64-882" aria-hidden="true" tabindex="-1"></a><span class="fu">### 추세</span></span>
<span id="cb64-883"><a href="#cb64-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-884"><a href="#cb64-884" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-885"><a href="#cb64-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-886"><a href="#cb64-886" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-887"><a href="#cb64-887" aria-hidden="true" tabindex="-1"></a>extrafont<span class="sc">::</span><span class="fu">loadfonts</span>()</span>
<span id="cb64-888"><a href="#cb64-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-889"><a href="#cb64-889" aria-hidden="true" tabindex="-1"></a>km_age_sex_yearmon <span class="ot">&lt;-</span> </span>
<span id="cb64-890"><a href="#cb64-890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_rds</span>(<span class="st">"data/km_age_sex_yearmon.rds"</span>)</span>
<span id="cb64-891"><a href="#cb64-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-892"><a href="#cb64-892" aria-hidden="true" tabindex="-1"></a>km_age_sex_yearmon_tbl <span class="ot">&lt;-</span> km_age_sex_yearmon <span class="sc">%&gt;%</span> </span>
<span id="cb64-893"><a href="#cb64-893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span> </span>
<span id="cb64-894"><a href="#cb64-894" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(년월 <span class="ot">=</span> lubridate<span class="sc">::</span><span class="fu">ym</span>(etl_ym))</span>
<span id="cb64-895"><a href="#cb64-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-896"><a href="#cb64-896" aria-hidden="true" tabindex="-1"></a>km_year_mon_total <span class="ot">&lt;-</span> km_age_sex_yearmon_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb64-897"><a href="#cb64-897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(년월) <span class="sc">%&gt;%</span> </span>
<span id="cb64-898"><a href="#cb64-898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(인구수 <span class="ot">=</span> <span class="fu">sum</span>(인구수))</span>
<span id="cb64-899"><a href="#cb64-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-900"><a href="#cb64-900" aria-hidden="true" tabindex="-1"></a>km_year_mon_total_gg <span class="ot">&lt;-</span> km_year_mon_total <span class="sc">%&gt;%</span> </span>
<span id="cb64-901"><a href="#cb64-901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(인구수 <span class="ot">=</span> 인구수 <span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-902"><a href="#cb64-902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>년월, <span class="at">y=</span>인구수)) <span class="sc">+</span></span>
<span id="cb64-903"><a href="#cb64-903" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb64-904"><a href="#cb64-904" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb64-905"><a href="#cb64-905" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_family =</span> <span class="st">"Malgun Gothic"</span>) <span class="sc">+</span></span>
<span id="cb64-906"><a href="#cb64-906" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"광명시 월별 유동인구"</span>,</span>
<span id="cb64-907"><a href="#cb64-907" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"2018년 1월 ~ 2022년 12월"</span>,</span>
<span id="cb64-908"><a href="#cb64-908" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb64-909"><a href="#cb64-909" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"유동인구(만명)"</span>,</span>
<span id="cb64-910"><a href="#cb64-910" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"데이터 출처: KT 유동인구 데이터(경기도 데이터분석센터"</span>) <span class="sc">+</span></span>
<span id="cb64-911"><a href="#cb64-911" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma)</span>
<span id="cb64-912"><a href="#cb64-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-913"><a href="#cb64-913" aria-hidden="true" tabindex="-1"></a>km_year_mon_total_gg</span>
<span id="cb64-914"><a href="#cb64-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-915"><a href="#cb64-915" aria-hidden="true" tabindex="-1"></a>fs<span class="sc">::</span><span class="fu">dir_create</span>(<span class="st">"images/KT"</span>)</span>
<span id="cb64-916"><a href="#cb64-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-917"><a href="#cb64-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-918"><a href="#cb64-918" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_png</span>(<span class="st">"images/KT/광명시_월별_유동인구.png"</span>, </span>
<span id="cb64-919"><a href="#cb64-919" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-920"><a href="#cb64-920" aria-hidden="true" tabindex="-1"></a>km_year_mon_total_gg</span>
<span id="cb64-921"><a href="#cb64-921" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-922"><a href="#cb64-922" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-923"><a href="#cb64-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-924"><a href="#cb64-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-925"><a href="#cb64-925" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/km/광명시_월별_유동인구.png)</span></span>
<span id="cb64-926"><a href="#cb64-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-927"><a href="#cb64-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-928"><a href="#cb64-928" aria-hidden="true" tabindex="-1"></a><span class="fu">### 행정동별</span></span>
<span id="cb64-929"><a href="#cb64-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-930"><a href="#cb64-930" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-931"><a href="#cb64-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-932"><a href="#cb64-932" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-933"><a href="#cb64-933" aria-hidden="true" tabindex="-1"></a>km_year_mon_total_dong <span class="ot">&lt;-</span> km_age_sex_yearmon_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb64-934"><a href="#cb64-934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(년월, ADMI_NM) <span class="sc">%&gt;%</span> </span>
<span id="cb64-935"><a href="#cb64-935" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(인구수 <span class="ot">=</span> <span class="fu">sum</span>(인구수))</span>
<span id="cb64-936"><a href="#cb64-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-937"><a href="#cb64-937" aria-hidden="true" tabindex="-1"></a>km_year_mon_total_dong_gg <span class="ot">&lt;-</span> km_year_mon_total_dong <span class="sc">%&gt;%</span> </span>
<span id="cb64-938"><a href="#cb64-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(인구수 <span class="ot">=</span> 인구수 <span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-939"><a href="#cb64-939" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>년월, <span class="at">y=</span>인구수)) <span class="sc">+</span></span>
<span id="cb64-940"><a href="#cb64-940" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb64-941"><a href="#cb64-941" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb64-942"><a href="#cb64-942" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_family =</span> <span class="st">"Malgun Gothic"</span>) <span class="sc">+</span></span>
<span id="cb64-943"><a href="#cb64-943" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"광명시 동별 유동인구"</span>,</span>
<span id="cb64-944"><a href="#cb64-944" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"2018년 1월 ~ 2022년 12월"</span>,</span>
<span id="cb64-945"><a href="#cb64-945" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb64-946"><a href="#cb64-946" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"유동인구(만명)"</span>,</span>
<span id="cb64-947"><a href="#cb64-947" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"데이터 출처: KT 유동인구 데이터(경기도 데이터분석센터"</span>) <span class="sc">+</span></span>
<span id="cb64-948"><a href="#cb64-948" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb64-949"><a href="#cb64-949" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>ADMI_NM)</span>
<span id="cb64-950"><a href="#cb64-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-951"><a href="#cb64-951" aria-hidden="true" tabindex="-1"></a>km_year_mon_total_dong_gg</span>
<span id="cb64-952"><a href="#cb64-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-953"><a href="#cb64-953" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_png</span>(<span class="st">"images/KT/광명시_월별_동별_유동인구.png"</span>, </span>
<span id="cb64-954"><a href="#cb64-954" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-955"><a href="#cb64-955" aria-hidden="true" tabindex="-1"></a>km_year_mon_total_dong_gg</span>
<span id="cb64-956"><a href="#cb64-956" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-957"><a href="#cb64-957" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-958"><a href="#cb64-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-959"><a href="#cb64-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-960"><a href="#cb64-960" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/km/광명시_월별_동별_유동인구.png)</span></span>
<span id="cb64-961"><a href="#cb64-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-962"><a href="#cb64-962" aria-hidden="true" tabindex="-1"></a><span class="fu">### 성별</span></span>
<span id="cb64-963"><a href="#cb64-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-964"><a href="#cb64-964" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-965"><a href="#cb64-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-966"><a href="#cb64-966" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-967"><a href="#cb64-967" aria-hidden="true" tabindex="-1"></a>km_year_mon_total_dong_sex <span class="ot">&lt;-</span> km_age_sex_yearmon_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb64-968"><a href="#cb64-968" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(년월, ADMI_NM, 성별) <span class="sc">%&gt;%</span> </span>
<span id="cb64-969"><a href="#cb64-969" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(인구수 <span class="ot">=</span> <span class="fu">sum</span>(인구수))</span>
<span id="cb64-970"><a href="#cb64-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-971"><a href="#cb64-971" aria-hidden="true" tabindex="-1"></a>km_year_mon_total_dong_sex_gg <span class="ot">&lt;-</span> km_year_mon_total_dong_sex <span class="sc">%&gt;%</span> </span>
<span id="cb64-972"><a href="#cb64-972" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(인구수 <span class="ot">=</span> 인구수 <span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-973"><a href="#cb64-973" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>년월, <span class="at">y=</span>인구수, <span class="at">color =</span> 성별)) <span class="sc">+</span></span>
<span id="cb64-974"><a href="#cb64-974" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb64-975"><a href="#cb64-975" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb64-976"><a href="#cb64-976" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_family =</span> <span class="st">"Malgun Gothic"</span>) <span class="sc">+</span></span>
<span id="cb64-977"><a href="#cb64-977" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"광명시 동별 유동인구"</span>,</span>
<span id="cb64-978"><a href="#cb64-978" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"2018년 1월 ~ 2022년 12월"</span>,</span>
<span id="cb64-979"><a href="#cb64-979" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb64-980"><a href="#cb64-980" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"유동인구(만명)"</span>,</span>
<span id="cb64-981"><a href="#cb64-981" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"데이터 출처: KT 유동인구 데이터(경기도 데이터분석센터"</span>) <span class="sc">+</span></span>
<span id="cb64-982"><a href="#cb64-982" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb64-983"><a href="#cb64-983" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>ADMI_NM) <span class="sc">+</span></span>
<span id="cb64-984"><a href="#cb64-984" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"남성"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"여성"</span> <span class="ot">=</span> <span class="st">"black"</span>))</span>
<span id="cb64-985"><a href="#cb64-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-986"><a href="#cb64-986" aria-hidden="true" tabindex="-1"></a>km_year_mon_total_dong_sex_gg</span>
<span id="cb64-987"><a href="#cb64-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-988"><a href="#cb64-988" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_png</span>(<span class="st">"images/KT/광명시_월별_동별_성별_유동인구.png"</span>, </span>
<span id="cb64-989"><a href="#cb64-989" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-990"><a href="#cb64-990" aria-hidden="true" tabindex="-1"></a>km_year_mon_total_dong_sex_gg</span>
<span id="cb64-991"><a href="#cb64-991" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-992"><a href="#cb64-992" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-993"><a href="#cb64-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-994"><a href="#cb64-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-995"><a href="#cb64-995" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/km/광명시_월별_동별_성별_유동인구.png)</span></span>
<span id="cb64-996"><a href="#cb64-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-997"><a href="#cb64-997" aria-hidden="true" tabindex="-1"></a><span class="fu">### 연령대별</span></span>
<span id="cb64-998"><a href="#cb64-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-999"><a href="#cb64-999" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-1000"><a href="#cb64-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1001"><a href="#cb64-1001" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-1002"><a href="#cb64-1002" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb64-1003"><a href="#cb64-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1004"><a href="#cb64-1004" aria-hidden="true" tabindex="-1"></a>km_year_mon_total_dong_age <span class="ot">&lt;-</span> km_age_sex_yearmon_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb64-1005"><a href="#cb64-1005" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(세대별 <span class="ot">=</span> <span class="fu">case_when</span>(연령대 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"00_09"</span>, <span class="st">"10_19"</span>) <span class="sc">~</span> <span class="st">"00~19"</span>,</span>
<span id="cb64-1006"><a href="#cb64-1006" aria-hidden="true" tabindex="-1"></a>                            연령대 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"20_29"</span>) <span class="sc">~</span> <span class="st">"20~29"</span>,</span>
<span id="cb64-1007"><a href="#cb64-1007" aria-hidden="true" tabindex="-1"></a>                            연령대 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"30_39"</span>, <span class="st">"40_49"</span>) <span class="sc">~</span> <span class="st">"30~49"</span>,</span>
<span id="cb64-1008"><a href="#cb64-1008" aria-hidden="true" tabindex="-1"></a>                            연령대 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"50_59"</span>) <span class="sc">~</span> <span class="st">"50~59"</span>,</span>
<span id="cb64-1009"><a href="#cb64-1009" aria-hidden="true" tabindex="-1"></a>                            연령대 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"60_up"</span>) <span class="sc">~</span> <span class="st">"60~이상"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-1010"><a href="#cb64-1010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(년월, ADMI_NM, 세대별) <span class="sc">%&gt;%</span> </span>
<span id="cb64-1011"><a href="#cb64-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(인구수 <span class="ot">=</span> <span class="fu">sum</span>(인구수))</span>
<span id="cb64-1012"><a href="#cb64-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1013"><a href="#cb64-1013" aria-hidden="true" tabindex="-1"></a>km_year_mon_total_dong_age_gg <span class="ot">&lt;-</span> km_year_mon_total_dong_age <span class="sc">%&gt;%</span> </span>
<span id="cb64-1014"><a href="#cb64-1014" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(인구수 <span class="ot">=</span> 인구수 <span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-1015"><a href="#cb64-1015" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>년월, <span class="at">y=</span>인구수, <span class="at">color =</span> 세대별)) <span class="sc">+</span></span>
<span id="cb64-1016"><a href="#cb64-1016" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb64-1017"><a href="#cb64-1017" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb64-1018"><a href="#cb64-1018" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Malgun Gothic"</span>) <span class="sc">+</span></span>
<span id="cb64-1019"><a href="#cb64-1019" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"광명시 세대별 유동인구"</span>,</span>
<span id="cb64-1020"><a href="#cb64-1020" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"2018년 1월 ~ 2022년 12월"</span>,</span>
<span id="cb64-1021"><a href="#cb64-1021" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb64-1022"><a href="#cb64-1022" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"유동인구(만명)"</span>,</span>
<span id="cb64-1023"><a href="#cb64-1023" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"데이터 출처: KT 유동인구 데이터(경기도 데이터분석센터"</span>) <span class="sc">+</span></span>
<span id="cb64-1024"><a href="#cb64-1024" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb64-1025"><a href="#cb64-1025" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>ADMI_NM) </span>
<span id="cb64-1026"><a href="#cb64-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1027"><a href="#cb64-1027" aria-hidden="true" tabindex="-1"></a>km_year_mon_total_dong_age_gg</span>
<span id="cb64-1028"><a href="#cb64-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1029"><a href="#cb64-1029" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_png</span>(<span class="st">"images/KT/광명시_월별_동별_세대별_유동인구.png"</span>, </span>
<span id="cb64-1030"><a href="#cb64-1030" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-1031"><a href="#cb64-1031" aria-hidden="true" tabindex="-1"></a>km_year_mon_total_dong_age_gg</span>
<span id="cb64-1032"><a href="#cb64-1032" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-1033"><a href="#cb64-1033" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1034"><a href="#cb64-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1035"><a href="#cb64-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1036"><a href="#cb64-1036" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/km/광명시_월별_동별_세대별_유동인구.png)</span></span>
<span id="cb64-1037"><a href="#cb64-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1038"><a href="#cb64-1038" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-1039"><a href="#cb64-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1040"><a href="#cb64-1040" aria-hidden="true" tabindex="-1"></a><span class="fu">## 소하2동</span></span>
<span id="cb64-1041"><a href="#cb64-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1042"><a href="#cb64-1042" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-1043"><a href="#cb64-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1044"><a href="#cb64-1044" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-1045"><a href="#cb64-1045" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(classInt)</span>
<span id="cb64-1046"><a href="#cb64-1046" aria-hidden="true" tabindex="-1"></a>extrafont<span class="sc">::</span><span class="fu">loadfonts</span>()</span>
<span id="cb64-1047"><a href="#cb64-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1048"><a href="#cb64-1048" aria-hidden="true" tabindex="-1"></a>km_dong_raw <span class="ot">&lt;-</span> km_age_sex_yearmon_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb64-1049"><a href="#cb64-1049" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ADMI_NM <span class="sc">==</span> <span class="st">"소하2동"</span>)</span>
<span id="cb64-1050"><a href="#cb64-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1051"><a href="#cb64-1051" aria-hidden="true" tabindex="-1"></a>km_dong_tbl <span class="ot">&lt;-</span> km_dong_raw <span class="sc">%&gt;%</span> </span>
<span id="cb64-1052"><a href="#cb64-1052" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(년도 <span class="ot">=</span> <span class="fu">year</span>(년월)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-1053"><a href="#cb64-1053" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cell_id,  x_axis, y_axis, 년도) <span class="sc">%&gt;%</span> </span>
<span id="cb64-1054"><a href="#cb64-1054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(인구수 <span class="ot">=</span> <span class="fu">sum</span>(인구수) <span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-1055"><a href="#cb64-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span>
<span id="cb64-1056"><a href="#cb64-1056" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-1057"><a href="#cb64-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1058"><a href="#cb64-1058" aria-hidden="true" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> classInt<span class="sc">::</span><span class="fu">classIntervals</span>(</span>
<span id="cb64-1059"><a href="#cb64-1059" aria-hidden="true" tabindex="-1"></a>    km_dong_tbl<span class="sc">$</span>인구수,</span>
<span id="cb64-1060"><a href="#cb64-1060" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb64-1061"><a href="#cb64-1061" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"fisher"</span></span>
<span id="cb64-1062"><a href="#cb64-1062" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>brks</span>
<span id="cb64-1063"><a href="#cb64-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1064"><a href="#cb64-1064" aria-hidden="true" tabindex="-1"></a>vmin <span class="ot">&lt;-</span> <span class="fu">min</span>(</span>
<span id="cb64-1065"><a href="#cb64-1065" aria-hidden="true" tabindex="-1"></a>    km_dong_tbl<span class="sc">$</span>인구수,</span>
<span id="cb64-1066"><a href="#cb64-1066" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.rm =</span> T</span>
<span id="cb64-1067"><a href="#cb64-1067" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-1068"><a href="#cb64-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1069"><a href="#cb64-1069" aria-hidden="true" tabindex="-1"></a>vmax <span class="ot">&lt;-</span> <span class="fu">max</span>(</span>
<span id="cb64-1070"><a href="#cb64-1070" aria-hidden="true" tabindex="-1"></a>    km_dong_tbl<span class="sc">$</span>인구수,</span>
<span id="cb64-1071"><a href="#cb64-1071" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.rm =</span> T</span>
<span id="cb64-1072"><a href="#cb64-1072" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-1073"><a href="#cb64-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1074"><a href="#cb64-1074" aria-hidden="true" tabindex="-1"></a>km_dong_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="at">x =</span> km_dong_tbl,                         </span>
<span id="cb64-1075"><a href="#cb64-1075" aria-hidden="true" tabindex="-1"></a>        <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"x_axis"</span>, <span class="st">"y_axis"</span>),</span>
<span id="cb64-1076"><a href="#cb64-1076" aria-hidden="true" tabindex="-1"></a>        <span class="at">crs =</span> <span class="fu">st_crs</span>(km_map))</span>
<span id="cb64-1077"><a href="#cb64-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1078"><a href="#cb64-1078" aria-hidden="true" tabindex="-1"></a>km_dong_year_gg <span class="ot">&lt;-</span> km_dong_sf <span class="sc">%&gt;%</span> </span>
<span id="cb64-1079"><a href="#cb64-1079" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-1080"><a href="#cb64-1080" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">geometry=</span>geometry, <span class="at">size =</span> 인구수), <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb64-1081"><a href="#cb64-1081" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>년도, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb64-1082"><a href="#cb64-1082" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size_continuous</span>(</span>
<span id="cb64-1083"><a href="#cb64-1083" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">round</span>(breaks, <span class="dv">0</span>),</span>
<span id="cb64-1084"><a href="#cb64-1084" aria-hidden="true" tabindex="-1"></a>      <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>),</span>
<span id="cb64-1085"><a href="#cb64-1085" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(vmin, vmax),</span>
<span id="cb64-1086"><a href="#cb64-1086" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"유동인구"</span>) <span class="sc">+</span></span>
<span id="cb64-1087"><a href="#cb64-1087" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Malgun Gothic"</span>) <span class="sc">+</span></span>
<span id="cb64-1088"><a href="#cb64-1088" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"광명시 소하2동 연도별 유동인구"</span>,</span>
<span id="cb64-1089"><a href="#cb64-1089" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"2018년 1월 ~ 2022년 12월"</span>,</span>
<span id="cb64-1090"><a href="#cb64-1090" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb64-1091"><a href="#cb64-1091" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">""</span>,</span>
<span id="cb64-1092"><a href="#cb64-1092" aria-hidden="true" tabindex="-1"></a>         <span class="at">size =</span> <span class="st">"유동인구(만명)"</span>,</span>
<span id="cb64-1093"><a href="#cb64-1093" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"데이터 출처: KT 유동인구 데이터(경기도 데이터분석센터"</span>) <span class="sc">+</span></span>
<span id="cb64-1094"><a href="#cb64-1094" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb64-1095"><a href="#cb64-1095" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb64-1096"><a href="#cb64-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1097"><a href="#cb64-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1098"><a href="#cb64-1098" aria-hidden="true" tabindex="-1"></a>km_dong_year_gg</span>
<span id="cb64-1099"><a href="#cb64-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1100"><a href="#cb64-1100" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_png</span>(<span class="st">"images/KT/광명시_소하2동_연도별_유동인구.png"</span>, </span>
<span id="cb64-1101"><a href="#cb64-1101" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-1102"><a href="#cb64-1102" aria-hidden="true" tabindex="-1"></a>km_dong_year_gg</span>
<span id="cb64-1103"><a href="#cb64-1103" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-1104"><a href="#cb64-1104" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1105"><a href="#cb64-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1106"><a href="#cb64-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1107"><a href="#cb64-1107" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/km/광명시_소하2동_연도별_유동인구.png)</span></span>
<span id="cb64-1108"><a href="#cb64-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1109"><a href="#cb64-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1110"><a href="#cb64-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1111"><a href="#cb64-1111" aria-hidden="true" tabindex="-1"></a><span class="fu"># 경기도 어항</span></span>
<span id="cb64-1112"><a href="#cb64-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1113"><a href="#cb64-1113" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb64-1114"><a href="#cb64-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1115"><a href="#cb64-1115" aria-hidden="true" tabindex="-1"></a><span class="fu">## 경기도 지도</span></span>
<span id="cb64-1116"><a href="#cb64-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1117"><a href="#cb64-1117" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-1118"><a href="#cb64-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1119"><a href="#cb64-1119" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-1120"><a href="#cb64-1120" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb64-1121"><a href="#cb64-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1122"><a href="#cb64-1122" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb64-1123"><a href="#cb64-1123" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb64-1124"><a href="#cb64-1124" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb64-1125"><a href="#cb64-1125" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtExtras)</span>
<span id="cb64-1126"><a href="#cb64-1126" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb64-1127"><a href="#cb64-1127" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(camcorder)</span>
<span id="cb64-1128"><a href="#cb64-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1129"><a href="#cb64-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1130"><a href="#cb64-1130" aria-hidden="true" tabindex="-1"></a>katec_crs <span class="ot">&lt;-</span> <span class="st">"+proj=tmerc +lat_0=38 +lon_0=128 +k=0.9999 +x_0=400000 +y_0=600000 +ellps=bessel +units=m +no_defs"</span></span>
<span id="cb64-1131"><a href="#cb64-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1132"><a href="#cb64-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1133"><a href="#cb64-1133" aria-hidden="true" tabindex="-1"></a>gg_admin_map <span class="ot">&lt;-</span> </span>
<span id="cb64-1134"><a href="#cb64-1134" aria-hidden="true" tabindex="-1"></a><span class="fu">st_read</span>(<span class="st">"data/(공통)셀블록도로행정동/행정동경계/행정동경계_경기도/tbshp_admi_gg_20210614.shp"</span>)</span>
<span id="cb64-1135"><a href="#cb64-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1136"><a href="#cb64-1136" aria-hidden="true" tabindex="-1"></a>gg_admin_map <span class="ot">&lt;-</span> gg_admin_map <span class="sc">|&gt;</span> <span class="fu">st_set_crs</span>(katec_crs)</span>
<span id="cb64-1137"><a href="#cb64-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1138"><a href="#cb64-1138" aria-hidden="true" tabindex="-1"></a>gg_city_map <span class="ot">&lt;-</span> gg_admin_map <span class="sc">|&gt;</span> </span>
<span id="cb64-1139"><a href="#cb64-1139" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb64-1140"><a href="#cb64-1140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cty_nm) <span class="sc">|&gt;</span> </span>
<span id="cb64-1141"><a href="#cb64-1141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">geometry =</span> <span class="fu">st_union</span>(geometry)) </span>
<span id="cb64-1142"><a href="#cb64-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1143"><a href="#cb64-1143" aria-hidden="true" tabindex="-1"></a><span class="fu">st_geometry</span>(gg_city_map) <span class="sc">%&gt;%</span> </span>
<span id="cb64-1144"><a href="#cb64-1144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span>
<span id="cb64-1145"><a href="#cb64-1145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1146"><a href="#cb64-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1147"><a href="#cb64-1147" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/gg_map.png)</span></span>
<span id="cb64-1148"><a href="#cb64-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1149"><a href="#cb64-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1150"><a href="#cb64-1150" aria-hidden="true" tabindex="-1"></a><span class="fu">## 항구지도</span></span>
<span id="cb64-1151"><a href="#cb64-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1152"><a href="#cb64-1152" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-1153"><a href="#cb64-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1154"><a href="#cb64-1154" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-1155"><a href="#cb64-1155" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1156"><a href="#cb64-1156" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb64-1157"><a href="#cb64-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1158"><a href="#cb64-1158" aria-hidden="true" tabindex="-1"></a>port_tbl <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/국가어항.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"경기어항"</span>)</span>
<span id="cb64-1159"><a href="#cb64-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1160"><a href="#cb64-1160" aria-hidden="true" tabindex="-1"></a>port_sf <span class="ot">&lt;-</span> port_tbl <span class="sc">|&gt;</span> </span>
<span id="cb64-1161"><a href="#cb64-1161" aria-hidden="true" tabindex="-1"></a>  <span class="co"># WGS84</span></span>
<span id="cb64-1162"><a href="#cb64-1162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>), <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-1163"><a href="#cb64-1163" aria-hidden="true" tabindex="-1"></a>  <span class="co"># KATEC</span></span>
<span id="cb64-1164"><a href="#cb64-1164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="st">"+proj=tmerc +lat_0=38 +lon_0=128 +k=0.9999 +x_0=400000 +y_0=600000 +ellps=bessel +units=m +no_defs"</span>)</span>
<span id="cb64-1165"><a href="#cb64-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1166"><a href="#cb64-1166" aria-hidden="true" tabindex="-1"></a><span class="fu">st_geometry</span>(port_sf) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb64-1167"><a href="#cb64-1167" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1168"><a href="#cb64-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1169"><a href="#cb64-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1170"><a href="#cb64-1170" aria-hidden="true" tabindex="-1"></a><span class="fu">## 시군구 어항</span></span>
<span id="cb64-1171"><a href="#cb64-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1172"><a href="#cb64-1172" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-1173"><a href="#cb64-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1174"><a href="#cb64-1174" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-1175"><a href="#cb64-1175" aria-hidden="true" tabindex="-1"></a>gg_city_bbox <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(gg_city_map)</span>
<span id="cb64-1176"><a href="#cb64-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1177"><a href="#cb64-1177" aria-hidden="true" tabindex="-1"></a>gg_port_map_gg <span class="ot">&lt;-</span> gg_city_map <span class="sc">|&gt;</span> </span>
<span id="cb64-1178"><a href="#cb64-1178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-1179"><a href="#cb64-1179" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>() <span class="sc">+</span></span>
<span id="cb64-1180"><a href="#cb64-1180" aria-hidden="true" tabindex="-1"></a>    ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1181"><a href="#cb64-1181" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> gg_city_map,</span>
<span id="cb64-1182"><a href="#cb64-1182" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> cty_nm, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1183"><a href="#cb64-1183" aria-hidden="true" tabindex="-1"></a>        <span class="at">min.segment.length =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>,</span>
<span id="cb64-1184"><a href="#cb64-1184" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="st">"MaruBrui"</span></span>
<span id="cb64-1185"><a href="#cb64-1185" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb64-1186"><a href="#cb64-1186" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data=</span>port_sf, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb64-1187"><a href="#cb64-1187" aria-hidden="true" tabindex="-1"></a>    ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1188"><a href="#cb64-1188" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> port_sf,</span>
<span id="cb64-1189"><a href="#cb64-1189" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> 어항명, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1190"><a href="#cb64-1190" aria-hidden="true" tabindex="-1"></a>        <span class="at">min.segment.length =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>,</span>
<span id="cb64-1191"><a href="#cb64-1191" aria-hidden="true" tabindex="-1"></a>        <span class="at">hjust =</span> <span class="dv">10</span>,</span>
<span id="cb64-1192"><a href="#cb64-1192" aria-hidden="true" tabindex="-1"></a>        <span class="at">family =</span> <span class="st">"MaruBrui"</span>, <span class="at">fontface =</span> <span class="st">'bold'</span></span>
<span id="cb64-1193"><a href="#cb64-1193" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb64-1194"><a href="#cb64-1194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(gg_city_bbox[<span class="st">'xmin'</span>]<span class="sc">-</span><span class="dv">10000</span>, </span>
<span id="cb64-1195"><a href="#cb64-1195" aria-hidden="true" tabindex="-1"></a>                    gg_city_bbox[<span class="st">'xmax'</span>]<span class="sc">-</span><span class="dv">50000</span>),</span>
<span id="cb64-1196"><a href="#cb64-1196" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim =</span> <span class="fu">c</span>(gg_city_bbox[<span class="st">'ymin'</span>], </span>
<span id="cb64-1197"><a href="#cb64-1197" aria-hidden="true" tabindex="-1"></a>                    gg_city_bbox[<span class="st">'ymax'</span>])) <span class="sc">+</span></span>
<span id="cb64-1198"><a href="#cb64-1198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb64-1199"><a href="#cb64-1199" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"MaruBuri"</span>, <span class="at">size =</span> <span class="dv">24</span>), </span>
<span id="cb64-1200"><a href="#cb64-1200" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"MaruBuri"</span>),</span>
<span id="cb64-1201"><a href="#cb64-1201" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"MaruBuri"</span>)</span>
<span id="cb64-1202"><a href="#cb64-1202" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb64-1203"><a href="#cb64-1203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"경기도 지방 항구"</span>,</span>
<span id="cb64-1204"><a href="#cb64-1204" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"출처: 경기도 데이터분석센터"</span>) <span class="sc">+</span></span>
<span id="cb64-1205"><a href="#cb64-1205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>)  </span>
<span id="cb64-1206"><a href="#cb64-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1207"><a href="#cb64-1207" aria-hidden="true" tabindex="-1"></a>gg_port_map_gg </span>
<span id="cb64-1208"><a href="#cb64-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1209"><a href="#cb64-1209" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_jpeg</span>(<span class="st">"images/항구_통계/01_경기도_어항_행정동.jpg"</span>, </span>
<span id="cb64-1210"><a href="#cb64-1210" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-1211"><a href="#cb64-1211" aria-hidden="true" tabindex="-1"></a>gg_port_map_gg</span>
<span id="cb64-1212"><a href="#cb64-1212" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-1213"><a href="#cb64-1213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1214"><a href="#cb64-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1215"><a href="#cb64-1215" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/01_경기도_어항_행정동.jpg)</span></span>
<span id="cb64-1216"><a href="#cb64-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1217"><a href="#cb64-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1218"><a href="#cb64-1218" aria-hidden="true" tabindex="-1"></a><span class="fu">## 항구 행정동(추출)</span></span>
<span id="cb64-1219"><a href="#cb64-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1220"><a href="#cb64-1220" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-1221"><a href="#cb64-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1222"><a href="#cb64-1222" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-1223"><a href="#cb64-1223" aria-hidden="true" tabindex="-1"></a>ports_adm_sf <span class="ot">&lt;-</span> <span class="fu">st_join</span>(gg_admin_map, port_sf, <span class="at">maxdist =</span> <span class="dv">1000</span>, </span>
<span id="cb64-1224"><a href="#cb64-1224" aria-hidden="true" tabindex="-1"></a>                        <span class="at">join =</span> nngeo<span class="sc">::</span>st_nn, <span class="at">left =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-1225"><a href="#cb64-1225" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>(<span class="at">ascii =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-1226"><a href="#cb64-1226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sgg_name =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{어항명}"</span>))</span>
<span id="cb64-1227"><a href="#cb64-1227" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mutate(sgg_name = glue::glue("{어항명}: {cty_nm}"))</span></span>
<span id="cb64-1228"><a href="#cb64-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1229"><a href="#cb64-1229" aria-hidden="true" tabindex="-1"></a>ports_adm_dong_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-1230"><a href="#cb64-1230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>ports_adm_sf) <span class="sc">+</span></span>
<span id="cb64-1231"><a href="#cb64-1231" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1232"><a href="#cb64-1232" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> port_sf,</span>
<span id="cb64-1233"><a href="#cb64-1233" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> 어항명, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1234"><a href="#cb64-1234" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">3</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">family =</span> <span class="st">"MaruBrui"</span>) <span class="sc">+</span></span>
<span id="cb64-1235"><a href="#cb64-1235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>port_sf, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb64-1236"><a href="#cb64-1236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(gg_city_bbox[<span class="st">'xmin'</span>]<span class="sc">-</span><span class="dv">10000</span>, </span>
<span id="cb64-1237"><a href="#cb64-1237" aria-hidden="true" tabindex="-1"></a>                  gg_city_bbox[<span class="st">'xmax'</span>]<span class="sc">-</span><span class="dv">60000</span>),</span>
<span id="cb64-1238"><a href="#cb64-1238" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylim =</span> <span class="fu">c</span>(gg_city_bbox[<span class="st">'ymin'</span>], </span>
<span id="cb64-1239"><a href="#cb64-1239" aria-hidden="true" tabindex="-1"></a>                  gg_city_bbox[<span class="st">'ymax'</span>]<span class="sc">-</span><span class="dv">65000</span>)) <span class="sc">+</span></span>
<span id="cb64-1240"><a href="#cb64-1240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb64-1241"><a href="#cb64-1241" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"MaruBuri"</span>, <span class="at">size =</span> <span class="dv">24</span>), </span>
<span id="cb64-1242"><a href="#cb64-1242" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"MaruBuri"</span>),</span>
<span id="cb64-1243"><a href="#cb64-1243" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"MaruBuri"</span>)</span>
<span id="cb64-1244"><a href="#cb64-1244" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb64-1245"><a href="#cb64-1245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"경기도 지방 항구"</span>,</span>
<span id="cb64-1246"><a href="#cb64-1246" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"지방항구 시군구 행정동"</span>,</span>
<span id="cb64-1247"><a href="#cb64-1247" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"출처: 경기도 데이터분석센터"</span>) <span class="sc">+</span></span>
<span id="cb64-1248"><a href="#cb64-1248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>)  </span>
<span id="cb64-1249"><a href="#cb64-1249" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-1250"><a href="#cb64-1250" aria-hidden="true" tabindex="-1"></a>ports_adm_dong_gg </span>
<span id="cb64-1251"><a href="#cb64-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1252"><a href="#cb64-1252" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_jpeg</span>(<span class="st">"images/항구_통계/01_경기도_어항_행정동_추출.jpg"</span>, </span>
<span id="cb64-1253"><a href="#cb64-1253" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-1254"><a href="#cb64-1254" aria-hidden="true" tabindex="-1"></a>ports_adm_dong_gg</span>
<span id="cb64-1255"><a href="#cb64-1255" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-1256"><a href="#cb64-1256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1257"><a href="#cb64-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1258"><a href="#cb64-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1259"><a href="#cb64-1259" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/01_경기도_어항_행정동_추출.jpg)</span></span>
<span id="cb64-1260"><a href="#cb64-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1261"><a href="#cb64-1261" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-1262"><a href="#cb64-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1263"><a href="#cb64-1263" aria-hidden="true" tabindex="-1"></a><span class="fu"># 각 항구</span></span>
<span id="cb64-1264"><a href="#cb64-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1265"><a href="#cb64-1265" aria-hidden="true" tabindex="-1"></a><span class="fu">## 김포시 대명항</span></span>
<span id="cb64-1266"><a href="#cb64-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1267"><a href="#cb64-1267" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb64-1268"><a href="#cb64-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1269"><a href="#cb64-1269" aria-hidden="true" tabindex="-1"></a><span class="fu">### 김포시 위치</span></span>
<span id="cb64-1270"><a href="#cb64-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1271"><a href="#cb64-1271" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-1272"><a href="#cb64-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1273"><a href="#cb64-1273" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-1274"><a href="#cb64-1274" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb64-1275"><a href="#cb64-1275" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb64-1276"><a href="#cb64-1276" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb64-1277"><a href="#cb64-1277" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtExtras)</span>
<span id="cb64-1278"><a href="#cb64-1278" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb64-1279"><a href="#cb64-1279" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb64-1280"><a href="#cb64-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1281"><a href="#cb64-1281" aria-hidden="true" tabindex="-1"></a>katec_crs <span class="ot">&lt;-</span> <span class="st">"+proj=tmerc +lat_0=38 +lon_0=128 +k=0.9999 +x_0=400000 +y_0=600000 +ellps=bessel +units=m +no_defs"</span></span>
<span id="cb64-1282"><a href="#cb64-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1283"><a href="#cb64-1283" aria-hidden="true" tabindex="-1"></a>gg_admin_map <span class="ot">&lt;-</span> </span>
<span id="cb64-1284"><a href="#cb64-1284" aria-hidden="true" tabindex="-1"></a><span class="fu">st_read</span>(<span class="st">"data/(공통)셀블록도로행정동/행정동경계/행정동경계_경기도/tbshp_admi_gg_20210614.shp"</span>)</span>
<span id="cb64-1285"><a href="#cb64-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1286"><a href="#cb64-1286" aria-hidden="true" tabindex="-1"></a>gg_admin_map <span class="ot">&lt;-</span> gg_admin_map <span class="sc">|&gt;</span> <span class="fu">st_set_crs</span>(katec_crs)</span>
<span id="cb64-1287"><a href="#cb64-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1288"><a href="#cb64-1288" aria-hidden="true" tabindex="-1"></a>gg_city_map <span class="ot">&lt;-</span> gg_admin_map <span class="sc">|&gt;</span> </span>
<span id="cb64-1289"><a href="#cb64-1289" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb64-1290"><a href="#cb64-1290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cty_nm) <span class="sc">|&gt;</span> </span>
<span id="cb64-1291"><a href="#cb64-1291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">geometry =</span> <span class="fu">st_union</span>(geometry)) <span class="sc">|&gt;</span> </span>
<span id="cb64-1292"><a href="#cb64-1292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cty_target =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(cty_nm, <span class="st">"김포"</span>), <span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span>
<span id="cb64-1293"><a href="#cb64-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1294"><a href="#cb64-1294" aria-hidden="true" tabindex="-1"></a>gg_gimpo_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-1295"><a href="#cb64-1295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> gg_city_map, <span class="fu">aes</span>(<span class="at">fill =</span> cty_target)) <span class="sc">+</span></span>
<span id="cb64-1296"><a href="#cb64-1296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>) <span class="sc">+</span></span>
<span id="cb64-1297"><a href="#cb64-1297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray90"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb64-1298"><a href="#cb64-1298" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1299"><a href="#cb64-1299" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> gg_city_map <span class="sc">|&gt;</span> <span class="fu">filter</span>(cty_target <span class="sc">==</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-1300"><a href="#cb64-1300" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> cty_nm, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1301"><a href="#cb64-1301" aria-hidden="true" tabindex="-1"></a>        <span class="at">min.segment.length =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>,</span>
<span id="cb64-1302"><a href="#cb64-1302" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="st">"MaruBrui"</span>) <span class="sc">+</span></span>
<span id="cb64-1303"><a href="#cb64-1303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb64-1304"><a href="#cb64-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1305"><a href="#cb64-1305" aria-hidden="true" tabindex="-1"></a>gg_gimpo_gg</span>
<span id="cb64-1306"><a href="#cb64-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1307"><a href="#cb64-1307" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_jpeg</span>(<span class="st">"images/항구_통계/02_경기도_김포시.jpg"</span>, </span>
<span id="cb64-1308"><a href="#cb64-1308" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-1309"><a href="#cb64-1309" aria-hidden="true" tabindex="-1"></a>gg_gimpo_gg</span>
<span id="cb64-1310"><a href="#cb64-1310" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-1311"><a href="#cb64-1311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1312"><a href="#cb64-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1313"><a href="#cb64-1313" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/02_경기도_김포시.jpg)</span></span>
<span id="cb64-1314"><a href="#cb64-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1315"><a href="#cb64-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1316"><a href="#cb64-1316" aria-hidden="true" tabindex="-1"></a><span class="fu">### 김포시 대명항</span></span>
<span id="cb64-1317"><a href="#cb64-1317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1318"><a href="#cb64-1318" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-1319"><a href="#cb64-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1320"><a href="#cb64-1320" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-1321"><a href="#cb64-1321" aria-hidden="true" tabindex="-1"></a><span class="do">## 김포시 </span></span>
<span id="cb64-1322"><a href="#cb64-1322" aria-hidden="true" tabindex="-1"></a>gimpo_adm_sf <span class="ot">&lt;-</span> gg_admin_map <span class="sc">|&gt;</span> <span class="fu">filter</span>(CTY_NM <span class="sc">==</span> <span class="st">"김포시"</span>)</span>
<span id="cb64-1323"><a href="#cb64-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1324"><a href="#cb64-1324" aria-hidden="true" tabindex="-1"></a><span class="do">## 항구</span></span>
<span id="cb64-1325"><a href="#cb64-1325" aria-hidden="true" tabindex="-1"></a>port_tbl <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/국가어항.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"경기어항"</span>)</span>
<span id="cb64-1326"><a href="#cb64-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1327"><a href="#cb64-1327" aria-hidden="true" tabindex="-1"></a>port_sf <span class="ot">&lt;-</span> port_tbl <span class="sc">|&gt;</span> </span>
<span id="cb64-1328"><a href="#cb64-1328" aria-hidden="true" tabindex="-1"></a>  <span class="co"># WGS84</span></span>
<span id="cb64-1329"><a href="#cb64-1329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>), <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-1330"><a href="#cb64-1330" aria-hidden="true" tabindex="-1"></a>  <span class="co"># KATEC</span></span>
<span id="cb64-1331"><a href="#cb64-1331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(katec_crs)</span>
<span id="cb64-1332"><a href="#cb64-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1333"><a href="#cb64-1333" aria-hidden="true" tabindex="-1"></a>gg_gimpo_port_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-1334"><a href="#cb64-1334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> gimpo_adm_sf) <span class="sc">+</span></span>
<span id="cb64-1335"><a href="#cb64-1335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>) <span class="sc">+</span></span>
<span id="cb64-1336"><a href="#cb64-1336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray90"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb64-1337"><a href="#cb64-1337" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1338"><a href="#cb64-1338" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> gimpo_adm_sf,</span>
<span id="cb64-1339"><a href="#cb64-1339" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> ADMI_NM, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1340"><a href="#cb64-1340" aria-hidden="true" tabindex="-1"></a>      <span class="at">min.segment.length =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">family =</span> <span class="st">"MaruBrui"</span>) <span class="sc">+</span></span>
<span id="cb64-1341"><a href="#cb64-1341" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb64-1342"><a href="#cb64-1342" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data=</span>port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"대명항"</span>), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb64-1343"><a href="#cb64-1343" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1344"><a href="#cb64-1344" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"대명항"</span>),</span>
<span id="cb64-1345"><a href="#cb64-1345" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> 어항명, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1346"><a href="#cb64-1346" aria-hidden="true" tabindex="-1"></a>      <span class="at">min.segment.length =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">family =</span> <span class="st">"MaruBrui"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)    </span>
<span id="cb64-1347"><a href="#cb64-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1348"><a href="#cb64-1348" aria-hidden="true" tabindex="-1"></a>gg_gimpo_port_gg</span>
<span id="cb64-1349"><a href="#cb64-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1350"><a href="#cb64-1350" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_jpeg</span>(<span class="st">"images/항구_통계/02_경기도_김포시_대명항.jpg"</span>, </span>
<span id="cb64-1351"><a href="#cb64-1351" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-1352"><a href="#cb64-1352" aria-hidden="true" tabindex="-1"></a>gg_gimpo_port_gg</span>
<span id="cb64-1353"><a href="#cb64-1353" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-1354"><a href="#cb64-1354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1355"><a href="#cb64-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1356"><a href="#cb64-1356" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/02_경기도_김포시_대명항.jpg)</span></span>
<span id="cb64-1357"><a href="#cb64-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1358"><a href="#cb64-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1359"><a href="#cb64-1359" aria-hidden="true" tabindex="-1"></a><span class="fu">### 대명항 인근 1 KM</span></span>
<span id="cb64-1360"><a href="#cb64-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1361"><a href="#cb64-1361" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-1362"><a href="#cb64-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1363"><a href="#cb64-1363" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-1364"><a href="#cb64-1364" aria-hidden="true" tabindex="-1"></a>cell_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/(공통)셀블록도로행정동/셀(중심점)/cell_gg_admi2_20210616.shp"</span>)</span>
<span id="cb64-1365"><a href="#cb64-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1366"><a href="#cb64-1366" aria-hidden="true" tabindex="-1"></a>gimpo_cty_cell_sf <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(cell_sf, katec_crs) <span class="sc">|&gt;</span> </span>
<span id="cb64-1367"><a href="#cb64-1367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CTY_CD <span class="sc">==</span> gg_admin_map <span class="sc">|&gt;</span> <span class="fu">filter</span>(CTY_NM <span class="sc">==</span> <span class="st">"김포시"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-1368"><a href="#cb64-1368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(CTY_CD) <span class="sc">|&gt;</span> <span class="fu">unique</span>())</span>
<span id="cb64-1369"><a href="#cb64-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1370"><a href="#cb64-1370" aria-hidden="true" tabindex="-1"></a><span class="do">## 항구 인근 1 KM</span></span>
<span id="cb64-1371"><a href="#cb64-1371" aria-hidden="true" tabindex="-1"></a>gimpo_ports_cell_sf <span class="ot">&lt;-</span> <span class="fu">st_join</span>(gimpo_cty_cell_sf,</span>
<span id="cb64-1372"><a href="#cb64-1372" aria-hidden="true" tabindex="-1"></a>                               port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"대명항"</span>), </span>
<span id="cb64-1373"><a href="#cb64-1373" aria-hidden="true" tabindex="-1"></a>                         <span class="at">maxdist =</span> <span class="dv">1000</span>, </span>
<span id="cb64-1374"><a href="#cb64-1374" aria-hidden="true" tabindex="-1"></a>                         <span class="at">join =</span> nngeo<span class="sc">::</span>st_nn, <span class="at">left =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-1375"><a href="#cb64-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1376"><a href="#cb64-1376" aria-hidden="true" tabindex="-1"></a>gimpo_ports_bbox <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(gimpo_ports_cell_sf)</span>
<span id="cb64-1377"><a href="#cb64-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1378"><a href="#cb64-1378" aria-hidden="true" tabindex="-1"></a><span class="do">### 1. 김포시 Inset</span></span>
<span id="cb64-1379"><a href="#cb64-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1380"><a href="#cb64-1380" aria-hidden="true" tabindex="-1"></a>inset_gimpo_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-1381"><a href="#cb64-1381" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 1. 행정동 ---------</span></span>
<span id="cb64-1382"><a href="#cb64-1382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> gimpo_adm_sf) <span class="sc">+</span>  </span>
<span id="cb64-1383"><a href="#cb64-1383" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1384"><a href="#cb64-1384" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> gimpo_adm_sf,</span>
<span id="cb64-1385"><a href="#cb64-1385" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> ADMI_NM, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1386"><a href="#cb64-1386" aria-hidden="true" tabindex="-1"></a>      <span class="at">min.segment.length =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">family =</span> <span class="st">"MaruBrui"</span>) <span class="sc">+</span></span>
<span id="cb64-1387"><a href="#cb64-1387" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb64-1388"><a href="#cb64-1388" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 2. 항구 ---------  </span></span>
<span id="cb64-1389"><a href="#cb64-1389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"대명항"</span>), </span>
<span id="cb64-1390"><a href="#cb64-1390" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb64-1391"><a href="#cb64-1391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>)  <span class="sc">+</span></span>
<span id="cb64-1392"><a href="#cb64-1392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> gimpo_ports_bbox[<span class="st">'xmin'</span>]<span class="sc">-</span><span class="dv">1000</span>, </span>
<span id="cb64-1393"><a href="#cb64-1393" aria-hidden="true" tabindex="-1"></a>                <span class="at">xmax =</span> gimpo_ports_bbox[<span class="st">'xmax'</span>]<span class="sc">+</span><span class="dv">1000</span>, </span>
<span id="cb64-1394"><a href="#cb64-1394" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymin =</span> gimpo_ports_bbox[<span class="st">'ymin'</span>]<span class="sc">-</span><span class="dv">1000</span>, </span>
<span id="cb64-1395"><a href="#cb64-1395" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymax =</span> gimpo_ports_bbox[<span class="st">'ymax'</span>]<span class="sc">+</span><span class="dv">1000</span>), <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">color=</span><span class="st">"red"</span>)</span>
<span id="cb64-1396"><a href="#cb64-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1397"><a href="#cb64-1397" aria-hidden="true" tabindex="-1"></a>inset_gimpo_gg</span>
<span id="cb64-1398"><a href="#cb64-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1399"><a href="#cb64-1399" aria-hidden="true" tabindex="-1"></a><span class="do">### 2. 김포시 대명항</span></span>
<span id="cb64-1400"><a href="#cb64-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1401"><a href="#cb64-1401" aria-hidden="true" tabindex="-1"></a>inset_gimpo_daemyung_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-1402"><a href="#cb64-1402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> gimpo_adm_sf) <span class="sc">+</span>  </span>
<span id="cb64-1403"><a href="#cb64-1403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span> gimpo_ports_cell_sf, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb64-1404"><a href="#cb64-1404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"대명항"</span>), <span class="at">size =</span> <span class="dv">3</span>, </span>
<span id="cb64-1405"><a href="#cb64-1405" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb64-1406"><a href="#cb64-1406" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1407"><a href="#cb64-1407" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"대명항"</span>),</span>
<span id="cb64-1408"><a href="#cb64-1408" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> 어항명, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1409"><a href="#cb64-1409" aria-hidden="true" tabindex="-1"></a>      <span class="at">min.segment.length =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">family =</span> <span class="st">"MaruBrui"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb64-1410"><a href="#cb64-1410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>) <span class="sc">+</span></span>
<span id="cb64-1411"><a href="#cb64-1411" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(gimpo_ports_bbox[<span class="st">'xmin'</span>]<span class="sc">-</span><span class="dv">1000</span>, </span>
<span id="cb64-1412"><a href="#cb64-1412" aria-hidden="true" tabindex="-1"></a>                      gimpo_ports_bbox[<span class="st">'xmax'</span>]<span class="sc">+</span><span class="dv">1000</span>),</span>
<span id="cb64-1413"><a href="#cb64-1413" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylim =</span> <span class="fu">c</span>(gimpo_ports_bbox[<span class="st">'ymin'</span>]<span class="sc">-</span><span class="dv">1000</span>, </span>
<span id="cb64-1414"><a href="#cb64-1414" aria-hidden="true" tabindex="-1"></a>                      gimpo_ports_bbox[<span class="st">'ymax'</span>]<span class="sc">+</span><span class="dv">1000</span>)) <span class="sc">+</span></span>
<span id="cb64-1415"><a href="#cb64-1415" aria-hidden="true" tabindex="-1"></a>  ggspatial<span class="sc">::</span><span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">"br"</span>, <span class="at">width_hint =</span> <span class="fl">0.5</span>,</span>
<span id="cb64-1416"><a href="#cb64-1416" aria-hidden="true" tabindex="-1"></a>                               <span class="at">height =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>))</span>
<span id="cb64-1417"><a href="#cb64-1417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1418"><a href="#cb64-1418" aria-hidden="true" tabindex="-1"></a><span class="do">## 3. 김포시 + 대명항 지도 -------------------------------  </span></span>
<span id="cb64-1419"><a href="#cb64-1419" aria-hidden="true" tabindex="-1"></a>daemyung_port_inset_map <span class="ot">&lt;-</span> inset_gimpo_daemyung_gg <span class="sc">+</span> </span>
<span id="cb64-1420"><a href="#cb64-1420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inset_element</span>(inset_gimpo_gg, <span class="fl">0.6</span>, <span class="fl">0.6</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="at">align_to =</span> <span class="st">'full'</span>) <span class="sc">+</span></span>
<span id="cb64-1421"><a href="#cb64-1421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">'김포시 대명항 및 인근 1 KM지역'</span>)</span>
<span id="cb64-1422"><a href="#cb64-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1423"><a href="#cb64-1423" aria-hidden="true" tabindex="-1"></a>daemyung_port_inset_map</span>
<span id="cb64-1424"><a href="#cb64-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1425"><a href="#cb64-1425" aria-hidden="true" tabindex="-1"></a>fs<span class="sc">::</span><span class="fu">dir_create</span>(<span class="st">"images/항구_통계/"</span>)</span>
<span id="cb64-1426"><a href="#cb64-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1427"><a href="#cb64-1427" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_png</span>(<span class="st">"images/항구_통계/2_김포_대명항_최종.png"</span>, </span>
<span id="cb64-1428"><a href="#cb64-1428" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-1429"><a href="#cb64-1429" aria-hidden="true" tabindex="-1"></a>daemyung_port_inset_map</span>
<span id="cb64-1430"><a href="#cb64-1430" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-1431"><a href="#cb64-1431" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1432"><a href="#cb64-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1433"><a href="#cb64-1433" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/02_김포_대명항_최종.png)</span></span>
<span id="cb64-1434"><a href="#cb64-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1435"><a href="#cb64-1435" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-1436"><a href="#cb64-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1437"><a href="#cb64-1437" aria-hidden="true" tabindex="-1"></a><span class="fu">## 화성시 궁평항</span></span>
<span id="cb64-1438"><a href="#cb64-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1439"><a href="#cb64-1439" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb64-1440"><a href="#cb64-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1441"><a href="#cb64-1441" aria-hidden="true" tabindex="-1"></a><span class="fu">### 화성시 위치</span></span>
<span id="cb64-1442"><a href="#cb64-1442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1443"><a href="#cb64-1443" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-1444"><a href="#cb64-1444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1445"><a href="#cb64-1445" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-1446"><a href="#cb64-1446" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb64-1447"><a href="#cb64-1447" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb64-1448"><a href="#cb64-1448" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb64-1449"><a href="#cb64-1449" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtExtras)</span>
<span id="cb64-1450"><a href="#cb64-1450" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb64-1451"><a href="#cb64-1451" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb64-1452"><a href="#cb64-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1453"><a href="#cb64-1453" aria-hidden="true" tabindex="-1"></a>katec_crs <span class="ot">&lt;-</span> <span class="st">"+proj=tmerc +lat_0=38 +lon_0=128 +k=0.9999 +x_0=400000 +y_0=600000 +ellps=bessel +units=m +no_defs"</span></span>
<span id="cb64-1454"><a href="#cb64-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1455"><a href="#cb64-1455" aria-hidden="true" tabindex="-1"></a>gg_admin_map <span class="ot">&lt;-</span> </span>
<span id="cb64-1456"><a href="#cb64-1456" aria-hidden="true" tabindex="-1"></a><span class="fu">st_read</span>(<span class="st">"data/(공통)셀블록도로행정동/행정동경계/행정동경계_경기도/tbshp_admi_gg_20210614.shp"</span>)</span>
<span id="cb64-1457"><a href="#cb64-1457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1458"><a href="#cb64-1458" aria-hidden="true" tabindex="-1"></a>gg_admin_map <span class="ot">&lt;-</span> gg_admin_map <span class="sc">|&gt;</span> <span class="fu">st_set_crs</span>(katec_crs)</span>
<span id="cb64-1459"><a href="#cb64-1459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1460"><a href="#cb64-1460" aria-hidden="true" tabindex="-1"></a>gg_city_map <span class="ot">&lt;-</span> gg_admin_map <span class="sc">|&gt;</span> </span>
<span id="cb64-1461"><a href="#cb64-1461" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb64-1462"><a href="#cb64-1462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cty_nm) <span class="sc">|&gt;</span> </span>
<span id="cb64-1463"><a href="#cb64-1463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">geometry =</span> <span class="fu">st_union</span>(geometry)) <span class="sc">|&gt;</span> </span>
<span id="cb64-1464"><a href="#cb64-1464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cty_target =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(cty_nm, <span class="st">"화성"</span>), <span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span>
<span id="cb64-1465"><a href="#cb64-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1466"><a href="#cb64-1466" aria-hidden="true" tabindex="-1"></a>gg_hw_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-1467"><a href="#cb64-1467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> gg_city_map, <span class="fu">aes</span>(<span class="at">fill =</span> cty_target)) <span class="sc">+</span></span>
<span id="cb64-1468"><a href="#cb64-1468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>) <span class="sc">+</span></span>
<span id="cb64-1469"><a href="#cb64-1469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray90"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb64-1470"><a href="#cb64-1470" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1471"><a href="#cb64-1471" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> gg_city_map <span class="sc">|&gt;</span> <span class="fu">filter</span>(cty_target <span class="sc">==</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-1472"><a href="#cb64-1472" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> cty_nm, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1473"><a href="#cb64-1473" aria-hidden="true" tabindex="-1"></a>        <span class="at">min.segment.length =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>,</span>
<span id="cb64-1474"><a href="#cb64-1474" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="st">"MaruBrui"</span>) <span class="sc">+</span></span>
<span id="cb64-1475"><a href="#cb64-1475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb64-1476"><a href="#cb64-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1477"><a href="#cb64-1477" aria-hidden="true" tabindex="-1"></a>gg_hw_gg</span>
<span id="cb64-1478"><a href="#cb64-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1479"><a href="#cb64-1479" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_jpeg</span>(<span class="st">"images/항구_통계/02_경기도_화성시.jpg"</span>, </span>
<span id="cb64-1480"><a href="#cb64-1480" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-1481"><a href="#cb64-1481" aria-hidden="true" tabindex="-1"></a>gg_hw_gg</span>
<span id="cb64-1482"><a href="#cb64-1482" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-1483"><a href="#cb64-1483" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1484"><a href="#cb64-1484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1485"><a href="#cb64-1485" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/02_경기도_화성시.jpg)</span></span>
<span id="cb64-1486"><a href="#cb64-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1487"><a href="#cb64-1487" aria-hidden="true" tabindex="-1"></a><span class="fu">### 화성시 궁평항</span></span>
<span id="cb64-1488"><a href="#cb64-1488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1489"><a href="#cb64-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1490"><a href="#cb64-1490" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-1491"><a href="#cb64-1491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1492"><a href="#cb64-1492" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-1493"><a href="#cb64-1493" aria-hidden="true" tabindex="-1"></a><span class="do">## 김포시 </span></span>
<span id="cb64-1494"><a href="#cb64-1494" aria-hidden="true" tabindex="-1"></a>hw_adm_sf <span class="ot">&lt;-</span> gg_admin_map <span class="sc">|&gt;</span> <span class="fu">filter</span>(CTY_NM <span class="sc">==</span> <span class="st">"화성시"</span>)</span>
<span id="cb64-1495"><a href="#cb64-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1496"><a href="#cb64-1496" aria-hidden="true" tabindex="-1"></a><span class="do">## 항구</span></span>
<span id="cb64-1497"><a href="#cb64-1497" aria-hidden="true" tabindex="-1"></a>port_tbl <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/국가어항.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"경기어항"</span>)</span>
<span id="cb64-1498"><a href="#cb64-1498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1499"><a href="#cb64-1499" aria-hidden="true" tabindex="-1"></a>port_sf <span class="ot">&lt;-</span> port_tbl <span class="sc">|&gt;</span> </span>
<span id="cb64-1500"><a href="#cb64-1500" aria-hidden="true" tabindex="-1"></a>  <span class="co"># WGS84</span></span>
<span id="cb64-1501"><a href="#cb64-1501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>), <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-1502"><a href="#cb64-1502" aria-hidden="true" tabindex="-1"></a>  <span class="co"># KATEC</span></span>
<span id="cb64-1503"><a href="#cb64-1503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(katec_crs)</span>
<span id="cb64-1504"><a href="#cb64-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1505"><a href="#cb64-1505" aria-hidden="true" tabindex="-1"></a>gg_hw_port_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-1506"><a href="#cb64-1506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> hw_adm_sf) <span class="sc">+</span></span>
<span id="cb64-1507"><a href="#cb64-1507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>) <span class="sc">+</span></span>
<span id="cb64-1508"><a href="#cb64-1508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray90"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb64-1509"><a href="#cb64-1509" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1510"><a href="#cb64-1510" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> hw_adm_sf,</span>
<span id="cb64-1511"><a href="#cb64-1511" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> ADMI_NM, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1512"><a href="#cb64-1512" aria-hidden="true" tabindex="-1"></a>      <span class="at">min.segment.length =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">family =</span> <span class="st">"MaruBrui"</span>) <span class="sc">+</span></span>
<span id="cb64-1513"><a href="#cb64-1513" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb64-1514"><a href="#cb64-1514" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data=</span>port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"궁평항"</span>), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb64-1515"><a href="#cb64-1515" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1516"><a href="#cb64-1516" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"궁평항"</span>),</span>
<span id="cb64-1517"><a href="#cb64-1517" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> 어항명, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1518"><a href="#cb64-1518" aria-hidden="true" tabindex="-1"></a>      <span class="at">min.segment.length =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">family =</span> <span class="st">"MaruBrui"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)   </span>
<span id="cb64-1519"><a href="#cb64-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1520"><a href="#cb64-1520" aria-hidden="true" tabindex="-1"></a>gg_hw_port_gg</span>
<span id="cb64-1521"><a href="#cb64-1521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1522"><a href="#cb64-1522" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_jpeg</span>(<span class="st">"images/항구_통계/02_경기도_화성시_궁평항.jpg"</span>, </span>
<span id="cb64-1523"><a href="#cb64-1523" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-1524"><a href="#cb64-1524" aria-hidden="true" tabindex="-1"></a>gg_hw_port_gg</span>
<span id="cb64-1525"><a href="#cb64-1525" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-1526"><a href="#cb64-1526" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1527"><a href="#cb64-1527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1528"><a href="#cb64-1528" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/02_경기도_화성시_궁평항.jpg)</span></span>
<span id="cb64-1529"><a href="#cb64-1529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1530"><a href="#cb64-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1531"><a href="#cb64-1531" aria-hidden="true" tabindex="-1"></a><span class="fu">### 궁평항 인근 1 KM</span></span>
<span id="cb64-1532"><a href="#cb64-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1533"><a href="#cb64-1533" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-1534"><a href="#cb64-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1535"><a href="#cb64-1535" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-1536"><a href="#cb64-1536" aria-hidden="true" tabindex="-1"></a><span class="co"># cell_sf &lt;- st_read("data/(공통)셀블록도로행정동/셀(중심점)/cell_gg_admi2_20210616.shp")</span></span>
<span id="cb64-1537"><a href="#cb64-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1538"><a href="#cb64-1538" aria-hidden="true" tabindex="-1"></a>hw_cty_cell_sf <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(cell_sf, katec_crs) <span class="sc">|&gt;</span> </span>
<span id="cb64-1539"><a href="#cb64-1539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CTY_CD <span class="sc">==</span> gg_admin_map <span class="sc">|&gt;</span> <span class="fu">filter</span>(CTY_NM <span class="sc">==</span> <span class="st">"화성시"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-1540"><a href="#cb64-1540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(CTY_CD) <span class="sc">|&gt;</span> <span class="fu">unique</span>())</span>
<span id="cb64-1541"><a href="#cb64-1541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1542"><a href="#cb64-1542" aria-hidden="true" tabindex="-1"></a><span class="do">## 항구 인근 1 KM</span></span>
<span id="cb64-1543"><a href="#cb64-1543" aria-hidden="true" tabindex="-1"></a>hw_ports_cell_sf <span class="ot">&lt;-</span> <span class="fu">st_join</span>(hw_cty_cell_sf,</span>
<span id="cb64-1544"><a href="#cb64-1544" aria-hidden="true" tabindex="-1"></a>                               port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"궁평항"</span>), </span>
<span id="cb64-1545"><a href="#cb64-1545" aria-hidden="true" tabindex="-1"></a>                         <span class="at">maxdist =</span> <span class="dv">1000</span>, </span>
<span id="cb64-1546"><a href="#cb64-1546" aria-hidden="true" tabindex="-1"></a>                         <span class="at">join =</span> nngeo<span class="sc">::</span>st_nn, <span class="at">left =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-1547"><a href="#cb64-1547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1548"><a href="#cb64-1548" aria-hidden="true" tabindex="-1"></a>hw_ports_bbox <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(hw_ports_cell_sf)</span>
<span id="cb64-1549"><a href="#cb64-1549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1550"><a href="#cb64-1550" aria-hidden="true" tabindex="-1"></a><span class="do">### 1. 화성시 Inset</span></span>
<span id="cb64-1551"><a href="#cb64-1551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1552"><a href="#cb64-1552" aria-hidden="true" tabindex="-1"></a>inset_hw_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-1553"><a href="#cb64-1553" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 1. 행정동 ---------</span></span>
<span id="cb64-1554"><a href="#cb64-1554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> hw_adm_sf) <span class="sc">+</span>  </span>
<span id="cb64-1555"><a href="#cb64-1555" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1556"><a href="#cb64-1556" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> hw_adm_sf,</span>
<span id="cb64-1557"><a href="#cb64-1557" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> ADMI_NM, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1558"><a href="#cb64-1558" aria-hidden="true" tabindex="-1"></a>      <span class="at">min.segment.length =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">family =</span> <span class="st">"MaruBrui"</span>) <span class="sc">+</span></span>
<span id="cb64-1559"><a href="#cb64-1559" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb64-1560"><a href="#cb64-1560" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 2. 항구 ---------  </span></span>
<span id="cb64-1561"><a href="#cb64-1561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"궁평항"</span>), </span>
<span id="cb64-1562"><a href="#cb64-1562" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb64-1563"><a href="#cb64-1563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>)  <span class="sc">+</span></span>
<span id="cb64-1564"><a href="#cb64-1564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> hw_ports_bbox[<span class="st">'xmin'</span>]<span class="sc">-</span><span class="dv">1000</span>, </span>
<span id="cb64-1565"><a href="#cb64-1565" aria-hidden="true" tabindex="-1"></a>                <span class="at">xmax =</span> hw_ports_bbox[<span class="st">'xmax'</span>]<span class="sc">+</span><span class="dv">1000</span>, </span>
<span id="cb64-1566"><a href="#cb64-1566" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymin =</span> hw_ports_bbox[<span class="st">'ymin'</span>]<span class="sc">-</span><span class="dv">1000</span>, </span>
<span id="cb64-1567"><a href="#cb64-1567" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymax =</span> hw_ports_bbox[<span class="st">'ymax'</span>]<span class="sc">+</span><span class="dv">1000</span>), <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">color=</span><span class="st">"red"</span>)</span>
<span id="cb64-1568"><a href="#cb64-1568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1569"><a href="#cb64-1569" aria-hidden="true" tabindex="-1"></a>inset_hw_gg</span>
<span id="cb64-1570"><a href="#cb64-1570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1571"><a href="#cb64-1571" aria-hidden="true" tabindex="-1"></a><span class="do">### 2. 화성시 궁평항</span></span>
<span id="cb64-1572"><a href="#cb64-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1573"><a href="#cb64-1573" aria-hidden="true" tabindex="-1"></a>inset_hw_goongpyung_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-1574"><a href="#cb64-1574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> hw_adm_sf) <span class="sc">+</span>  </span>
<span id="cb64-1575"><a href="#cb64-1575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span> hw_ports_cell_sf, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb64-1576"><a href="#cb64-1576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"궁평항"</span>), <span class="at">size =</span> <span class="dv">3</span>, </span>
<span id="cb64-1577"><a href="#cb64-1577" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb64-1578"><a href="#cb64-1578" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1579"><a href="#cb64-1579" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"궁평항"</span>),</span>
<span id="cb64-1580"><a href="#cb64-1580" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> 어항명, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1581"><a href="#cb64-1581" aria-hidden="true" tabindex="-1"></a>      <span class="at">min.segment.length =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">family =</span> <span class="st">"MaruBrui"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb64-1582"><a href="#cb64-1582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>) <span class="sc">+</span></span>
<span id="cb64-1583"><a href="#cb64-1583" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(hw_ports_bbox[<span class="st">'xmin'</span>]<span class="sc">-</span><span class="dv">1000</span>, </span>
<span id="cb64-1584"><a href="#cb64-1584" aria-hidden="true" tabindex="-1"></a>                      hw_ports_bbox[<span class="st">'xmax'</span>]<span class="sc">+</span><span class="dv">1000</span>),</span>
<span id="cb64-1585"><a href="#cb64-1585" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylim =</span> <span class="fu">c</span>(hw_ports_bbox[<span class="st">'ymin'</span>]<span class="sc">-</span><span class="dv">1000</span>, </span>
<span id="cb64-1586"><a href="#cb64-1586" aria-hidden="true" tabindex="-1"></a>                      hw_ports_bbox[<span class="st">'ymax'</span>]<span class="sc">+</span><span class="dv">1000</span>)) <span class="sc">+</span></span>
<span id="cb64-1587"><a href="#cb64-1587" aria-hidden="true" tabindex="-1"></a>  ggspatial<span class="sc">::</span><span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">"br"</span>, <span class="at">width_hint =</span> <span class="fl">0.5</span>,</span>
<span id="cb64-1588"><a href="#cb64-1588" aria-hidden="true" tabindex="-1"></a>                               <span class="at">height =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>))</span>
<span id="cb64-1589"><a href="#cb64-1589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1590"><a href="#cb64-1590" aria-hidden="true" tabindex="-1"></a><span class="do">## 3. 화성시 + 궁평항 지도 -------------------------------  </span></span>
<span id="cb64-1591"><a href="#cb64-1591" aria-hidden="true" tabindex="-1"></a>goongpyung_port_inset_map <span class="ot">&lt;-</span> inset_hw_goongpyung_gg <span class="sc">+</span> </span>
<span id="cb64-1592"><a href="#cb64-1592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inset_element</span>(inset_hw_gg, <span class="fl">0.6</span>, <span class="fl">0.6</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="at">align_to =</span> <span class="st">'full'</span>) <span class="sc">+</span></span>
<span id="cb64-1593"><a href="#cb64-1593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">'화성시 궁평항 및 인근 1 KM지역'</span>)</span>
<span id="cb64-1594"><a href="#cb64-1594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1595"><a href="#cb64-1595" aria-hidden="true" tabindex="-1"></a>goongpyung_port_inset_map</span>
<span id="cb64-1596"><a href="#cb64-1596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1597"><a href="#cb64-1597" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_png</span>(<span class="st">"images/항구_통계/2_화성_궁평항_최종.png"</span>, </span>
<span id="cb64-1598"><a href="#cb64-1598" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-1599"><a href="#cb64-1599" aria-hidden="true" tabindex="-1"></a>goongpyung_port_inset_map</span>
<span id="cb64-1600"><a href="#cb64-1600" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-1601"><a href="#cb64-1601" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1602"><a href="#cb64-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1603"><a href="#cb64-1603" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/02_화성_궁평항_최종.png)</span></span>
<span id="cb64-1604"><a href="#cb64-1604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1605"><a href="#cb64-1605" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-1606"><a href="#cb64-1606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1607"><a href="#cb64-1607" aria-hidden="true" tabindex="-1"></a><span class="fu">## 안산시 탄도항</span></span>
<span id="cb64-1608"><a href="#cb64-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1609"><a href="#cb64-1609" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb64-1610"><a href="#cb64-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1611"><a href="#cb64-1611" aria-hidden="true" tabindex="-1"></a><span class="fu">### 안산시 위치</span></span>
<span id="cb64-1612"><a href="#cb64-1612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1613"><a href="#cb64-1613" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-1614"><a href="#cb64-1614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1615"><a href="#cb64-1615" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-1616"><a href="#cb64-1616" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb64-1617"><a href="#cb64-1617" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb64-1618"><a href="#cb64-1618" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb64-1619"><a href="#cb64-1619" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtExtras)</span>
<span id="cb64-1620"><a href="#cb64-1620" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb64-1621"><a href="#cb64-1621" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb64-1622"><a href="#cb64-1622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1623"><a href="#cb64-1623" aria-hidden="true" tabindex="-1"></a>katec_crs <span class="ot">&lt;-</span> <span class="st">"+proj=tmerc +lat_0=38 +lon_0=128 +k=0.9999 +x_0=400000 +y_0=600000 +ellps=bessel +units=m +no_defs"</span></span>
<span id="cb64-1624"><a href="#cb64-1624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1625"><a href="#cb64-1625" aria-hidden="true" tabindex="-1"></a>gg_admin_map <span class="ot">&lt;-</span> </span>
<span id="cb64-1626"><a href="#cb64-1626" aria-hidden="true" tabindex="-1"></a><span class="fu">st_read</span>(<span class="st">"data/(공통)셀블록도로행정동/행정동경계/행정동경계_경기도/tbshp_admi_gg_20210614.shp"</span>)</span>
<span id="cb64-1627"><a href="#cb64-1627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1628"><a href="#cb64-1628" aria-hidden="true" tabindex="-1"></a>gg_admin_map <span class="ot">&lt;-</span> gg_admin_map <span class="sc">|&gt;</span> <span class="fu">st_set_crs</span>(katec_crs)</span>
<span id="cb64-1629"><a href="#cb64-1629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1630"><a href="#cb64-1630" aria-hidden="true" tabindex="-1"></a>gg_city_map <span class="ot">&lt;-</span> gg_admin_map <span class="sc">|&gt;</span> </span>
<span id="cb64-1631"><a href="#cb64-1631" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb64-1632"><a href="#cb64-1632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cty_nm) <span class="sc">|&gt;</span> </span>
<span id="cb64-1633"><a href="#cb64-1633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">geometry =</span> <span class="fu">st_union</span>(geometry)) <span class="sc">|&gt;</span> </span>
<span id="cb64-1634"><a href="#cb64-1634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cty_target =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(cty_nm, <span class="st">"안산"</span>), <span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span>
<span id="cb64-1635"><a href="#cb64-1635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1636"><a href="#cb64-1636" aria-hidden="true" tabindex="-1"></a>gg_ansan_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-1637"><a href="#cb64-1637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> gg_city_map, <span class="fu">aes</span>(<span class="at">fill =</span> cty_target)) <span class="sc">+</span></span>
<span id="cb64-1638"><a href="#cb64-1638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>) <span class="sc">+</span></span>
<span id="cb64-1639"><a href="#cb64-1639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray90"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb64-1640"><a href="#cb64-1640" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1641"><a href="#cb64-1641" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> gg_city_map <span class="sc">|&gt;</span> <span class="fu">filter</span>(cty_target <span class="sc">==</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-1642"><a href="#cb64-1642" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> cty_nm, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1643"><a href="#cb64-1643" aria-hidden="true" tabindex="-1"></a>        <span class="at">min.segment.length =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>,</span>
<span id="cb64-1644"><a href="#cb64-1644" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="st">"MaruBrui"</span>) <span class="sc">+</span></span>
<span id="cb64-1645"><a href="#cb64-1645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb64-1646"><a href="#cb64-1646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1647"><a href="#cb64-1647" aria-hidden="true" tabindex="-1"></a>gg_ansan_gg</span>
<span id="cb64-1648"><a href="#cb64-1648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1649"><a href="#cb64-1649" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_jpeg</span>(<span class="st">"images/항구_통계/02_경기도_안산시.jpg"</span>, </span>
<span id="cb64-1650"><a href="#cb64-1650" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-1651"><a href="#cb64-1651" aria-hidden="true" tabindex="-1"></a>gg_ansan_gg</span>
<span id="cb64-1652"><a href="#cb64-1652" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-1653"><a href="#cb64-1653" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1654"><a href="#cb64-1654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1655"><a href="#cb64-1655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1656"><a href="#cb64-1656" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/02_경기도_안산시.jpg)</span></span>
<span id="cb64-1657"><a href="#cb64-1657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1658"><a href="#cb64-1658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1659"><a href="#cb64-1659" aria-hidden="true" tabindex="-1"></a><span class="fu">### 안산시 탄도항</span></span>
<span id="cb64-1660"><a href="#cb64-1660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1661"><a href="#cb64-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1662"><a href="#cb64-1662" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-1663"><a href="#cb64-1663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1664"><a href="#cb64-1664" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-1665"><a href="#cb64-1665" aria-hidden="true" tabindex="-1"></a><span class="do">## 안산시</span></span>
<span id="cb64-1666"><a href="#cb64-1666" aria-hidden="true" tabindex="-1"></a>ansan_adm_sf <span class="ot">&lt;-</span> gg_admin_map <span class="sc">|&gt;</span> <span class="fu">filter</span>(CTY_NM <span class="sc">==</span> <span class="st">"안산시"</span>)</span>
<span id="cb64-1667"><a href="#cb64-1667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1668"><a href="#cb64-1668" aria-hidden="true" tabindex="-1"></a><span class="do">## 항구</span></span>
<span id="cb64-1669"><a href="#cb64-1669" aria-hidden="true" tabindex="-1"></a>port_tbl <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/국가어항.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"경기어항"</span>)</span>
<span id="cb64-1670"><a href="#cb64-1670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1671"><a href="#cb64-1671" aria-hidden="true" tabindex="-1"></a>port_sf <span class="ot">&lt;-</span> port_tbl <span class="sc">|&gt;</span> </span>
<span id="cb64-1672"><a href="#cb64-1672" aria-hidden="true" tabindex="-1"></a>  <span class="co"># WGS84</span></span>
<span id="cb64-1673"><a href="#cb64-1673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>), <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-1674"><a href="#cb64-1674" aria-hidden="true" tabindex="-1"></a>  <span class="co"># KATEC</span></span>
<span id="cb64-1675"><a href="#cb64-1675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(katec_crs)</span>
<span id="cb64-1676"><a href="#cb64-1676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1677"><a href="#cb64-1677" aria-hidden="true" tabindex="-1"></a>gg_ansan_port_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-1678"><a href="#cb64-1678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> ansan_adm_sf) <span class="sc">+</span></span>
<span id="cb64-1679"><a href="#cb64-1679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>) <span class="sc">+</span></span>
<span id="cb64-1680"><a href="#cb64-1680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray90"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb64-1681"><a href="#cb64-1681" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1682"><a href="#cb64-1682" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> ansan_adm_sf,</span>
<span id="cb64-1683"><a href="#cb64-1683" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> ADMI_NM, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1684"><a href="#cb64-1684" aria-hidden="true" tabindex="-1"></a>      <span class="at">min.segment.length =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">family =</span> <span class="st">"MaruBrui"</span>) <span class="sc">+</span></span>
<span id="cb64-1685"><a href="#cb64-1685" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb64-1686"><a href="#cb64-1686" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data=</span>port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"탄도항"</span>), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb64-1687"><a href="#cb64-1687" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1688"><a href="#cb64-1688" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"탄도항"</span>),</span>
<span id="cb64-1689"><a href="#cb64-1689" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> 어항명, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1690"><a href="#cb64-1690" aria-hidden="true" tabindex="-1"></a>      <span class="at">min.segment.length =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">family =</span> <span class="st">"MaruBrui"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)   </span>
<span id="cb64-1691"><a href="#cb64-1691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1692"><a href="#cb64-1692" aria-hidden="true" tabindex="-1"></a>gg_ansan_port_gg</span>
<span id="cb64-1693"><a href="#cb64-1693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1694"><a href="#cb64-1694" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_jpeg</span>(<span class="st">"images/항구_통계/02_경기도_안산시_탄도항.jpg"</span>, </span>
<span id="cb64-1695"><a href="#cb64-1695" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-1696"><a href="#cb64-1696" aria-hidden="true" tabindex="-1"></a>gg_ansan_port_gg</span>
<span id="cb64-1697"><a href="#cb64-1697" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-1698"><a href="#cb64-1698" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1699"><a href="#cb64-1699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1700"><a href="#cb64-1700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1701"><a href="#cb64-1701" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/02_경기도_안산시_탄도항.jpg)</span></span>
<span id="cb64-1702"><a href="#cb64-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1703"><a href="#cb64-1703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1704"><a href="#cb64-1704" aria-hidden="true" tabindex="-1"></a><span class="fu">### 안산시 탄도항 인근 1 KM</span></span>
<span id="cb64-1705"><a href="#cb64-1705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1706"><a href="#cb64-1706" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-1707"><a href="#cb64-1707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1708"><a href="#cb64-1708" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-1709"><a href="#cb64-1709" aria-hidden="true" tabindex="-1"></a><span class="co"># cell_sf &lt;- st_read("data/(공통)셀블록도로행정동/셀(중심점)/cell_gg_admi2_20210616.shp")</span></span>
<span id="cb64-1710"><a href="#cb64-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1711"><a href="#cb64-1711" aria-hidden="true" tabindex="-1"></a>ansan_cty_cell_sf <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(cell_sf, katec_crs) <span class="sc">|&gt;</span> </span>
<span id="cb64-1712"><a href="#cb64-1712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CTY_CD <span class="sc">==</span> gg_admin_map <span class="sc">|&gt;</span> <span class="fu">filter</span>(CTY_NM <span class="sc">==</span> <span class="st">"안산시"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-1713"><a href="#cb64-1713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(CTY_CD) <span class="sc">|&gt;</span> <span class="fu">unique</span>())</span>
<span id="cb64-1714"><a href="#cb64-1714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1715"><a href="#cb64-1715" aria-hidden="true" tabindex="-1"></a><span class="do">## 항구 인근 1 KM</span></span>
<span id="cb64-1716"><a href="#cb64-1716" aria-hidden="true" tabindex="-1"></a>ansan_ports_cell_sf <span class="ot">&lt;-</span> <span class="fu">st_join</span>(ansan_cty_cell_sf,</span>
<span id="cb64-1717"><a href="#cb64-1717" aria-hidden="true" tabindex="-1"></a>                               port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"탄도항"</span>), </span>
<span id="cb64-1718"><a href="#cb64-1718" aria-hidden="true" tabindex="-1"></a>                         <span class="at">maxdist =</span> <span class="dv">1000</span>, </span>
<span id="cb64-1719"><a href="#cb64-1719" aria-hidden="true" tabindex="-1"></a>                         <span class="at">join =</span> nngeo<span class="sc">::</span>st_nn, <span class="at">left =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-1720"><a href="#cb64-1720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1721"><a href="#cb64-1721" aria-hidden="true" tabindex="-1"></a>ansan_ports_bbox <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(ansan_ports_cell_sf)</span>
<span id="cb64-1722"><a href="#cb64-1722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1723"><a href="#cb64-1723" aria-hidden="true" tabindex="-1"></a><span class="do">### 1. 안산시 Inset</span></span>
<span id="cb64-1724"><a href="#cb64-1724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1725"><a href="#cb64-1725" aria-hidden="true" tabindex="-1"></a>inset_ansan_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-1726"><a href="#cb64-1726" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 1. 행정동 ---------</span></span>
<span id="cb64-1727"><a href="#cb64-1727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> ansan_adm_sf) <span class="sc">+</span>  </span>
<span id="cb64-1728"><a href="#cb64-1728" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1729"><a href="#cb64-1729" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> ansan_adm_sf,</span>
<span id="cb64-1730"><a href="#cb64-1730" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> ADMI_NM, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1731"><a href="#cb64-1731" aria-hidden="true" tabindex="-1"></a>      <span class="at">min.segment.length =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">family =</span> <span class="st">"MaruBrui"</span>) <span class="sc">+</span></span>
<span id="cb64-1732"><a href="#cb64-1732" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb64-1733"><a href="#cb64-1733" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 2. 항구 ---------  </span></span>
<span id="cb64-1734"><a href="#cb64-1734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"탄도항"</span>), </span>
<span id="cb64-1735"><a href="#cb64-1735" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb64-1736"><a href="#cb64-1736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>)  <span class="sc">+</span></span>
<span id="cb64-1737"><a href="#cb64-1737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> ansan_ports_bbox[<span class="st">'xmin'</span>]<span class="sc">-</span><span class="dv">1000</span>, </span>
<span id="cb64-1738"><a href="#cb64-1738" aria-hidden="true" tabindex="-1"></a>                <span class="at">xmax =</span> ansan_ports_bbox[<span class="st">'xmax'</span>]<span class="sc">+</span><span class="dv">1000</span>, </span>
<span id="cb64-1739"><a href="#cb64-1739" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymin =</span> ansan_ports_bbox[<span class="st">'ymin'</span>]<span class="sc">-</span><span class="dv">1000</span>, </span>
<span id="cb64-1740"><a href="#cb64-1740" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymax =</span> ansan_ports_bbox[<span class="st">'ymax'</span>]<span class="sc">+</span><span class="dv">1000</span>), <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb64-1741"><a href="#cb64-1741" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb64-1742"><a href="#cb64-1742" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb64-1743"><a href="#cb64-1743" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"pt"</span>),</span>
<span id="cb64-1744"><a href="#cb64-1744" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb64-1745"><a href="#cb64-1745" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="st">"cm"</span>),</span>
<span id="cb64-1746"><a href="#cb64-1746" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>))</span>
<span id="cb64-1747"><a href="#cb64-1747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1748"><a href="#cb64-1748" aria-hidden="true" tabindex="-1"></a>inset_ansan_gg</span>
<span id="cb64-1749"><a href="#cb64-1749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1750"><a href="#cb64-1750" aria-hidden="true" tabindex="-1"></a><span class="do">### 2. 안산시 탄도항</span></span>
<span id="cb64-1751"><a href="#cb64-1751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1752"><a href="#cb64-1752" aria-hidden="true" tabindex="-1"></a>inset_ansan_tando_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-1753"><a href="#cb64-1753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> ansan_adm_sf) <span class="sc">+</span>  </span>
<span id="cb64-1754"><a href="#cb64-1754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span> ansan_ports_cell_sf, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb64-1755"><a href="#cb64-1755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"탄도항"</span>), <span class="at">size =</span> <span class="dv">3</span>, </span>
<span id="cb64-1756"><a href="#cb64-1756" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb64-1757"><a href="#cb64-1757" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1758"><a href="#cb64-1758" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"탄도항"</span>),</span>
<span id="cb64-1759"><a href="#cb64-1759" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> 어항명, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1760"><a href="#cb64-1760" aria-hidden="true" tabindex="-1"></a>      <span class="at">min.segment.length =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">family =</span> <span class="st">"MaruBrui"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb64-1761"><a href="#cb64-1761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>) <span class="sc">+</span></span>
<span id="cb64-1762"><a href="#cb64-1762" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(ansan_ports_bbox[<span class="st">'xmin'</span>]<span class="sc">-</span><span class="dv">1000</span>, </span>
<span id="cb64-1763"><a href="#cb64-1763" aria-hidden="true" tabindex="-1"></a>                      ansan_ports_bbox[<span class="st">'xmax'</span>]<span class="sc">+</span><span class="dv">1000</span>),</span>
<span id="cb64-1764"><a href="#cb64-1764" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylim =</span> <span class="fu">c</span>(ansan_ports_bbox[<span class="st">'ymin'</span>]<span class="sc">-</span><span class="dv">1000</span>, </span>
<span id="cb64-1765"><a href="#cb64-1765" aria-hidden="true" tabindex="-1"></a>                      ansan_ports_bbox[<span class="st">'ymax'</span>]<span class="sc">+</span><span class="dv">1000</span>)) <span class="sc">+</span></span>
<span id="cb64-1766"><a href="#cb64-1766" aria-hidden="true" tabindex="-1"></a>  ggspatial<span class="sc">::</span><span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">"br"</span>, <span class="at">width_hint =</span> <span class="fl">0.5</span>,</span>
<span id="cb64-1767"><a href="#cb64-1767" aria-hidden="true" tabindex="-1"></a>                               <span class="at">height =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>))</span>
<span id="cb64-1768"><a href="#cb64-1768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1769"><a href="#cb64-1769" aria-hidden="true" tabindex="-1"></a><span class="do">## 3. 안산시 + 탄도항 지도 -------------------------------  </span></span>
<span id="cb64-1770"><a href="#cb64-1770" aria-hidden="true" tabindex="-1"></a>tando_port_inset_map <span class="ot">&lt;-</span> inset_ansan_tando_gg <span class="sc">+</span> </span>
<span id="cb64-1771"><a href="#cb64-1771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inset_element</span>(inset_ansan_gg, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="at">align_to =</span> <span class="st">'full'</span>) <span class="sc">+</span></span>
<span id="cb64-1772"><a href="#cb64-1772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">'안산시 탄도항 및 인근 1 KM지역'</span>)</span>
<span id="cb64-1773"><a href="#cb64-1773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1774"><a href="#cb64-1774" aria-hidden="true" tabindex="-1"></a>tando_port_inset_map</span>
<span id="cb64-1775"><a href="#cb64-1775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1776"><a href="#cb64-1776" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_png</span>(<span class="st">"images/항구_통계/3_안산_탄도항_최종.png"</span>, </span>
<span id="cb64-1777"><a href="#cb64-1777" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-1778"><a href="#cb64-1778" aria-hidden="true" tabindex="-1"></a>tando_port_inset_map</span>
<span id="cb64-1779"><a href="#cb64-1779" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-1780"><a href="#cb64-1780" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1781"><a href="#cb64-1781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1782"><a href="#cb64-1782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1783"><a href="#cb64-1783" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/02_안산_탄도항_최종.png)</span></span>
<span id="cb64-1784"><a href="#cb64-1784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1785"><a href="#cb64-1785" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-1786"><a href="#cb64-1786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1787"><a href="#cb64-1787" aria-hidden="true" tabindex="-1"></a><span class="fu"># 대명항 유동인구, 결재금액</span></span>
<span id="cb64-1788"><a href="#cb64-1788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1789"><a href="#cb64-1789" aria-hidden="true" tabindex="-1"></a><span class="fu">## 김포시 대명항 위치</span></span>
<span id="cb64-1790"><a href="#cb64-1790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1791"><a href="#cb64-1791" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb64-1792"><a href="#cb64-1792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1793"><a href="#cb64-1793" aria-hidden="true" tabindex="-1"></a><span class="fu">### 김포시 위치</span></span>
<span id="cb64-1794"><a href="#cb64-1794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1795"><a href="#cb64-1795" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-1796"><a href="#cb64-1796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1797"><a href="#cb64-1797" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-1798"><a href="#cb64-1798" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb64-1799"><a href="#cb64-1799" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb64-1800"><a href="#cb64-1800" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb64-1801"><a href="#cb64-1801" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtExtras)</span>
<span id="cb64-1802"><a href="#cb64-1802" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb64-1803"><a href="#cb64-1803" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb64-1804"><a href="#cb64-1804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1805"><a href="#cb64-1805" aria-hidden="true" tabindex="-1"></a>katec_crs <span class="ot">&lt;-</span> <span class="st">"+proj=tmerc +lat_0=38 +lon_0=128 +k=0.9999 +x_0=400000 +y_0=600000 +ellps=bessel +units=m +no_defs"</span></span>
<span id="cb64-1806"><a href="#cb64-1806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1807"><a href="#cb64-1807" aria-hidden="true" tabindex="-1"></a>gg_admin_map <span class="ot">&lt;-</span> </span>
<span id="cb64-1808"><a href="#cb64-1808" aria-hidden="true" tabindex="-1"></a><span class="fu">st_read</span>(<span class="st">"data/(공통)셀블록도로행정동/행정동경계/행정동경계_경기도/tbshp_admi_gg_20210614.shp"</span>)</span>
<span id="cb64-1809"><a href="#cb64-1809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1810"><a href="#cb64-1810" aria-hidden="true" tabindex="-1"></a>gg_admin_map <span class="ot">&lt;-</span> gg_admin_map <span class="sc">|&gt;</span> <span class="fu">st_set_crs</span>(katec_crs)</span>
<span id="cb64-1811"><a href="#cb64-1811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1812"><a href="#cb64-1812" aria-hidden="true" tabindex="-1"></a>gg_city_map <span class="ot">&lt;-</span> gg_admin_map <span class="sc">|&gt;</span> </span>
<span id="cb64-1813"><a href="#cb64-1813" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb64-1814"><a href="#cb64-1814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cty_nm) <span class="sc">|&gt;</span> </span>
<span id="cb64-1815"><a href="#cb64-1815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">geometry =</span> <span class="fu">st_union</span>(geometry)) <span class="sc">|&gt;</span> </span>
<span id="cb64-1816"><a href="#cb64-1816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cty_target =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(cty_nm, <span class="st">"김포"</span>), <span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span>
<span id="cb64-1817"><a href="#cb64-1817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1818"><a href="#cb64-1818" aria-hidden="true" tabindex="-1"></a>gg_gimpo_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-1819"><a href="#cb64-1819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> gg_city_map, <span class="fu">aes</span>(<span class="at">fill =</span> cty_target)) <span class="sc">+</span></span>
<span id="cb64-1820"><a href="#cb64-1820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>) <span class="sc">+</span></span>
<span id="cb64-1821"><a href="#cb64-1821" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray90"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb64-1822"><a href="#cb64-1822" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1823"><a href="#cb64-1823" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> gg_city_map <span class="sc">|&gt;</span> <span class="fu">filter</span>(cty_target <span class="sc">==</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-1824"><a href="#cb64-1824" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> cty_nm, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1825"><a href="#cb64-1825" aria-hidden="true" tabindex="-1"></a>        <span class="at">min.segment.length =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>,</span>
<span id="cb64-1826"><a href="#cb64-1826" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="st">"MaruBrui"</span>) <span class="sc">+</span></span>
<span id="cb64-1827"><a href="#cb64-1827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb64-1828"><a href="#cb64-1828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1829"><a href="#cb64-1829" aria-hidden="true" tabindex="-1"></a>gg_gimpo_gg</span>
<span id="cb64-1830"><a href="#cb64-1830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1831"><a href="#cb64-1831" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_jpeg</span>(<span class="st">"images/항구_통계/02_경기도_김포시.jpg"</span>, </span>
<span id="cb64-1832"><a href="#cb64-1832" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-1833"><a href="#cb64-1833" aria-hidden="true" tabindex="-1"></a>gg_gimpo_gg</span>
<span id="cb64-1834"><a href="#cb64-1834" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-1835"><a href="#cb64-1835" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1836"><a href="#cb64-1836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1837"><a href="#cb64-1837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1838"><a href="#cb64-1838" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/02_경기도_김포시.jpg)</span></span>
<span id="cb64-1839"><a href="#cb64-1839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1840"><a href="#cb64-1840" aria-hidden="true" tabindex="-1"></a><span class="fu">### 김포시 대명항</span></span>
<span id="cb64-1841"><a href="#cb64-1841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1842"><a href="#cb64-1842" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-1843"><a href="#cb64-1843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1844"><a href="#cb64-1844" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-1845"><a href="#cb64-1845" aria-hidden="true" tabindex="-1"></a><span class="do">## 김포시 </span></span>
<span id="cb64-1846"><a href="#cb64-1846" aria-hidden="true" tabindex="-1"></a>gimpo_adm_sf <span class="ot">&lt;-</span> gg_admin_map <span class="sc">|&gt;</span> <span class="fu">filter</span>(CTY_NM <span class="sc">==</span> <span class="st">"김포시"</span>)</span>
<span id="cb64-1847"><a href="#cb64-1847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1848"><a href="#cb64-1848" aria-hidden="true" tabindex="-1"></a><span class="do">## 항구</span></span>
<span id="cb64-1849"><a href="#cb64-1849" aria-hidden="true" tabindex="-1"></a>port_tbl <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/국가어항.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"경기어항"</span>)</span>
<span id="cb64-1850"><a href="#cb64-1850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1851"><a href="#cb64-1851" aria-hidden="true" tabindex="-1"></a>port_sf <span class="ot">&lt;-</span> port_tbl <span class="sc">|&gt;</span> </span>
<span id="cb64-1852"><a href="#cb64-1852" aria-hidden="true" tabindex="-1"></a>  <span class="co"># WGS84</span></span>
<span id="cb64-1853"><a href="#cb64-1853" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>), <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-1854"><a href="#cb64-1854" aria-hidden="true" tabindex="-1"></a>  <span class="co"># KATEC</span></span>
<span id="cb64-1855"><a href="#cb64-1855" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(katec_crs)</span>
<span id="cb64-1856"><a href="#cb64-1856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1857"><a href="#cb64-1857" aria-hidden="true" tabindex="-1"></a>gg_gimpo_port_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-1858"><a href="#cb64-1858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> gimpo_adm_sf) <span class="sc">+</span></span>
<span id="cb64-1859"><a href="#cb64-1859" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>) <span class="sc">+</span></span>
<span id="cb64-1860"><a href="#cb64-1860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray90"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb64-1861"><a href="#cb64-1861" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1862"><a href="#cb64-1862" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> gimpo_adm_sf,</span>
<span id="cb64-1863"><a href="#cb64-1863" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> ADMI_NM, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1864"><a href="#cb64-1864" aria-hidden="true" tabindex="-1"></a>      <span class="at">min.segment.length =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">family =</span> <span class="st">"MaruBrui"</span>) <span class="sc">+</span></span>
<span id="cb64-1865"><a href="#cb64-1865" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb64-1866"><a href="#cb64-1866" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data=</span>port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"대명항"</span>), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb64-1867"><a href="#cb64-1867" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1868"><a href="#cb64-1868" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"대명항"</span>),</span>
<span id="cb64-1869"><a href="#cb64-1869" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> 어항명, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1870"><a href="#cb64-1870" aria-hidden="true" tabindex="-1"></a>      <span class="at">min.segment.length =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">family =</span> <span class="st">"MaruBrui"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)    </span>
<span id="cb64-1871"><a href="#cb64-1871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1872"><a href="#cb64-1872" aria-hidden="true" tabindex="-1"></a>gg_gimpo_port_gg</span>
<span id="cb64-1873"><a href="#cb64-1873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1874"><a href="#cb64-1874" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_jpeg</span>(<span class="st">"images/항구_통계/02_경기도_김포시_대명항.jpg"</span>, </span>
<span id="cb64-1875"><a href="#cb64-1875" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-1876"><a href="#cb64-1876" aria-hidden="true" tabindex="-1"></a>gg_gimpo_port_gg</span>
<span id="cb64-1877"><a href="#cb64-1877" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-1878"><a href="#cb64-1878" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1879"><a href="#cb64-1879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1880"><a href="#cb64-1880" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/02_경기도_김포시_대명항.jpg)</span></span>
<span id="cb64-1881"><a href="#cb64-1881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1882"><a href="#cb64-1882" aria-hidden="true" tabindex="-1"></a><span class="fu">### 대명항 인근 1 KM</span></span>
<span id="cb64-1883"><a href="#cb64-1883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1884"><a href="#cb64-1884" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-1885"><a href="#cb64-1885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1886"><a href="#cb64-1886" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-1887"><a href="#cb64-1887" aria-hidden="true" tabindex="-1"></a>cell_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/(공통)셀블록도로행정동/셀(중심점)/cell_gg_admi2_20210616.shp"</span>)</span>
<span id="cb64-1888"><a href="#cb64-1888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1889"><a href="#cb64-1889" aria-hidden="true" tabindex="-1"></a>gimpo_cty_cell_sf <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(cell_sf, katec_crs) <span class="sc">|&gt;</span> </span>
<span id="cb64-1890"><a href="#cb64-1890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CTY_CD <span class="sc">==</span> gg_admin_map <span class="sc">|&gt;</span> <span class="fu">filter</span>(CTY_NM <span class="sc">==</span> <span class="st">"김포시"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-1891"><a href="#cb64-1891" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(CTY_CD) <span class="sc">|&gt;</span> <span class="fu">unique</span>())</span>
<span id="cb64-1892"><a href="#cb64-1892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1893"><a href="#cb64-1893" aria-hidden="true" tabindex="-1"></a><span class="do">## 항구 인근 1 KM</span></span>
<span id="cb64-1894"><a href="#cb64-1894" aria-hidden="true" tabindex="-1"></a>gimpo_ports_cell_sf <span class="ot">&lt;-</span> <span class="fu">st_join</span>(gimpo_cty_cell_sf,</span>
<span id="cb64-1895"><a href="#cb64-1895" aria-hidden="true" tabindex="-1"></a>                               port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"대명항"</span>), </span>
<span id="cb64-1896"><a href="#cb64-1896" aria-hidden="true" tabindex="-1"></a>                         <span class="at">maxdist =</span> <span class="dv">1000</span>, </span>
<span id="cb64-1897"><a href="#cb64-1897" aria-hidden="true" tabindex="-1"></a>                         <span class="at">join =</span> nngeo<span class="sc">::</span>st_nn, <span class="at">left =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-1898"><a href="#cb64-1898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1899"><a href="#cb64-1899" aria-hidden="true" tabindex="-1"></a>gimpo_ports_cell_sf <span class="sc">|&gt;</span> </span>
<span id="cb64-1900"><a href="#cb64-1900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_rds</span>(<span class="st">"data/gimpo_ports_cell_sf.rds"</span>)</span>
<span id="cb64-1901"><a href="#cb64-1901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1902"><a href="#cb64-1902" aria-hidden="true" tabindex="-1"></a>gimpo_ports_bbox <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(gimpo_ports_cell_sf)</span>
<span id="cb64-1903"><a href="#cb64-1903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1904"><a href="#cb64-1904" aria-hidden="true" tabindex="-1"></a><span class="do">### 1. 김포시 Inset</span></span>
<span id="cb64-1905"><a href="#cb64-1905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1906"><a href="#cb64-1906" aria-hidden="true" tabindex="-1"></a>inset_gimpo_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-1907"><a href="#cb64-1907" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 1. 행정동 ---------</span></span>
<span id="cb64-1908"><a href="#cb64-1908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> gimpo_adm_sf) <span class="sc">+</span>  </span>
<span id="cb64-1909"><a href="#cb64-1909" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1910"><a href="#cb64-1910" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> gimpo_adm_sf,</span>
<span id="cb64-1911"><a href="#cb64-1911" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> ADMI_NM, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1912"><a href="#cb64-1912" aria-hidden="true" tabindex="-1"></a>      <span class="at">min.segment.length =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">family =</span> <span class="st">"MaruBrui"</span>) <span class="sc">+</span></span>
<span id="cb64-1913"><a href="#cb64-1913" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb64-1914"><a href="#cb64-1914" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 2. 항구 ---------  </span></span>
<span id="cb64-1915"><a href="#cb64-1915" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"대명항"</span>), </span>
<span id="cb64-1916"><a href="#cb64-1916" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb64-1917"><a href="#cb64-1917" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>)  <span class="sc">+</span></span>
<span id="cb64-1918"><a href="#cb64-1918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> gimpo_ports_bbox[<span class="st">'xmin'</span>]<span class="sc">-</span><span class="dv">1000</span>, </span>
<span id="cb64-1919"><a href="#cb64-1919" aria-hidden="true" tabindex="-1"></a>                <span class="at">xmax =</span> gimpo_ports_bbox[<span class="st">'xmax'</span>]<span class="sc">+</span><span class="dv">1000</span>, </span>
<span id="cb64-1920"><a href="#cb64-1920" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymin =</span> gimpo_ports_bbox[<span class="st">'ymin'</span>]<span class="sc">-</span><span class="dv">1000</span>, </span>
<span id="cb64-1921"><a href="#cb64-1921" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymax =</span> gimpo_ports_bbox[<span class="st">'ymax'</span>]<span class="sc">+</span><span class="dv">1000</span>), <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">color=</span><span class="st">"red"</span>)</span>
<span id="cb64-1922"><a href="#cb64-1922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1923"><a href="#cb64-1923" aria-hidden="true" tabindex="-1"></a>inset_gimpo_gg</span>
<span id="cb64-1924"><a href="#cb64-1924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1925"><a href="#cb64-1925" aria-hidden="true" tabindex="-1"></a><span class="do">### 2. 김포시 대명항</span></span>
<span id="cb64-1926"><a href="#cb64-1926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1927"><a href="#cb64-1927" aria-hidden="true" tabindex="-1"></a>inset_gimpo_daemyung_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-1928"><a href="#cb64-1928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> gimpo_adm_sf) <span class="sc">+</span>  </span>
<span id="cb64-1929"><a href="#cb64-1929" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span> gimpo_ports_cell_sf, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb64-1930"><a href="#cb64-1930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"대명항"</span>), <span class="at">size =</span> <span class="dv">3</span>, </span>
<span id="cb64-1931"><a href="#cb64-1931" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb64-1932"><a href="#cb64-1932" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb64-1933"><a href="#cb64-1933" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> port_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(어항명 <span class="sc">==</span> <span class="st">"대명항"</span>),</span>
<span id="cb64-1934"><a href="#cb64-1934" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> 어항명, <span class="at">geometry =</span> geometry), <span class="at">stat =</span> <span class="st">"sf_coordinates"</span>, </span>
<span id="cb64-1935"><a href="#cb64-1935" aria-hidden="true" tabindex="-1"></a>      <span class="at">min.segment.length =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">family =</span> <span class="st">"MaruBrui"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb64-1936"><a href="#cb64-1936" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>(<span class="at">base_family =</span> <span class="st">"MaruBuri"</span>) <span class="sc">+</span></span>
<span id="cb64-1937"><a href="#cb64-1937" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(gimpo_ports_bbox[<span class="st">'xmin'</span>]<span class="sc">-</span><span class="dv">1000</span>, </span>
<span id="cb64-1938"><a href="#cb64-1938" aria-hidden="true" tabindex="-1"></a>                      gimpo_ports_bbox[<span class="st">'xmax'</span>]<span class="sc">+</span><span class="dv">1000</span>),</span>
<span id="cb64-1939"><a href="#cb64-1939" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylim =</span> <span class="fu">c</span>(gimpo_ports_bbox[<span class="st">'ymin'</span>]<span class="sc">-</span><span class="dv">1000</span>, </span>
<span id="cb64-1940"><a href="#cb64-1940" aria-hidden="true" tabindex="-1"></a>                      gimpo_ports_bbox[<span class="st">'ymax'</span>]<span class="sc">+</span><span class="dv">1000</span>)) <span class="sc">+</span></span>
<span id="cb64-1941"><a href="#cb64-1941" aria-hidden="true" tabindex="-1"></a>  ggspatial<span class="sc">::</span><span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">"br"</span>, <span class="at">width_hint =</span> <span class="fl">0.5</span>,</span>
<span id="cb64-1942"><a href="#cb64-1942" aria-hidden="true" tabindex="-1"></a>                               <span class="at">height =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>))</span>
<span id="cb64-1943"><a href="#cb64-1943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1944"><a href="#cb64-1944" aria-hidden="true" tabindex="-1"></a><span class="do">## 3. 김포시 + 대명항 지도 -------------------------------  </span></span>
<span id="cb64-1945"><a href="#cb64-1945" aria-hidden="true" tabindex="-1"></a>daemyung_port_inset_map <span class="ot">&lt;-</span> inset_gimpo_daemyung_gg <span class="sc">+</span> </span>
<span id="cb64-1946"><a href="#cb64-1946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inset_element</span>(inset_gimpo_gg, <span class="fl">0.6</span>, <span class="fl">0.6</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="at">align_to =</span> <span class="st">'full'</span>) <span class="sc">+</span></span>
<span id="cb64-1947"><a href="#cb64-1947" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">'김포시 대명항 및 인근 1 KM지역'</span>)</span>
<span id="cb64-1948"><a href="#cb64-1948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1949"><a href="#cb64-1949" aria-hidden="true" tabindex="-1"></a>daemyung_port_inset_map</span>
<span id="cb64-1950"><a href="#cb64-1950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1951"><a href="#cb64-1951" aria-hidden="true" tabindex="-1"></a>fs<span class="sc">::</span><span class="fu">dir_create</span>(<span class="st">"images/항구_통계/"</span>)</span>
<span id="cb64-1952"><a href="#cb64-1952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1953"><a href="#cb64-1953" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_png</span>(<span class="st">"images/항구_통계/2_김포_대명항_최종.png"</span>, </span>
<span id="cb64-1954"><a href="#cb64-1954" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-1955"><a href="#cb64-1955" aria-hidden="true" tabindex="-1"></a>daemyung_port_inset_map</span>
<span id="cb64-1956"><a href="#cb64-1956" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-1957"><a href="#cb64-1957" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1958"><a href="#cb64-1958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1959"><a href="#cb64-1959" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/02_김포_대명항_최종.png)</span></span>
<span id="cb64-1960"><a href="#cb64-1960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1961"><a href="#cb64-1961" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-1962"><a href="#cb64-1962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1963"><a href="#cb64-1963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1964"><a href="#cb64-1964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1965"><a href="#cb64-1965" aria-hidden="true" tabindex="-1"></a><span class="fu">## 유동인구</span></span>
<span id="cb64-1966"><a href="#cb64-1966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1967"><a href="#cb64-1967" aria-hidden="true" tabindex="-1"></a><span class="fu">### KT 데이터</span></span>
<span id="cb64-1968"><a href="#cb64-1968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1969"><a href="#cb64-1969" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-1970"><a href="#cb64-1970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1971"><a href="#cb64-1971" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-1972"><a href="#cb64-1972" aria-hidden="true" tabindex="-1"></a><span class="do">## 1. 대상파일</span></span>
<span id="cb64-1973"><a href="#cb64-1973" aria-hidden="true" tabindex="-1"></a>kt_cell_files_raw <span class="ot">&lt;-</span> fs<span class="sc">::</span><span class="fu">dir_ls</span>(<span class="st">"data/KT유동인구데이터/셀단위/sex_age/"</span>)</span>
<span id="cb64-1974"><a href="#cb64-1974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1975"><a href="#cb64-1975" aria-hidden="true" tabindex="-1"></a>kt_cell_files_raw <span class="ot">&lt;-</span> kt_cell_files_raw[<span class="fu">str_detect</span>(kt_cell_files_raw, <span class="st">"sex_age_</span><span class="sc">\\</span><span class="st">d{6}"</span>)]</span>
<span id="cb64-1976"><a href="#cb64-1976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1977"><a href="#cb64-1977" aria-hidden="true" tabindex="-1"></a><span class="do">## 2. 함수</span></span>
<span id="cb64-1978"><a href="#cb64-1978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1979"><a href="#cb64-1979" aria-hidden="true" tabindex="-1"></a>point_map <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/sgg_cell_point/광명시.geojson"</span>)</span>
<span id="cb64-1980"><a href="#cb64-1980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1981"><a href="#cb64-1981" aria-hidden="true" tabindex="-1"></a>get_sex_age <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">yearmon=</span><span class="st">"data/KT유동인구데이터/셀단위/sex_age/sex_age_201801.csv"</span>) {</span>
<span id="cb64-1982"><a href="#cb64-1982" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-1983"><a href="#cb64-1983" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> ------------------</span><span class="sc">\n</span><span class="st">"</span>, yearmon, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb64-1984"><a href="#cb64-1984" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-1985"><a href="#cb64-1985" aria-hidden="true" tabindex="-1"></a>  sex_age_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(yearmon)</span>
<span id="cb64-1986"><a href="#cb64-1986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1987"><a href="#cb64-1987" aria-hidden="true" tabindex="-1"></a>  km_sex_age <span class="ot">&lt;-</span> sex_age_raw <span class="sc">%&gt;%</span> </span>
<span id="cb64-1988"><a href="#cb64-1988" aria-hidden="true" tabindex="-1"></a>      <span class="do">## 광명시만 추출</span></span>
<span id="cb64-1989"><a href="#cb64-1989" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(cell_id <span class="sc">%in%</span> <span class="fu">unique</span>(point_map<span class="sc">$</span>cell_id)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-1990"><a href="#cb64-1990" aria-hidden="true" tabindex="-1"></a>    <span class="do">## 자료구조 변환</span></span>
<span id="cb64-1991"><a href="#cb64-1991" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> M00_09<span class="sc">:</span>F60_up, <span class="at">names_to =</span> <span class="st">"name"</span>, <span class="at">values_to =</span> <span class="st">"인구수"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-1992"><a href="#cb64-1992" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(성별 <span class="ot">=</span> <span class="fu">str_sub</span>(name, <span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb64-1993"><a href="#cb64-1993" aria-hidden="true" tabindex="-1"></a>           연령대 <span class="ot">=</span> <span class="fu">str_sub</span>(name, <span class="dv">2</span>, <span class="dv">6</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-1994"><a href="#cb64-1994" aria-hidden="true" tabindex="-1"></a>    <span class="do">## 자료형 변환</span></span>
<span id="cb64-1995"><a href="#cb64-1995" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(연령대 <span class="ot">=</span> <span class="fu">factor</span>(연령대, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"00_09"</span>, <span class="st">"10_19"</span>, <span class="st">"20_29"</span>, <span class="st">"30_39"</span>, <span class="st">"40_49"</span>, <span class="st">"50_59"</span>, <span class="st">"60_up"</span>)),</span>
<span id="cb64-1996"><a href="#cb64-1996" aria-hidden="true" tabindex="-1"></a>           성별 <span class="ot">=</span> <span class="fu">factor</span>(성별, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"F"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"남성"</span>, <span class="st">"여성"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb64-1997"><a href="#cb64-1997" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>name)</span>
<span id="cb64-1998"><a href="#cb64-1998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1999"><a href="#cb64-1999" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(km_sex_age)</span>
<span id="cb64-2000"><a href="#cb64-2000" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-2001"><a href="#cb64-2001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2002"><a href="#cb64-2002" aria-hidden="true" tabindex="-1"></a><span class="fu">get_sex_age</span>()</span>
<span id="cb64-2003"><a href="#cb64-2003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2004"><a href="#cb64-2004" aria-hidden="true" tabindex="-1"></a><span class="do">## 3. 김포시 데이터</span></span>
<span id="cb64-2005"><a href="#cb64-2005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2006"><a href="#cb64-2006" aria-hidden="true" tabindex="-1"></a>kt_cell_files <span class="ot">&lt;-</span> kt_cell_files_raw <span class="sc">%&gt;%</span> </span>
<span id="cb64-2007"><a href="#cb64-2007" aria-hidden="true" tabindex="-1"></a>  <span class="fu">enframe</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-2008"><a href="#cb64-2008" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 2018~2022년만 추출</span></span>
<span id="cb64-2009"><a href="#cb64-2009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(년월 <span class="ot">=</span> <span class="fu">str_sub</span>(<span class="fu">str_extract</span>(name, <span class="st">"</span><span class="sc">\\</span><span class="st">d+"</span>), <span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-2010"><a href="#cb64-2010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>년월 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"2017"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-2011"><a href="#cb64-2011" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 2018~2022년만 추출</span></span>
<span id="cb64-2012"><a href="#cb64-2012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(년월 <span class="ot">=</span> <span class="fu">str_sub</span>(<span class="fu">str_extract</span>(name, <span class="st">"</span><span class="sc">\\</span><span class="st">d+"</span>), <span class="dv">1</span>, <span class="dv">6</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-2013"><a href="#cb64-2013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(년월 <span class="ot">=</span> lubridate<span class="sc">::</span><span class="fu">ym</span>(년월))</span>
<span id="cb64-2014"><a href="#cb64-2014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2015"><a href="#cb64-2015" aria-hidden="true" tabindex="-1"></a>age_sex_yearmon <span class="ot">&lt;-</span> kt_cell_files  <span class="sc">%&gt;%</span> </span>
<span id="cb64-2016"><a href="#cb64-2016" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(name, get_sex_age))</span>
<span id="cb64-2017"><a href="#cb64-2017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2018"><a href="#cb64-2018" aria-hidden="true" tabindex="-1"></a>age_sex_yearmon <span class="sc">|&gt;</span> </span>
<span id="cb64-2019"><a href="#cb64-2019" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_rds</span>(<span class="st">"data/gimpo_age_sex_2018_2022.rds"</span>)</span>
<span id="cb64-2020"><a href="#cb64-2020" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2021"><a href="#cb64-2021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2022"><a href="#cb64-2022" aria-hidden="true" tabindex="-1"></a><span class="fu">### 대명항 1 KM 유동인구</span></span>
<span id="cb64-2023"><a href="#cb64-2023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2024"><a href="#cb64-2024" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-2025"><a href="#cb64-2025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2026"><a href="#cb64-2026" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-2027"><a href="#cb64-2027" aria-hidden="true" tabindex="-1"></a>gimpo_ports_cell_sf <span class="ot">&lt;-</span> </span>
<span id="cb64-2028"><a href="#cb64-2028" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_rds</span>(<span class="st">"data/gimpo_ports_cell_sf.rds"</span>)</span>
<span id="cb64-2029"><a href="#cb64-2029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2030"><a href="#cb64-2030" aria-hidden="true" tabindex="-1"></a>port_cell_id <span class="ot">&lt;-</span> gimpo_ports_cell_sf <span class="sc">|&gt;</span> </span>
<span id="cb64-2031"><a href="#cb64-2031" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(cell_id) <span class="sc">|&gt;</span> </span>
<span id="cb64-2032"><a href="#cb64-2032" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb64-2033"><a href="#cb64-2033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2034"><a href="#cb64-2034" aria-hidden="true" tabindex="-1"></a>age_sex_yearmon <span class="ot">&lt;-</span> </span>
<span id="cb64-2035"><a href="#cb64-2035" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_rds</span>(<span class="st">"data/gimpo_age_sex_2018_2022.rds"</span>)</span>
<span id="cb64-2036"><a href="#cb64-2036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2037"><a href="#cb64-2037" aria-hidden="true" tabindex="-1"></a>age_sex_yearmon_tbl <span class="ot">&lt;-</span> age_sex_yearmon <span class="sc">|&gt;</span> </span>
<span id="cb64-2038"><a href="#cb64-2038" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(년월, data) <span class="sc">|&gt;</span> </span>
<span id="cb64-2039"><a href="#cb64-2039" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data)</span>
<span id="cb64-2040"><a href="#cb64-2040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2041"><a href="#cb64-2041" aria-hidden="true" tabindex="-1"></a>port_age_sex_tbl <span class="ot">&lt;-</span> age_sex_yearmon_tbl <span class="sc">|&gt;</span> </span>
<span id="cb64-2042"><a href="#cb64-2042" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cell_id <span class="sc">%in%</span> port_cell_id)</span>
<span id="cb64-2043"><a href="#cb64-2043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2044"><a href="#cb64-2044" aria-hidden="true" tabindex="-1"></a>port_age_sex_tbl <span class="sc">|&gt;</span> </span>
<span id="cb64-2045"><a href="#cb64-2045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_rds</span>(<span class="st">"data/port_age_sex_tbl.rds"</span>)</span>
<span id="cb64-2046"><a href="#cb64-2046" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2047"><a href="#cb64-2047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2048"><a href="#cb64-2048" aria-hidden="true" tabindex="-1"></a><span class="fu">## 유동인구 분석</span></span>
<span id="cb64-2049"><a href="#cb64-2049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2050"><a href="#cb64-2050" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb64-2051"><a href="#cb64-2051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2052"><a href="#cb64-2052" aria-hidden="true" tabindex="-1"></a><span class="fu">### 성별</span></span>
<span id="cb64-2053"><a href="#cb64-2053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2054"><a href="#cb64-2054" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-2055"><a href="#cb64-2055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2056"><a href="#cb64-2056" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-2057"><a href="#cb64-2057" aria-hidden="true" tabindex="-1"></a>extrafont<span class="sc">::</span><span class="fu">loadfonts</span>()</span>
<span id="cb64-2058"><a href="#cb64-2058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2059"><a href="#cb64-2059" aria-hidden="true" tabindex="-1"></a>port_age_sex_tbl <span class="ot">&lt;-</span> </span>
<span id="cb64-2060"><a href="#cb64-2060" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_rds</span>(<span class="st">"data/port_age_sex_tbl.rds"</span>)</span>
<span id="cb64-2061"><a href="#cb64-2061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2062"><a href="#cb64-2062" aria-hidden="true" tabindex="-1"></a>port_kt_sex_gg <span class="ot">&lt;-</span> port_age_sex_tbl <span class="sc">|&gt;</span> </span>
<span id="cb64-2063"><a href="#cb64-2063" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(년월, 성별) <span class="sc">|&gt;</span> </span>
<span id="cb64-2064"><a href="#cb64-2064" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(유동인구 <span class="ot">=</span> <span class="fu">sum</span>(인구수) <span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-2065"><a href="#cb64-2065" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> 년월, <span class="at">y =</span> 유동인구, <span class="at">color =</span> 성별)) <span class="sc">+</span></span>
<span id="cb64-2066"><a href="#cb64-2066" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb64-2067"><a href="#cb64-2067" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb64-2068"><a href="#cb64-2068" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"MaruBrui"</span>) <span class="sc">+</span></span>
<span id="cb64-2069"><a href="#cb64-2069" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"김포시 대명항 인근 1 KM 유동인구"</span>,</span>
<span id="cb64-2070"><a href="#cb64-2070" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"성별, 2018년 1월 ~ 2022년 12월"</span>,</span>
<span id="cb64-2071"><a href="#cb64-2071" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"자료출처: 경기도 분석센터 KT 유동인구"</span>,</span>
<span id="cb64-2072"><a href="#cb64-2072" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb64-2073"><a href="#cb64-2073" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"유동인구 (만명)"</span>) <span class="sc">+</span></span>
<span id="cb64-2074"><a href="#cb64-2074" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb64-2075"><a href="#cb64-2075" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"black"</span>))</span>
<span id="cb64-2076"><a href="#cb64-2076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2077"><a href="#cb64-2077" aria-hidden="true" tabindex="-1"></a>port_kt_sex_gg</span>
<span id="cb64-2078"><a href="#cb64-2078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2079"><a href="#cb64-2079" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_jpeg</span>(<span class="st">"images/항구_통계/김포_대명항_유동인구_성별.jpg"</span>, </span>
<span id="cb64-2080"><a href="#cb64-2080" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-2081"><a href="#cb64-2081" aria-hidden="true" tabindex="-1"></a>port_kt_sex_gg</span>
<span id="cb64-2082"><a href="#cb64-2082" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-2083"><a href="#cb64-2083" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2084"><a href="#cb64-2084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2085"><a href="#cb64-2085" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/김포_대명항_유동인구_성별.jpg)</span></span>
<span id="cb64-2086"><a href="#cb64-2086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2087"><a href="#cb64-2087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2088"><a href="#cb64-2088" aria-hidden="true" tabindex="-1"></a><span class="fu">### 연령별</span></span>
<span id="cb64-2089"><a href="#cb64-2089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2090"><a href="#cb64-2090" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-2091"><a href="#cb64-2091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2092"><a href="#cb64-2092" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-2093"><a href="#cb64-2093" aria-hidden="true" tabindex="-1"></a>port_kt_age_gg <span class="ot">&lt;-</span> port_age_sex_tbl <span class="sc">|&gt;</span> </span>
<span id="cb64-2094"><a href="#cb64-2094" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(년월,연령대) <span class="sc">|&gt;</span> </span>
<span id="cb64-2095"><a href="#cb64-2095" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(유동인구 <span class="ot">=</span> <span class="fu">sum</span>(인구수) <span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-2096"><a href="#cb64-2096" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb64-2097"><a href="#cb64-2097" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> 년월, <span class="at">y =</span> 유동인구, <span class="at">color =</span> 연령대)) <span class="sc">+</span></span>
<span id="cb64-2098"><a href="#cb64-2098" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb64-2099"><a href="#cb64-2099" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb64-2100"><a href="#cb64-2100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"MaruBrui"</span>) <span class="sc">+</span></span>
<span id="cb64-2101"><a href="#cb64-2101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"김포시 대명항 인근 1 KM 유동인구"</span>,</span>
<span id="cb64-2102"><a href="#cb64-2102" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"연령별, 2018년 1월 ~ 2022년 12월"</span>,</span>
<span id="cb64-2103"><a href="#cb64-2103" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"자료출처: 경기도 분석센터 KT 유동인구"</span>,</span>
<span id="cb64-2104"><a href="#cb64-2104" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb64-2105"><a href="#cb64-2105" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"유동인구 (만명)"</span>) <span class="sc">+</span></span>
<span id="cb64-2106"><a href="#cb64-2106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb64-2107"><a href="#cb64-2107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>))  </span>
<span id="cb64-2108"><a href="#cb64-2108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2109"><a href="#cb64-2109" aria-hidden="true" tabindex="-1"></a>port_kt_age_gg</span>
<span id="cb64-2110"><a href="#cb64-2110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2111"><a href="#cb64-2111" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_jpeg</span>(<span class="st">"images/항구_통계/김포_대명항_유동인구_연령별.jpg"</span>, </span>
<span id="cb64-2112"><a href="#cb64-2112" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-2113"><a href="#cb64-2113" aria-hidden="true" tabindex="-1"></a>port_kt_age_gg</span>
<span id="cb64-2114"><a href="#cb64-2114" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-2115"><a href="#cb64-2115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2116"><a href="#cb64-2116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2117"><a href="#cb64-2117" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/김포_대명항_유동인구_연령별.jpg)</span></span>
<span id="cb64-2118"><a href="#cb64-2118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2119"><a href="#cb64-2119" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-2120"><a href="#cb64-2120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2121"><a href="#cb64-2121" aria-hidden="true" tabindex="-1"></a><span class="fu">## 매출금액</span></span>
<span id="cb64-2122"><a href="#cb64-2122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2123"><a href="#cb64-2123" aria-hidden="true" tabindex="-1"></a><span class="fu">###  데이터</span></span>
<span id="cb64-2124"><a href="#cb64-2124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2125"><a href="#cb64-2125" aria-hidden="true" tabindex="-1"></a><span class="fu">#### BC 카드</span></span>
<span id="cb64-2126"><a href="#cb64-2126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2127"><a href="#cb64-2127" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-2128"><a href="#cb64-2128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2129"><a href="#cb64-2129" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-2130"><a href="#cb64-2130" aria-hidden="true" tabindex="-1"></a><span class="do">## 1. 대상파일</span></span>
<span id="cb64-2131"><a href="#cb64-2131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2132"><a href="#cb64-2132" aria-hidden="true" tabindex="-1"></a>amt_files <span class="ot">&lt;-</span> fs<span class="sc">::</span><span class="fu">dir_ls</span>(<span class="st">"data/BC카드데이터/TBSH_GYEONGGI_SELNG/"</span>)</span>
<span id="cb64-2133"><a href="#cb64-2133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2134"><a href="#cb64-2134" aria-hidden="true" tabindex="-1"></a>amt_raw <span class="ot">&lt;-</span> amt_files <span class="sc">%&gt;%</span> </span>
<span id="cb64-2135"><a href="#cb64-2135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">enframe</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-2136"><a href="#cb64-2136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(value, read_delim)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-2137"><a href="#cb64-2137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, data) <span class="sc">%&gt;%</span> </span>
<span id="cb64-2138"><a href="#cb64-2138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">str_extract</span>(name, <span class="st">"</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">.txt$"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-2139"><a href="#cb64-2139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data)</span>
<span id="cb64-2140"><a href="#cb64-2140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2141"><a href="#cb64-2141" aria-hidden="true" tabindex="-1"></a>amt_tbl <span class="ot">&lt;-</span> amt_raw <span class="sc">%&gt;%</span> </span>
<span id="cb64-2142"><a href="#cb64-2142" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-2143"><a href="#cb64-2143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ta_ym =</span> lubridate<span class="sc">::</span><span class="fu">ym</span>(ta_ym))</span>
<span id="cb64-2144"><a href="#cb64-2144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2145"><a href="#cb64-2145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2146"><a href="#cb64-2146" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 셀_블록</span></span>
<span id="cb64-2147"><a href="#cb64-2147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2148"><a href="#cb64-2148" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-2149"><a href="#cb64-2149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2150"><a href="#cb64-2150" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-2151"><a href="#cb64-2151" aria-hidden="true" tabindex="-1"></a>cell_blk_raw <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"data/(공통)셀블록도로행정동/셀_블록_행정동/kt_cell_v6_20210528.csv"</span>)</span>
<span id="cb64-2152"><a href="#cb64-2152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2153"><a href="#cb64-2153" aria-hidden="true" tabindex="-1"></a>port_cell_blk_raw <span class="ot">&lt;-</span> cell_blk_raw <span class="sc">|&gt;</span> </span>
<span id="cb64-2154"><a href="#cb64-2154" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb64-2155"><a href="#cb64-2155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">cell_id =</span> id) <span class="sc">|&gt;</span>   </span>
<span id="cb64-2156"><a href="#cb64-2156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cell_id <span class="sc">%in%</span> port_cell_id) </span>
<span id="cb64-2157"><a href="#cb64-2157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2158"><a href="#cb64-2158" aria-hidden="true" tabindex="-1"></a>port_cell_blk_cd <span class="ot">&lt;-</span> port_cell_blk_raw <span class="sc">|&gt;</span> </span>
<span id="cb64-2159"><a href="#cb64-2159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(blk_cd) <span class="sc">|&gt;</span> <span class="fu">unique</span>()</span>
<span id="cb64-2160"><a href="#cb64-2160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2161"><a href="#cb64-2161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2162"><a href="#cb64-2162" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 대명항 인근 1 KM</span></span>
<span id="cb64-2163"><a href="#cb64-2163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2164"><a href="#cb64-2164" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-2165"><a href="#cb64-2165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2166"><a href="#cb64-2166" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-2167"><a href="#cb64-2167" aria-hidden="true" tabindex="-1"></a>port_amt_tbl <span class="ot">&lt;-</span> amt_tbl <span class="sc">|&gt;</span> </span>
<span id="cb64-2168"><a href="#cb64-2168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(blk_cd <span class="sc">%in%</span> port_cell_blk_cd)</span>
<span id="cb64-2169"><a href="#cb64-2169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2170"><a href="#cb64-2170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2171"><a href="#cb64-2171" aria-hidden="true" tabindex="-1"></a><span class="fu">## 결재금액 분석</span></span>
<span id="cb64-2172"><a href="#cb64-2172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2173"><a href="#cb64-2173" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb64-2174"><a href="#cb64-2174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2175"><a href="#cb64-2175" aria-hidden="true" tabindex="-1"></a><span class="fu">### 연도별</span></span>
<span id="cb64-2176"><a href="#cb64-2176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2177"><a href="#cb64-2177" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-2178"><a href="#cb64-2178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2179"><a href="#cb64-2179" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-2180"><a href="#cb64-2180" aria-hidden="true" tabindex="-1"></a>bc_yearmon_gg <span class="ot">&lt;-</span> port_amt_tbl <span class="sc">|&gt;</span> </span>
<span id="cb64-2181"><a href="#cb64-2181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ta_ym) <span class="sc">|&gt;</span> </span>
<span id="cb64-2182"><a href="#cb64-2182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(결재건수 <span class="ot">=</span> <span class="fu">sum</span>(total_cnt)<span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>,</span>
<span id="cb64-2183"><a href="#cb64-2183" aria-hidden="true" tabindex="-1"></a>            결재금액 <span class="ot">=</span> <span class="fu">sum</span>(total_amt)<span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">8</span>,) <span class="sc">|&gt;</span> </span>
<span id="cb64-2184"><a href="#cb64-2184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ta_ym, <span class="at">y =</span> 결재금액)) <span class="sc">+</span></span>
<span id="cb64-2185"><a href="#cb64-2185" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb64-2186"><a href="#cb64-2186" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb64-2187"><a href="#cb64-2187" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>(<span class="at">base_family =</span> <span class="st">"MaruBrui"</span>) <span class="sc">+</span></span>
<span id="cb64-2188"><a href="#cb64-2188" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"김포시 대명항 인근 1 KM 결재금액"</span>,</span>
<span id="cb64-2189"><a href="#cb64-2189" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"연령별, 2018년 1월 ~ 2022년 12월"</span>,</span>
<span id="cb64-2190"><a href="#cb64-2190" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"자료출처: 경기도 분석센터 KT 유동인구"</span>,</span>
<span id="cb64-2191"><a href="#cb64-2191" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb64-2192"><a href="#cb64-2192" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"결재금액(억원)"</span>) <span class="sc">+</span></span>
<span id="cb64-2193"><a href="#cb64-2193" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb64-2194"><a href="#cb64-2194" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>)) </span>
<span id="cb64-2195"><a href="#cb64-2195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2196"><a href="#cb64-2196" aria-hidden="true" tabindex="-1"></a>bc_yearmon_gg</span>
<span id="cb64-2197"><a href="#cb64-2197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2198"><a href="#cb64-2198" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_jpeg</span>(<span class="st">"images/항구_통계/김포_대명항_결재금액.jpg"</span>, </span>
<span id="cb64-2199"><a href="#cb64-2199" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-2200"><a href="#cb64-2200" aria-hidden="true" tabindex="-1"></a>bc_yearmon_gg</span>
<span id="cb64-2201"><a href="#cb64-2201" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-2202"><a href="#cb64-2202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2203"><a href="#cb64-2203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2204"><a href="#cb64-2204" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/김포_대명항_결재금액.jpg)</span></span>
<span id="cb64-2205"><a href="#cb64-2205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2206"><a href="#cb64-2206" aria-hidden="true" tabindex="-1"></a><span class="fu">### 음식점별</span></span>
<span id="cb64-2207"><a href="#cb64-2207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2208"><a href="#cb64-2208" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb64-2209"><a href="#cb64-2209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2210"><a href="#cb64-2210" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb64-2211"><a href="#cb64-2211" aria-hidden="true" tabindex="-1"></a>code_table <span class="ot">&lt;-</span> <span class="fu">tribble</span>(<span class="sc">~</span><span class="st">"mer_buz_code"</span>, <span class="sc">~</span><span class="st">"업종명"</span>,</span>
<span id="cb64-2212"><a href="#cb64-2212" aria-hidden="true" tabindex="-1"></a><span class="dv">8001</span>,   <span class="st">"일반한식"</span>,</span>
<span id="cb64-2213"><a href="#cb64-2213" aria-hidden="true" tabindex="-1"></a><span class="dv">8002</span>,   <span class="st">"갈비전문점"</span>,</span>
<span id="cb64-2214"><a href="#cb64-2214" aria-hidden="true" tabindex="-1"></a><span class="dv">8003</span>,   <span class="st">"한정식"</span>,</span>
<span id="cb64-2215"><a href="#cb64-2215" aria-hidden="true" tabindex="-1"></a><span class="dv">8004</span>,   <span class="st">"일식회집"</span>,</span>
<span id="cb64-2216"><a href="#cb64-2216" aria-hidden="true" tabindex="-1"></a><span class="dv">8005</span>,   <span class="st">"중국음식"</span>,</span>
<span id="cb64-2217"><a href="#cb64-2217" aria-hidden="true" tabindex="-1"></a><span class="dv">8006</span>,   <span class="st">"서양음식"</span>)</span>
<span id="cb64-2218"><a href="#cb64-2218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2219"><a href="#cb64-2219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2220"><a href="#cb64-2220" aria-hidden="true" tabindex="-1"></a>bc_type_yearmon_gg <span class="ot">&lt;-</span> port_amt_tbl <span class="sc">|&gt;</span> </span>
<span id="cb64-2221"><a href="#cb64-2221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mer_buz_code <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">8001</span>, <span class="dv">8004</span>, <span class="dv">8005</span>, <span class="dv">8006</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb64-2222"><a href="#cb64-2222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(code_table) <span class="sc">|&gt;</span> </span>
<span id="cb64-2223"><a href="#cb64-2223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ta_ym, 업종명) <span class="sc">|&gt;</span> </span>
<span id="cb64-2224"><a href="#cb64-2224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(결재건수 <span class="ot">=</span> <span class="fu">sum</span>(total_cnt)<span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>,</span>
<span id="cb64-2225"><a href="#cb64-2225" aria-hidden="true" tabindex="-1"></a>            결재금액 <span class="ot">=</span> <span class="fu">sum</span>(total_amt)<span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">8</span>,) <span class="sc">|&gt;</span> </span>
<span id="cb64-2226"><a href="#cb64-2226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb64-2227"><a href="#cb64-2227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ta_ym, <span class="at">y =</span> 결재금액, <span class="at">color =</span> 업종명)) <span class="sc">+</span></span>
<span id="cb64-2228"><a href="#cb64-2228" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb64-2229"><a href="#cb64-2229" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb64-2230"><a href="#cb64-2230" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>(<span class="at">base_family =</span> <span class="st">"MaruBrui"</span>) <span class="sc">+</span></span>
<span id="cb64-2231"><a href="#cb64-2231" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"김포시 대명항 인근 1 KM 업종별 결재금액"</span>,</span>
<span id="cb64-2232"><a href="#cb64-2232" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"연령별, 2018년 1월 ~ 2022년 12월"</span>,</span>
<span id="cb64-2233"><a href="#cb64-2233" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"자료출처: 경기도 분석센터 KT 유동인구"</span>,</span>
<span id="cb64-2234"><a href="#cb64-2234" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb64-2235"><a href="#cb64-2235" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"결재금액(억원)"</span>) <span class="sc">+</span></span>
<span id="cb64-2236"><a href="#cb64-2236" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb64-2237"><a href="#cb64-2237" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>)) </span>
<span id="cb64-2238"><a href="#cb64-2238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2239"><a href="#cb64-2239" aria-hidden="true" tabindex="-1"></a>bc_type_yearmon_gg</span>
<span id="cb64-2240"><a href="#cb64-2240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2241"><a href="#cb64-2241" aria-hidden="true" tabindex="-1"></a>ragg<span class="sc">::</span><span class="fu">agg_jpeg</span>(<span class="st">"images/항구_통계/김포_대명항_음식점_결재금액.jpg"</span>, </span>
<span id="cb64-2242"><a href="#cb64-2242" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb64-2243"><a href="#cb64-2243" aria-hidden="true" tabindex="-1"></a>bc_type_yearmon_gg</span>
<span id="cb64-2244"><a href="#cb64-2244" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb64-2245"><a href="#cb64-2245" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-2246"><a href="#cb64-2246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2247"><a href="#cb64-2247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2248"><a href="#cb64-2248" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/gg/김포_대명항_음식점_결재금액.jpg)</span></span>
<span id="cb64-2249"><a href="#cb64-2249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2250"><a href="#cb64-2250" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-2251"><a href="#cb64-2251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2252"><a href="#cb64-2252" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
</div>
</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "복사완료!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "복사완료!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      <div class="footer-contents">[Quarto](https://quarto.org/) 로 제작</div>  
    </div>   
    <div class="nav-footer-center">
       
    </div>
    <div class="nav-footer-right">
       
    </div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"openEffect":"zoom","selector":".lightbox","loop":false,"closeEffect":"zoom","descPosition":"bottom"});</script>
</body>
</html>
