---
title: "지도제작 대회"
subtitle: "재보궐: 강서구 위치"
description: |
  강서구청장 선거 위치
author:
  - name: 이광춘
    url: https://www.linkedin.com/in/kwangchunlee/
    affiliation: 한국 R 사용자회
    affiliation-url: https://github.com/bit2r
title-block-banner: true
format:
  html:
    theme: flatly
    code-fold: true
    code-overflow: wrap
    toc: true
    toc-depth: 3
    toc-title: 목차
    number-sections: true
    highlight-style: github    
    self-contained: false
    default-image-extension: jpg
filters:
   - lightbox
lightbox: auto
link-citations: true
knitr:
  opts_chunk: 
    eval: true
    message: false
    warning: false
    collapse: true
    comment: "#>" 
    R.options:
      knitr.graphics.auto_pdf: true
editor_options: 
  chunk_output_type: console
---

# 데이터셋

## GRDP

[서울시 자치구별 지역내총생산(2015년 기준) 통계](https://data.seoul.go.kr/dataList/11057/S/2/datasetView.do)

```{r}
library(tidyverse)
library(readxl)

grdp_raw <- read_excel("data/자치구별+지역내총생산(2015년+기준)_20231011134915.xlsx", skip = 0)

grdp_tbl <- grdp_raw |>
  janitor::clean_names(ascii = FALSE) |> 
  select(자치구 = 자치구별_2, contains("x2020")) |> 
  janitor::row_to_names(row_number = 1) |> 
  set_names(c("자치구", "GRDP", "GRDP_pcnt", "GRDP_2", "GRDP_pcnt2")) |> 
  select(자치구, GRDP) |> 
  mutate( GRDP = parse_number(GRDP)) |> 
  filter(자치구 != "소계") |> mutate(GRDP = GRDP / 1000000 )

grdp_tbl
```

## 인구수

```{r}
pop_raw <- read_csv("data/202308_202308_주민등록인구및세대현황_월간.csv",
                   locale = locale('ko',encoding='euc-kr'))

seoul_pop <- pop_raw |> 
  select(구명 = 행정구역, 인구수 = `2023년08월_총인구수`) |> 
  mutate(구명 = str_extract(구명, "\\w+구")) |> 
  drop_na() |> 
  mutate(강북강남 = ifelse(구명 %in% c("은평구", "서대문구", "마포구", "종로구", "중구", "용산구", "동대문구", "성동구", "성북구", "중랑구", "광진구", "강북구", "도봉구", "노원구"), "강북", "강남")) |> 
  mutate(인구수 = 인구수 / 10000)

seoul_pop
```


## 인구 GRDP

```{r}
pop_grdp <- seoul_pop |> 
  left_join(grdp_tbl, by = c("구명" = "자치구"))

pop_grdp
```


# 분석

## 인구수와 GRDP

```{r}
library(ggrepel)

pop_grdp |> 
  ggplot(aes(x = 인구수, y = GRDP)) +
    geom_point() +
    theme_minimal(base_family="MaruBrui") +
    theme(legend.position = "none") +
    labs(title = "서울시 자치구 인구수와 지역내총생산",
         x = "인구수(만명)",
         y = "지역내총생산(조원)") +
    scale_x_continuous(labels = scales::unit_format(unit = " 만명", sep = "")) +
    scale_y_continuous(labels = scales::unit_format(unit = " 조원", sep = "")) +
    geom_text_repel(aes(label = 구명),
                    size = 4.5, min.segment.length = 0, force = 0.5, max.overlaps=Inf,
                    color = "black")
```

## 인구수와 1인당 GRDP

```{r}
pop_grdp |> 
  mutate(인당GRDP = GRDP / 인구수) |> 
  ggplot(aes(x = 인구수, y = 인당GRDP)) +
    geom_point() +
    theme_minimal(base_family="MaruBrui") +
    theme(legend.position = "none") +
    labs(title = "서울시 자치구 인구수와 1인당 지역내총생산",
         x = "인구수(만명)",
         y = "인당 지역내총생산(조원)") +
    scale_x_continuous(labels = scales::unit_format(unit = " 만명", sep = "")) +
    scale_y_continuous(labels = scales::unit_format(unit = " 조원", sep = "")) +
    geom_text_repel(aes(label = 구명),
                    size = 4.5, min.segment.length = 0, 
                    force = 0.5, max.overlaps=Inf, color = "black")  


```


